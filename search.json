[{"path":"https://saezlab.github.io/mistyR/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Code of Conduct","title":"Code of Conduct","text":"mistyR part Bioconductor. Bioconductor community values open approach science promotes sharing ideas, code, expertise collaboration diversity inclusivity kind welcoming environment community contributions line values, Bioconductor dedicated providing welcoming, supportive, collegial, experience free harassment, intimidation, bullying regardless : identity: gender, gender identity expression, sexual orientation, disability, physical appearance, ethnicity, body size, race, age, religion, etc. intellectual position: approaches data analysis, software preferences, coding style, scientific perspective, etc. stage career order uphold values, members Bioconductor community required follow Code Conduct.latest version Bioconductor project Code Conduct available http://bioconductor.org//code--conduct/. Please read Code Conduct contributing project. Thank !","code":""},{"path":"https://saezlab.github.io/mistyR/SUPPORT.html","id":null,"dir":"","previous_headings":"","what":"Getting help with mistyR","title":"Getting help with mistyR","text":"Thanks using mistyR! filing issue, places explore pieces put together make process smooth possible.","code":""},{"path":"https://saezlab.github.io/mistyR/SUPPORT.html","id":"make-a-reprex","dir":"","previous_headings":"","what":"Make a reprex","title":"Getting help with mistyR","text":"Start making minimal reproducible example using reprex package. haven’t heard used reprex , ’re treat! Seriously, reprex make R-question-asking endeavors easier (pretty insane ROI five ten minutes ’ll take learn ’s ). additional reprex pointers, check Get help! section tidyverse site.","code":""},{"path":"https://saezlab.github.io/mistyR/SUPPORT.html","id":"where-to-ask","dir":"","previous_headings":"","what":"Where to ask?","title":"Getting help with mistyR","text":"Armed reprex, next step figure ask. See also Bioconductor help website. ’s question: start community.rstudio.com, /StackOverflow. Bioconductor-related question, please ask Bioconductor Support Website using appropriate package tag (website send automatic email package authors). people answer questions. ’s bug: ’re right place, file issue. ’re sure: let community help figure ! problem bug feature request, can easily return report . opening new issue, sure search issues pull requests make sure bug hasn’t reported /already fixed development version. default, search pre-populated :issue :open. can edit qualifiers (e.g. :pr, :closed) needed. example, ’d simply remove :open search issues repo, open closed.","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Learning functional and structural spatial relationships with MISTy","text":"10X Visium captures spatially resolved transcriptomic profiles spots containing multiple cells. vignette, use gene expression information Visium data infer pathway transcription factor activity separately investigate spatial relationships cell-type composition. addition, examine spatial relationships ligands receptors. Load necessary R packages: use functions python since computation time significantly shorter R. Python chunks start #Python. Install load necessary package Python:","code":"# MISTy library(mistyR)  # For using Python  library(reticulate)  # Seurat library(Seurat)  # Data manipulation library(tidyverse)  # Pathways library(decoupleR)  #Cleaning names library(janitor) py_install(c(\"decoupler\",\"omnipath\"), pip =TRUE) ## Using Python: /usr/bin/python3.10 ## Creating virtual environment '~/.virtualenvs/r-reticulate' ... ## + /usr/bin/python3.10 -m venv /home/runner/.virtualenvs/r-reticulate ## Done! ## Installing packages: pip, wheel, setuptools ## + /home/runner/.virtualenvs/r-reticulate/bin/python -m pip install --upgrade pip wheel setuptools ## Virtual environment '~/.virtualenvs/r-reticulate' successfully created. ## Using virtual environment '~/.virtualenvs/r-reticulate' ... ## + /home/runner/.virtualenvs/r-reticulate/bin/python -m pip install --upgrade --no-user decoupler omnipath # In Python: import decoupler as dc"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"get-and-load-data","dir":"Articles","previous_headings":"","what":"Get and load data","title":"Learning functional and structural spatial relationships with MISTy","text":"showcase, use 10X Visium spatial slide Kuppe et al., 2022, created spatial multi-omic map human myocardial infarction. tissue example data comes human heart patient 14, chronic state following myocardial infarction. Seurat object contains, among things, normalized raw gene counts. First, download extract file: next step load data, extract normalized gene counts genes expressed least 5% spots, pixel coordinates. recommended use pixel coordinates instead row column numbers since rows shifted therefore express real distance spots. Let’s take look slide cell-type niches defined Kuppe et al.:","code":"download.file(\"https://zenodo.org/records/6580069/files/10X_Visium_ACH005.tar.gz?download=1\",     destfile = \"10X_Visium_ACH005.tar.gz\", method = \"curl\") untar(\"10X_Visium_ACH005.tar.gz\") seurat <- readRDS(\"ACH005/ACH005.rds\") expression_raw <- as.matrix(GetAssayData(seurat, layer = \"counts\", assay = \"SCT\")) geometry <- GetTissueCoordinates(seurat, scale = NULL)  # Only take genes that  expressed in at least 5% of the spots expression <- expression_raw[rownames(expression_raw[(rowSums(expression_raw > 0) / ncol(expression_raw)) >= 0.05,]),] SpatialPlot(seurat, alpha = 0) SpatialPlot(seurat, group.by = \"celltype_niche\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"extract-cell-type-composition","dir":"Articles","previous_headings":"","what":"Extract cell-type composition","title":"Learning functional and structural spatial relationships with MISTy","text":"Seurat Object tissue slide also contains estimated cell type proportions cell2location. extract separate object later use MISTy visualize cell types:","code":"# Rename to more informative names rownames(seurat@assays$c2l_props@data) <- rownames(seurat@assays$c2l_props@data) %>%    recode('Adipo' = 'Adipocytes',          'CM' = 'Cardiomyocytes',          'Endo' = 'Endothelial',          'Fib' = 'Fibroblasts',          'PC' = 'Pericytes',          'prolif' = 'Proliferating',          'vSMCs' = 'Vascular-SMCs')  # Extract into a separate object composition <- as_tibble(t(seurat[[\"c2l_props\"]]$data))   # Visualize cell types DefaultAssay(seurat) <- \"c2l_props\" SpatialFeaturePlot(seurat,                     keep.scale = NULL,                     features = c('Vascular-SMCs', \"Cardiomyocytes\", \"Endothelial\", \"Fibroblasts\"),                    ncol = 2)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"pathway-activities-on-cell-type-composition","dir":"Articles","previous_headings":"","what":"Pathway activities on cell-type composition","title":"Learning functional and structural spatial relationships with MISTy","text":"Let’s investigate relationship cell-type compositions pathway activities example slide. create views, need estimate pathway activities. take pathway gene sets PROGENy estimate activity decoupleR: add result Seurat Object plot estimated activities see distribution slide:","code":"# Obtain genesets model <- get_progeny(organism = \"human\", top = 500) ## Warning: One or more parsing issues, call `problems()` on your data frame for details, ## e.g.: ##   dat <- vroom(...) ##   problems(dat) # Use multivariate linear model to estimate activity est_path_act <- run_mlm(expression, model,.mor = NULL) # Delete progeny assay from Kuppe et al. seurat[['progeny']] <- NULL  # Put estimated pathway activities object into the correct format est_path_act_wide <- est_path_act %>%    pivot_wider(id_cols = condition, names_from = source, values_from = score) %>%   column_to_rownames(\"condition\")   # Clean names colnames(est_path_act_wide)  <- est_path_act_wide %>%    clean_names(parsing_option = 0) %>%    colnames(.)  # Add seurat[['progeny']] <- CreateAssayObject(counts = t(est_path_act_wide))  SpatialFeaturePlot(seurat, features = c(\"jak.stat\", \"hypoxia\"), image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"misty-views","dir":"Articles","previous_headings":"Pathway activities on cell-type composition","what":"MISTy Views","title":"Learning functional and structural spatial relationships with MISTy","text":"MISTy view, use cell type compositions per spot intraview add estimated PROGENy pathway activities juxta paraviews. size neighborhood kernel, well kernel family, chosen depending experiment. distances chosen enclose small number neighboring spots. run MISTy collect results:","code":"# Clean names colnames(composition)  <- composition %>% clean_names(parsing_option = 0) %>% colnames(.)  # create intra from cell-type composition comp_views <- create_initial_view(composition)   # juxta & para from pathway activity path_act_views <- create_initial_view(est_path_act_wide) %>%   add_juxtaview(geometry,  neighbor.thr = 130) %>%    add_paraview(geometry, l= 200, family = \"gaussian\")  # Combine views com_path_act_views <- comp_views %>%   add_views(create_view(\"juxtaview.path.130\", path_act_views[[\"juxtaview.130\"]]$data, \"juxta.path.130\"))%>%    add_views(create_view(\"paraview.path.200\", path_act_views[[\"paraview.200\"]]$data, \"para.path.200\")) run_misty(com_path_act_views, \"result/comp_path_act\") ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/comp_path_act\" misty_results_com_path_act <- collect_results(\"result/comp_path_act/\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"downstream-analysis","dir":"Articles","previous_headings":"Pathway activities on cell-type composition","what":"Downstream analysis","title":"Learning functional and structural spatial relationships with MISTy","text":"collected results, can now answer following questions:","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"to-what-extent-can-the-analyzed-surrounding-tissues-pathway-activities-explain-the-cell-type-composition-of-the-spot-compared-to-the-intraview","dir":"Articles","previous_headings":"Pathway activities on cell-type composition > Downstream analysis","what":"1. To what extent can the analyzed surrounding tissues’ pathway activities explain the cell-type composition of the spot compared to the intraview?","title":"Learning functional and structural spatial relationships with MISTy","text":"can look two different statistics: intra.R2 shows variance explained intraview alone, gain.R2 shows increase explainable variance additionally consider views (juxta para).   juxta paraview particularly increase explained variance mast cells adipocytes. general, significant gain R2 can interpreted following: “can better explain expression marker X consider additional views intrinsic view.” see individual contributions views can use:  see, intraview explains variance nearly cell types (expected).","code":"misty_results_com_path_act %>%   plot_improvement_stats(\"intra.R2\")%>%   plot_improvement_stats(\"gain.R2\") ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). misty_results_com_path_act %>%    plot_view_contributions()"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"what-are-the-specific-relations-that-can-explain-the-cell-type-composition","dir":"Articles","previous_headings":"Pathway activities on cell-type composition > Downstream analysis","what":"2. What are the specific relations that can explain the cell-type composition?","title":"Learning functional and structural spatial relationships with MISTy","text":"can individually show importance markers viewpoint predictors spot intrinsic cell-type composition explain contributions. Let’s look juxtaview:  observe TNFa significant predictor adipocytes. can compare distributions:   observe similar distributions .","code":"misty_results_com_path_act %>%   plot_interaction_heatmap(\"juxta.path.130\", clean = TRUE) SpatialFeaturePlot(seurat, features = \"tnfa\", image.alpha = 0) DefaultAssay(seurat) <- \"c2l_props\" SpatialFeaturePlot(seurat, features = \"Adipocytes\", image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"pathway-activities-on-cell-type-composition---linear-model","dir":"Articles","previous_headings":"","what":"Pathway activities on cell-type composition - Linear Model","title":"Learning functional and structural spatial relationships with MISTy","text":"default model used MISTy model view random forest. However, different models choose , like faster interpretable linear model. Another option haven’t used yet bypass.intra. , bypass training baseline model predicts intraview features intraview . still able see views explain intraview. use view composition :","code":"run_misty(com_path_act_views, \"result/comp_path_act_linear\", model.function = linear_model, bypass.intra = TRUE) ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/comp_path_act_linear\" misty_results_com_path_act_linear <- collect_results(\"result/comp_path_act_linear\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"downstream-analysis-1","dir":"Articles","previous_headings":"Pathway activities on cell-type composition - Linear Model","what":"Downstream analysis","title":"Learning functional and structural spatial relationships with MISTy","text":"Let’s check gain.R2 view contributions:  specific target-predictor interaction, look juxtaview:  Visualize activity JAK-STAT pathway myeloid distribution:","code":"misty_results_com_path_act_linear %>%   plot_improvement_stats(\"gain.R2\") %>%   plot_view_contributions() ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). misty_results_com_path_act_linear %>%   plot_interaction_heatmap(\"juxta.path.130\", clean = TRUE) SpatialFeaturePlot(seurat, features = \"jak.stat\", image.alpha = 0) ## Warning: Could not find jak.stat in the default search locations, found in ## 'progeny' assay instead DefaultAssay(seurat) <- \"c2l_props\" SpatialFeaturePlot(seurat, features = \"Myeloid\", image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"pathway-activities-and-transcriptionfactors-on-cell-type-composition","dir":"Articles","previous_headings":"","what":"Pathway activities and Transcriptionfactors on cell-type composition","title":"Learning functional and structural spatial relationships with MISTy","text":"addition estimated pathway activities, can also add view examine relationship cell-type composition TF activity. First, need estimate TF activity decoupler. recommended compute Python, significantly faster: object estimation contains two elements: first estimates respective p-values can found second element. speed following model training, calculate 1000 variable genes expressed. extract TF highly variable genes create MISTy view.","code":"expression_df <- as.data.frame(t(expression)) # In Python: net = dc.get_collectri() ## 0.00B [00:00, ?B/s]466kB [00:00, 4.14MB/s]1.11MB [00:00, 4.51MB/s]2.75MB [00:00, 7.99MB/s]5.72MB [00:00, 13.4MB/s]11.7MB [00:00, 24.3MB/s]24.1MB [00:00, 46.8MB/s]49.0MB [00:00, 90.3MB/s]52.7MB [00:00, 55.3MB/s] ## 0.00B [00:00, ?B/s]118kB [00:00, 244MB/s] acts_tfs=  dc.run_ulm(   mat = r.expression_df,   net = net,   verbose = True,   use_raw = False,   ) ## Running ulm on mat with 3175 samples and 7241 targets for 545 sources. est_TF <- py$acts_tfs # Highly variable genes hvg <- FindVariableFeatures(expression, selection.method = \"vst\", nfeatures = 1000) %>%    filter(variable == TRUE)  hvg_expr <- expression[rownames(hvg), ]  # Extract TF from the highly variable genes hvg_TF<- est_TF[[1]][, colnames(est_TF[[1]]) %in% rownames(hvg_expr)]"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"misty-views-1","dir":"Articles","previous_headings":"Pathway activities and Transcriptionfactors on cell-type composition","what":"Misty Views","title":"Learning functional and structural spatial relationships with MISTy","text":"combine intraview cell-type composition paraviews estimated pathway TF activities:","code":"TF_view <- create_initial_view(hvg_TF) %>%   add_paraview(geometry, l = 200)           # This may still take some time  # Combine Views comp_TF_path_views <- comp_views %>% add_views(create_view(\"paraview.TF.200\", TF_view[[\"paraview.200\"]]$data, \"para.TF.200\")) %>%    add_views(create_view(\"paraview.path.200\", path_act_views[[\"paraview.200\"]]$data, \"para.path.200\"))  # Run Misty run_misty(comp_TF_path_views, \"result/comp_TF_path\", model.function = linear_model, bypass.intra = TRUE) ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/comp_TF_path\" misty_results_comp_TF_pathway <- collect_results(\"result/comp_TF_path\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"downstream-analysis-2","dir":"Articles","previous_headings":"Pathway activities and Transcriptionfactors on cell-type composition","what":"Downstream analysis","title":"Learning functional and structural spatial relationships with MISTy","text":"plotting interaction heatmap, can restrict result applying trim, shows targets defined value chosen metric like gain.R2.  TF MYC important predictor fibroblasts:   Indeed, can see similar distribution.","code":"misty_results_comp_TF_pathway %>%   plot_improvement_stats(\"gain.R2\") %>%   plot_view_contributions() ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). misty_results_comp_TF_pathway %>%   plot_interaction_heatmap(\"para.TF.200\",                             clean = TRUE,                            trim.measure = \"gain.R2\",                            trim = 20) DefaultAssay(seurat) <- \"SCT\" SpatialFeaturePlot(seurat, features = \"MYC\", image.alpha = 0) DefaultAssay(seurat) <- \"c2l_props\" SpatialFeaturePlot(seurat, features = \"Fibroblasts\", image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"ligand-receptor","dir":"Articles","previous_headings":"","what":"Ligand-Receptor","title":"Learning functional and structural spatial relationships with MISTy","text":"Finally, want learn spatial relationship receptors ligands tissue slide. access consensus resource LIANA downloading Github, pulling ligands receptors -determined highly variable genes:","code":"download.file(\"https://raw.githubusercontent.com/saezlab/liana-py/main/liana/resource/omni_resource.csv\",      destfile = \"omni_resource.csv\", method = \"curl\")  # Ligand Receptor Resource omni_resource <- read_csv(\"omni_resource.csv\")%>%    filter(resource == \"consensus\")  # Get highly variable ligands ligands <- omni_resource %>%    pull(source_genesymbol) %>%    unique() hvg_lig <- hvg_expr[rownames(hvg_expr) %in% ligands,]  # Get highly variable receptors receptors <- omni_resource %>%    pull(target_genesymbol) %>%    unique() hvg_recep <- hvg_expr[rownames(hvg_expr) %in% receptors,]  # Clean names rownames(hvg_lig) <- hvg_lig %>%    clean_names(parsing_option = 0) %>%    rownames(.)  rownames(hvg_recep) <- hvg_recep %>% clean_names(parsing_option = 0) %>%    rownames(.)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"misty-views-2","dir":"Articles","previous_headings":"Ligand-Receptor","what":"Misty Views","title":"Learning functional and structural spatial relationships with MISTy","text":"going create combined view receptors intraview targets ligands paraview predictors:","code":"# Create views and combine them receptor_view <- create_initial_view(as.data.frame(t(hvg_recep)))  ligand_view <- create_initial_view(as.data.frame(t(hvg_lig))) %>%    add_paraview(geometry, l = 200, family = \"gaussian\")  lig_recep_view <- receptor_view %>% add_views(create_view(\"paraview.ligand.200\", ligand_view[[\"paraview.200\"]]$data, \"para.lig.200\"))  run_misty(lig_recep_view, \"results/lig_recep\", bypass.intra = TRUE) ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/results/lig_recep\" misty_results_lig_recep <- collect_results(\"results/lig_recep\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"downstream-analysis-3","dir":"Articles","previous_headings":"Ligand-Receptor","what":"Downstream analysis","title":"Learning functional and structural spatial relationships with MISTy","text":"Let’s look important interactions. additional way reduce number interactions shown heatmap applying cutoff, introduces importance threshold:  Remember MISTy infer interactions ligands respective receptor, rather possible interactions ligands receptors. can visualize one interactions high importance:   plots show co-occurrence ligand receptor, although annotated receptor-ligand pair.","code":"misty_results_lig_recep %>%   plot_interaction_heatmap(\"para.lig.200\", clean = TRUE, cutoff = 2, trim.measure =\"gain.R2\", trim = 10) DefaultAssay(seurat) <- \"SCT\" SpatialFeaturePlot(seurat, features = \"CRLF1\", image.alpha = 0) SpatialFeaturePlot(seurat, features = \"COMP\", image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Learning functional and structural spatial relationships with MISTy","text":"browseVignettes(\"mistyR\")","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalAndStructuralPipeline.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Learning functional and structural spatial relationships with MISTy","text":"output sessionInfo() point document compiled.","code":"sessionInfo() ## R version 4.3.3 (2024-02-29) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] distances_0.1.10   janitor_2.2.0      decoupleR_2.8.0    lubridate_1.9.3    ##  [5] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2        ##  [9] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.0      ## [13] tidyverse_2.0.0    Seurat_5.0.3       SeuratObject_5.0.1 sp_2.1-3           ## [17] reticulate_1.35.0  mistyR_1.10.0      BiocStyle_2.30.0   ##  ## loaded via a namespace (and not attached): ##   [1] RcppAnnoy_0.0.22       splines_4.3.3          later_1.3.2            ##   [4] filelock_1.0.3         R.oo_1.26.0            cellranger_1.1.0       ##   [7] polyclip_1.10-6        hardhat_1.3.1          pROC_1.18.5            ##  [10] rpart_4.1.23           fastDummies_1.7.3      lifecycle_1.0.4        ##  [13] rprojroot_2.0.4        vroom_1.6.5            globals_0.16.3         ##  [16] lattice_0.22-5         MASS_7.3-60.0.1        backports_1.4.1        ##  [19] magrittr_2.0.3         plotly_4.10.4          sass_0.4.9             ##  [22] rmarkdown_2.26         jquerylib_0.1.4        yaml_2.3.8             ##  [25] rlist_0.4.6.2          httpuv_1.6.14          sctransform_0.4.1      ##  [28] spam_2.10-0            spatstat.sparse_3.0-3  cowplot_1.1.3          ##  [31] pbapply_1.7-2          RColorBrewer_1.1-3     abind_1.4-5            ##  [34] rvest_1.0.4            Rtsne_0.17             R.utils_2.12.3         ##  [37] nnet_7.3-19            rappdirs_0.3.3         ipred_0.9-14           ##  [40] lava_1.8.0             ggrepel_0.9.5          irlba_2.3.5.1          ##  [43] listenv_0.9.1          spatstat.utils_3.0-4   goftest_1.2-3          ##  [46] RSpectra_0.16-1        spatstat.random_3.2-3  fitdistrplus_1.1-11    ##  [49] parallelly_1.37.1      pkgdown_2.0.7          leiden_0.4.3.1         ##  [52] codetools_0.2-19       xml2_1.3.6             tidyselect_1.2.1       ##  [55] farver_2.1.1           stats4_4.3.3           matrixStats_1.2.0      ##  [58] spatstat.explore_3.2-7 jsonlite_1.8.8         caret_6.0-94           ##  [61] ellipsis_0.3.2         progressr_0.14.0       iterators_1.0.14       ##  [64] ggridges_0.5.6         survival_3.5-8         systemfonts_1.0.6      ##  [67] foreach_1.5.2          tools_4.3.3            progress_1.2.3         ##  [70] ragg_1.3.0             ica_1.0-3              Rcpp_1.0.12            ##  [73] glue_1.7.0             prodlim_2023.08.28     gridExtra_2.3          ##  [76] ranger_0.16.0          xfun_0.42              here_1.0.1             ##  [79] withr_3.0.0            BiocManager_1.30.22    fastmap_1.1.1          ##  [82] fansi_1.0.6            digest_0.6.35          timechange_0.3.0       ##  [85] R6_2.5.1               mime_0.12              textshaping_0.3.7      ##  [88] colorspace_2.1-0       scattermore_1.2        tensor_1.5             ##  [91] spatstat.data_3.0-4    R.methodsS3_1.8.2      utf8_1.2.4             ##  [94] generics_0.1.3         recipes_1.0.10         data.table_1.15.2      ##  [97] class_7.3-22           ridge_3.3              prettyunits_1.2.0      ## [100] httr_1.4.7             htmlwidgets_1.6.4      ModelMetrics_1.2.2.2   ## [103] uwot_0.1.16            pkgconfig_2.0.3        gtable_0.3.4           ## [106] timeDate_4032.109      lmtest_0.9-40          selectr_0.4-2          ## [109] furrr_0.3.1            OmnipathR_3.10.1       htmltools_0.5.7        ## [112] dotCall64_1.1-1        bookdown_0.38          scales_1.3.0           ## [115] png_0.1-8              gower_1.0.1            snakecase_0.11.1       ## [118] knitr_1.45             tzdb_0.4.0             reshape2_1.4.4         ## [121] checkmate_2.3.1        nlme_3.1-164           curl_5.2.1             ## [124] cachem_1.0.8           zoo_1.8-12             KernSmooth_2.23-22     ## [127] parallel_4.3.3         miniUI_0.1.1.1         desc_1.4.3             ## [130] pillar_1.9.0           grid_4.3.3             logger_0.3.0           ## [133] vctrs_0.6.5            RANN_2.6.1             promises_1.2.1         ## [136] xtable_1.8-4           cluster_2.1.6          evaluate_0.23          ## [139] cli_3.6.2              compiler_4.3.3         rlang_1.1.3            ## [142] crayon_1.5.2           future.apply_1.11.1    labeling_0.4.3         ## [145] plyr_1.8.9             fs_1.6.3               stringi_1.8.3          ## [148] viridisLite_0.4.2      deldir_2.0-4           assertthat_0.2.1       ## [151] munsell_0.5.0          lazyeval_0.2.2         spatstat.geom_3.2-9    ## [154] Matrix_1.6-5           RcppHNSW_0.6.0         hms_1.1.3              ## [157] patchwork_1.2.0        bit64_4.0.5            future_1.33.1          ## [160] shiny_1.8.0            highr_0.10             ROCR_1.0-11            ## [163] igraph_2.0.3           memoise_2.0.1          bslib_0.6.2            ## [166] bit_4.0.5              readxl_1.4.3"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"10X Visium captures spatially resolved transcriptomic profiles spots containing multiple cells. vignette, use gene expression information Visium data infer pathway activity investigate spatial relationships pathways ligand expression. Load necessary packages:","code":"# MISTy  library(mistyR)  library(future)   #Seurat  library(Seurat) library(SeuratObject)  # Data manipulation  library(tidyverse)   # Pathways and annotation library(decoupleR) library(OmnipathR) library(progeny)  # Cleaning names library(janitor)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"get-and-load-data","dir":"Articles","previous_headings":"","what":"Get and load data","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"showcase, use 10X Visium spatial slide Kuppe et al., 2022, created spatial multi-omic map human myocardial infarction. tissue example data comes human heart patient 14, later state myocardial infarction. Seurat object contains, among things, normalized raw gene counts. First, download extract file: next step load data, extract normalized gene counts, names genes expressed least 5% spots, pixel coordinates. recommended use pixel coordinates instead row column numbers since rows shifted therefore express real distance spots.","code":"download.file(\"https://zenodo.org/records/6580069/files/10X_Visium_ACH005.tar.gz?download=1\",     destfile = \"10X_Visium_ACH005.tar.gz\", method = \"curl\") untar(\"10X_Visium_ACH005.tar.gz\") seurat_vs <- readRDS(\"ACH005/ACH005.rds\")  expression <- as.matrix(GetAssayData(seurat_vs, layer = \"counts\", assay = \"SCT\")) gene_names <- rownames(expression[(rowSums(expression > 0) / ncol(expression)) >= 0.05,])  geometry <- GetTissueCoordinates(seurat_vs, scale = NULL)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"pathway-activity","dir":"Articles","previous_headings":"","what":"Pathway activity","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"Now create Seurat object pathway activities inferred PROGENy. delete PROGENy assay done Kuppe et al. load model matrix top 1000 significant genes 14 available pathways. extract genes common PROGENy model snRNA-seq assay Seurat object. estimate pathway activity multivariate linear model using decoupleR. save result Seurat assay clean row names handle problematic variables.","code":"seurat_vs[['progeny']] <- NULL  # Matrix with important genes for each pathway model <- get_progeny(organism = \"human\", top = 1000)  # Use multivariate linear model to estimate activity est_path_act <- run_mlm(expression, model,.mor = NULL)   # Put estimated pathway activities object into the correct format est_path_act_wide <- est_path_act %>%    pivot_wider(id_cols = condition, names_from = source, values_from = score) %>%   column_to_rownames(\"condition\")   # Clean names colnames(est_path_act_wide)  <- est_path_act_wide %>%    clean_names(parsing_option = 0) %>%    colnames(.)  # Create a Seurat object seurat_vs[['progeny']] <- CreateAssayObject(counts = t(est_path_act_wide))  # Format for running MISTy later pathway_activity <- t(as.matrix(GetAssayData(seurat_vs, \"progeny\")))"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"ligands","dir":"Articles","previous_headings":"","what":"Ligands","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"annotate expressed ligands found tissue slide, import intercellular network ligands receptors Omnipath. extract ligands expressed tissue slide get count data. clean row names handle problematic variables.","code":"# Get ligands lig_rec <- import_intercell_network(interactions_param = list(datasets = c('ligrecextra', 'omnipath', 'pathwayextra')),                          transmitter_param = list(parent = 'ligand'),                          receiver_param = list(parent = 'receptor'))  # Get unique ligands ligands <- unique(lig_rec$source_genesymbol)  # Get expression of ligands in slide slide_markers <- ligands[ligands %in% gene_names]  ligand_expr <- t(as.matrix(expression[slide_markers,])) %>% clean_names()  #clean names rownames(seurat_vs@assays$SCT@data) <- seurat_vs@assays$SCT@data %>% clean_names(parsing_option = 0) %>% rownames(.)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"visualize-pathway-activity","dir":"Articles","previous_headings":"","what":"Visualize pathway activity","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"continuing creating MISTy view, can look slide pathway activities.","code":"#Slide SpatialPlot(seurat_vs, alpha = 0) # Pathway activity examples DefaultAssay(seurat_vs) <- \"progeny\" SpatialFeaturePlot(seurat_vs, feature = c(\"mapk\", \"p53\"), keep.scale = NULL)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"misty-views","dir":"Articles","previous_headings":"","what":"MISTy views","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"Now need create MISTy views interest. interested relationship pathway activity spot (intraview) ten closest spots (paraview). Therefore choose family `constant` set l ten, select ten nearest neighbors. Depending goal analysis, different families can applied. also intrigued relationship ligand expression pathway activity broader tissue. , create intra- paraview, time expression ligands, view, need paraview. next step, add pathway activity views achieve intended view composition. run MISTy collect results:","code":"pathway_act_view <- create_initial_view(as_tibble(pathway_activity) ) %>%   add_paraview(geometry, l = 10, family = \"constant\") ##  ## Generating paraview using 10 nearest neighbors per unit ligand_view <- create_initial_view(as_tibble(ligand_expr)  %>% clean_names()) %>%   add_paraview(geometry, l = 10, family = \"constant\") ##  ## Generating paraview using 10 nearest neighbors per unit combined_views <- pathway_act_view %>% add_views(create_view(\"paraview.ligand.10\", ligand_view[[\"paraview.10\"]]$data, \"para.ligand.10\")) run_misty(combined_views, \"result/functional_ligand\") ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/functional_ligand\" misty_results <- collect_results(\"result/functional_ligand/\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"downstream-analysis","dir":"Articles","previous_headings":"","what":"Downstream analysis","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"collected results, can now answer following questions:","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"to-what-extent-can-the-analyzed-surrounding-tissues-activities-explain-the-pathway-activity-of-the-spot-compared-to-the-intraview","dir":"Articles","previous_headings":"Downstream analysis","what":"1. To what extent can the analyzed surrounding tissues’ activities explain the pathway activity of the spot compared to the intraview?","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"can look two different statistics: multi.R2 shows total variance explained multiview model. gain.R2 shows increase explainable variance paraviews.   paraviews particularly increase explained variance TGFb PI3K. general, significant gain R2 can interpreted following: “can better explain expression marker X consider additional views intrinsic view.” see individual contributions views can use:","code":"misty_results %>%   plot_improvement_stats(\"multi.R2\") %>%   plot_improvement_stats(\"gain.R2\") ## Warning: Removed 14 rows containing missing values or values outside the scale range ## (`geom_segment()`). ## Warning: Removed 14 rows containing missing values or values outside the scale range ## (`geom_segment()`). misty_results %>% plot_view_contributions()"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"what-are-the-specific-relations-that-can-explain-the-pathway-activity","dir":"Articles","previous_headings":"Downstream analysis","what":"2. What are the specific relations that can explain the pathway activity","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"importance markers viewpoint predictors spot intrinsic pathway activity can shown individually explain contributions. First, intrinsic view. set importance threshold apply cutoff:  can observe TNFa significant predictor activity NFkB pathway spot. Let’s take look spatial distribution pathway activities tissue slide:  can observe correlation high TNFa activity high NFkB activity. Now repeat analysis pathway activity paraview. trim display targets value 0.5% gain.R2.  gain.R2 know paraview contributes lot explaining TGFb pathway activity. Let’s visualize important predictor, androgen pathway activity:  plots show us anticorrelation pathways. Now analyze last view, ligand expression paraview:  ligand SERPINF1 predictor PI3K VEGF:    slides can see SERPINF1 correlates positive PI3K negative VEGF","code":"misty_results %>%   plot_interaction_heatmap(\"intra\", clean = TRUE, cutoff = 1.5) SpatialFeaturePlot(seurat_vs, features = c(\"tnfa\", \"nfkb\"), image.alpha = 0) misty_results %>%   plot_interaction_heatmap(view = \"para.10\",                             clean = TRUE,                             trim = 0.5,                            trim.measure = \"gain.R2\",                            cutoff = 1.25) SpatialFeaturePlot(seurat_vs, features = c(\"androgen\", \"tgfb\"), image.alpha = 0) misty_results %>%   plot_interaction_heatmap(view = \"para.ligand.10\", clean = TRUE, trim = 0.5,                            trim.measure = \"gain.R2\", cutoff=3) SpatialFeaturePlot(seurat_vs, features = c(\"pi3k\"), image.alpha = 0) SpatialFeaturePlot(seurat_vs, features = c(\"vegf\"), image.alpha = 0) DefaultAssay(seurat_vs) <- \"SCT\" SpatialFeaturePlot(seurat_vs, features = c(\"serpinf1\"), image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"browseVignettes(\"mistyR\")","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwayActivityLigands.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Functional analysis with MISTy - pathway activity and ligand expression","text":"output sessionInfo() point document compiled.","code":"sessionInfo() ## R version 4.3.3 (2024-02-29) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] distances_0.1.10   janitor_2.2.0      progeny_1.24.0     OmnipathR_3.10.1   ##  [5] decoupleR_2.8.0    lubridate_1.9.3    forcats_1.0.0      stringr_1.5.1      ##  [9] dplyr_1.1.4        purrr_1.0.2        readr_2.1.5        tidyr_1.3.1        ## [13] tibble_3.2.1       ggplot2_3.5.0      tidyverse_2.0.0    Seurat_5.0.3       ## [17] SeuratObject_5.0.1 sp_2.1-3           future_1.33.1      mistyR_1.10.0      ## [21] BiocStyle_2.30.0   ##  ## loaded via a namespace (and not attached): ##   [1] RcppAnnoy_0.0.22       splines_4.3.3          later_1.3.2            ##   [4] filelock_1.0.3         R.oo_1.26.0            cellranger_1.1.0       ##   [7] polyclip_1.10-6        hardhat_1.3.1          pROC_1.18.5            ##  [10] rpart_4.1.23           fastDummies_1.7.3      lifecycle_1.0.4        ##  [13] globals_0.16.3         lattice_0.22-5         vroom_1.6.5            ##  [16] MASS_7.3-60.0.1        backports_1.4.1        magrittr_2.0.3         ##  [19] plotly_4.10.4          sass_0.4.9             rmarkdown_2.26         ##  [22] jquerylib_0.1.4        yaml_2.3.8             rlist_0.4.6.2          ##  [25] httpuv_1.6.14          sctransform_0.4.1      spam_2.10-0            ##  [28] spatstat.sparse_3.0-3  reticulate_1.35.0      cowplot_1.1.3          ##  [31] pbapply_1.7-2          RColorBrewer_1.1-3     abind_1.4-5            ##  [34] rvest_1.0.4            Rtsne_0.17             R.utils_2.12.3         ##  [37] nnet_7.3-19            rappdirs_0.3.3         ipred_0.9-14           ##  [40] lava_1.8.0             ggrepel_0.9.5          irlba_2.3.5.1          ##  [43] listenv_0.9.1          spatstat.utils_3.0-4   goftest_1.2-3          ##  [46] RSpectra_0.16-1        spatstat.random_3.2-3  fitdistrplus_1.1-11    ##  [49] parallelly_1.37.1      pkgdown_2.0.7          leiden_0.4.3.1         ##  [52] codetools_0.2-19       xml2_1.3.6             tidyselect_1.2.1       ##  [55] farver_2.1.1           stats4_4.3.3           matrixStats_1.2.0      ##  [58] spatstat.explore_3.2-7 jsonlite_1.8.8         caret_6.0-94           ##  [61] ellipsis_0.3.2         progressr_0.14.0       iterators_1.0.14       ##  [64] ggridges_0.5.6         survival_3.5-8         systemfonts_1.0.6      ##  [67] foreach_1.5.2          tools_4.3.3            progress_1.2.3         ##  [70] ragg_1.3.0             ica_1.0-3              Rcpp_1.0.12            ##  [73] glue_1.7.0             prodlim_2023.08.28     gridExtra_2.3          ##  [76] ranger_0.16.0          xfun_0.42              withr_3.0.0            ##  [79] BiocManager_1.30.22    fastmap_1.1.1          fansi_1.0.6            ##  [82] digest_0.6.35          timechange_0.3.0       R6_2.5.1               ##  [85] mime_0.12              textshaping_0.3.7      colorspace_2.1-0       ##  [88] scattermore_1.2        tensor_1.5             spatstat.data_3.0-4    ##  [91] R.methodsS3_1.8.2      utf8_1.2.4             generics_0.1.3         ##  [94] recipes_1.0.10         data.table_1.15.2      class_7.3-22           ##  [97] ridge_3.3              prettyunits_1.2.0      httr_1.4.7             ## [100] htmlwidgets_1.6.4      ModelMetrics_1.2.2.2   uwot_0.1.16            ## [103] pkgconfig_2.0.3        gtable_0.3.4           timeDate_4032.109      ## [106] lmtest_0.9-40          selectr_0.4-2          furrr_0.3.1            ## [109] htmltools_0.5.7        dotCall64_1.1-1        bookdown_0.38          ## [112] scales_1.3.0           png_0.1-8              gower_1.0.1            ## [115] snakecase_0.11.1       knitr_1.45             tzdb_0.4.0             ## [118] reshape2_1.4.4         checkmate_2.3.1        nlme_3.1-164           ## [121] curl_5.2.1             cachem_1.0.8           zoo_1.8-12             ## [124] KernSmooth_2.23-22     parallel_4.3.3         miniUI_0.1.1.1         ## [127] desc_1.4.3             pillar_1.9.0           grid_4.3.3             ## [130] logger_0.3.0           vctrs_0.6.5            RANN_2.6.1             ## [133] promises_1.2.1         xtable_1.8-4           cluster_2.1.6          ## [136] evaluate_0.23          cli_3.6.2              compiler_4.3.3         ## [139] rlang_1.1.3            crayon_1.5.2           future.apply_1.11.1    ## [142] labeling_0.4.3         plyr_1.8.9             fs_1.6.3               ## [145] stringi_1.8.3          viridisLite_0.4.2      deldir_2.0-4           ## [148] assertthat_0.2.1       munsell_0.5.0          lazyeval_0.2.2         ## [151] spatstat.geom_3.2-9    Matrix_1.6-5           RcppHNSW_0.6.0         ## [154] hms_1.1.3              patchwork_1.2.0        bit64_4.0.5            ## [157] shiny_1.8.0            highr_0.10             ROCR_1.0-11            ## [160] igraph_2.0.3           memoise_2.0.1          bslib_0.6.2            ## [163] bit_4.0.5              readxl_1.4.3"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Functional analysis with MISTy - pathway specific genes","text":"10X Visium captures spatially resolved transcriptomic profiles spots containing multiple cells. vignette, use gene expression information Visium data investigate spatial relationships pathway-specific genes. Load necessary packages:","code":"# MISTy  library(mistyR)  library(future)   #Seurat  library(Seurat) library(SeuratObject)  # Data manipulation  library(tidyverse)   # Pathways library(decoupleR)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"get-and-load-data","dir":"Articles","previous_headings":"","what":"Get and load data","title":"Functional analysis with MISTy - pathway specific genes","text":"showcase, use 10X Visium spatial slide Kuppe et al., 2022, created spatial multi-omic map human myocardial infarction. tissue example data comes human heart patient 14, later state myocardial infarction. Seurat object contains, among things, normalized raw gene counts. First, download extract file: next step load data, extract normalized gene counts, names genes expressed least 5% spots, pixel coordinates. recommended use pixel coordinates instead row column numbers since rows shifted therefore express real distance spots.","code":"download.file(\"https://zenodo.org/records/6580069/files/10X_Visium_ACH005.tar.gz?download=1\",     destfile = \"10X_Visium_ACH005.tar.gz\", method = \"curl\") untar(\"10X_Visium_ACH005.tar.gz\") seurat_vs <- readRDS(\"ACH005/ACH005.rds\")  expression <- as.matrix(GetAssayData(seurat_vs, layer = \"counts\", assay = \"SCT\")) gene_names <- rownames(expression[(rowSums(expression > 0) / ncol(expression)) >= 0.05,])  geometry <- GetTissueCoordinates(seurat_vs, scale = NULL)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"obtain-pathway-specific-genes","dir":"Articles","previous_headings":"","what":"Obtain pathway-specific genes","title":"Functional analysis with MISTy - pathway specific genes","text":"First, get top 15 pathway-responsive human genes 14 available pathways PROGENy.focus two pathways - VEGF pathway, responsible promoting formation new blood vessels, TGF-beta pathway, plays critical role regulating various cellular processes promote tissue repair. extracted genes pathways present count matrix.","code":"progeny <- get_progeny(organism = \"human\", top = 15)  VEGF_footprints <- progeny %>%   filter(source == \"VEGF\", weight != 0, target %in% gene_names) %>%    pull(target)  TGFb_footprints <- progeny %>%   filter(source == \"TGFb\", weight != 0, target %in% gene_names) %>%    pull(target)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"visualize-gene-expression","dir":"Articles","previous_headings":"","what":"Visualize gene expression","title":"Functional analysis with MISTy - pathway specific genes","text":"continuing creating Misty view, can look slide expression selected pathway-reactive genes.","code":"#Slide SpatialPlot(seurat_vs, alpha = 0) # Gene expression examples SpatialFeaturePlot(seurat_vs, feature = c(\"ID1\", \"NID2\"), keep.scale = NULL)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"misty-views","dir":"Articles","previous_headings":"","what":"Misty views","title":"Functional analysis with MISTy - pathway specific genes","text":"Now need create Misty views interest. interested relationship TGF-beta responsive genes spot (intraview) ten closest spots (paraview). Therefore choose family constant select ten nearest neighbors. Depending goal analysis, different families can applied. also intrigued relationship VEGF-responsive genes TGF-beta responsive genes broader tissue. , create intra- paraview, time VEGF, view, need paraview. next step, add TGF-beta views achieve intended views. run MISTy collect results:","code":"TGFb_views <- create_initial_view(t(expression[TGFb_footprints,]) %>% as_tibble()) %>%   add_paraview(geometry, l=10, family = \"constant\")   VEGF_views <- create_initial_view(t(expression[VEGF_footprints,]) %>% as_tibble()) %>%   add_paraview(geometry, l=10, family = \"constant\")  misty_views <- TGFb_views %>%    add_views(create_view(\"paraview.VEGF_10\", VEGF_views[[\"paraview.10\"]]$data, \"para.VEGFn.10\")) run_misty(misty_views, \"result/vignette_functional_pipeline\") ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/vignette_functional_pipeline\" misty_results <- collect_results(\"result/vignette_functional_pipeline\")"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"downstream-analysis","dir":"Articles","previous_headings":"","what":"Downstream analysis","title":"Functional analysis with MISTy - pathway specific genes","text":"collected results, can now answer following questions:","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"to-what-extent-can-the-surrounding-tissues-gene-expression-explain-the-gene-expression-of-the-spot-compared-to-the-intraview","dir":"Articles","previous_headings":"Downstream analysis","what":"1. To what extent can the surrounding tissues’ gene expression explain the gene expression of the spot compared to the intraview?","title":"Functional analysis with MISTy - pathway specific genes","text":"can look two different statistics: multi.R2 shows total variance explained multiview model. gain.R2 shows increase explainable variance paraviews.   paraviews particularly increase explained variance COMP, ID1, COL4A1. general, significant gain R2 can interpreted following: “can better explain expression marker X consider additional views intrinsic view.” see individual contributions views can use:","code":"misty_results %>%   plot_improvement_stats(\"gain.R2\") %>%   plot_improvement_stats(\"multi.R2\") ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). misty_results %>% plot_view_contributions()"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"what-are-the-specific-relations-that-can-explain-gene-expression","dir":"Articles","previous_headings":"Downstream analysis","what":"2. What are the specific relations that can explain gene expression?","title":"Functional analysis with MISTy - pathway specific genes","text":"importance markers viewpoint predictors expression intrinsic markers TGF-beta pathway can shown individually explain contributions. First, intrinsic view:  can observe COL4A1 ID1 significant predictor expression several genes spot. ID1 important predictor SMAD7. Let’s take look spatial distribution genes tissue slide:  Areas high levels ID1 mRNA expression also tend show high SMAD7 expression. Now repeat analysis TGF-beta paraview. trim display targets value 0.5% gain.R2. set importance threshold apply cutoff.  gain.R2 know paraview contributes lot explaining ID1 expression. Let’s visualize ID1 important predictor COL4A1:  plots show us , places, localization mRNA overlaps. Now analyze last view, VEGF-paraview:  EPHA3 predictor ID1 COL4A1.  similar distribution ID1 can observed expression EPHA3.","code":"misty_results %>%   plot_interaction_heatmap(\"intra\", clean = TRUE) SpatialFeaturePlot(seurat_vs, features = c(\"ID1\", \"SMAD7\"), image.alpha = 0) misty_results %>%   plot_interaction_heatmap(view = \"para.10\",                             clean = TRUE,                             trim = 0.5,                            trim.measure = \"gain.R2\",                            cutoff = 1.25) SpatialFeaturePlot(seurat_vs, features = c(\"COL4A1\", \"ID1\"), image.alpha = 0) misty_results %>%   plot_interaction_heatmap(view = \"para.VEGFn.10\", clean = TRUE) SpatialFeaturePlot(seurat_vs, keep.scale = NULL, features = c(\"EPHA3\",\"ID1\"), image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Functional analysis with MISTy - pathway specific genes","text":"browseVignettes(\"mistyR\")","code":""},{"path":"https://saezlab.github.io/mistyR/articles/FunctionalPipelinePathwaySpecific.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Functional analysis with MISTy - pathway specific genes","text":"output sessionInfo() point document compiled.","code":"sessionInfo() ## R version 4.3.3 (2024-02-29) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] distances_0.1.10   decoupleR_2.8.0    lubridate_1.9.3    forcats_1.0.0      ##  [5] stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2        readr_2.1.5        ##  [9] tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.0      tidyverse_2.0.0    ## [13] Seurat_5.0.3       SeuratObject_5.0.1 sp_2.1-3           future_1.33.1      ## [17] mistyR_1.10.0      BiocStyle_2.30.0   ##  ## loaded via a namespace (and not attached): ##   [1] RcppAnnoy_0.0.22       splines_4.3.3          later_1.3.2            ##   [4] filelock_1.0.3         R.oo_1.26.0            cellranger_1.1.0       ##   [7] polyclip_1.10-6        hardhat_1.3.1          pROC_1.18.5            ##  [10] rpart_4.1.23           fastDummies_1.7.3      lifecycle_1.0.4        ##  [13] globals_0.16.3         lattice_0.22-5         vroom_1.6.5            ##  [16] MASS_7.3-60.0.1        backports_1.4.1        magrittr_2.0.3         ##  [19] plotly_4.10.4          sass_0.4.9             rmarkdown_2.26         ##  [22] jquerylib_0.1.4        yaml_2.3.8             rlist_0.4.6.2          ##  [25] httpuv_1.6.14          sctransform_0.4.1      spam_2.10-0            ##  [28] spatstat.sparse_3.0-3  reticulate_1.35.0      cowplot_1.1.3          ##  [31] pbapply_1.7-2          RColorBrewer_1.1-3     abind_1.4-5            ##  [34] rvest_1.0.4            Rtsne_0.17             R.utils_2.12.3         ##  [37] nnet_7.3-19            rappdirs_0.3.3         ipred_0.9-14           ##  [40] lava_1.8.0             ggrepel_0.9.5          irlba_2.3.5.1          ##  [43] listenv_0.9.1          spatstat.utils_3.0-4   goftest_1.2-3          ##  [46] RSpectra_0.16-1        spatstat.random_3.2-3  fitdistrplus_1.1-11    ##  [49] parallelly_1.37.1      pkgdown_2.0.7          leiden_0.4.3.1         ##  [52] codetools_0.2-19       xml2_1.3.6             tidyselect_1.2.1       ##  [55] farver_2.1.1           stats4_4.3.3           matrixStats_1.2.0      ##  [58] spatstat.explore_3.2-7 jsonlite_1.8.8         caret_6.0-94           ##  [61] ellipsis_0.3.2         progressr_0.14.0       iterators_1.0.14       ##  [64] ggridges_0.5.6         survival_3.5-8         systemfonts_1.0.6      ##  [67] foreach_1.5.2          tools_4.3.3            progress_1.2.3         ##  [70] ragg_1.3.0             ica_1.0-3              Rcpp_1.0.12            ##  [73] glue_1.7.0             prodlim_2023.08.28     gridExtra_2.3          ##  [76] ranger_0.16.0          xfun_0.42              withr_3.0.0            ##  [79] BiocManager_1.30.22    fastmap_1.1.1          fansi_1.0.6            ##  [82] digest_0.6.35          timechange_0.3.0       R6_2.5.1               ##  [85] mime_0.12              textshaping_0.3.7      colorspace_2.1-0       ##  [88] scattermore_1.2        tensor_1.5             spatstat.data_3.0-4    ##  [91] R.methodsS3_1.8.2      utf8_1.2.4             generics_0.1.3         ##  [94] recipes_1.0.10         data.table_1.15.2      class_7.3-22           ##  [97] ridge_3.3              prettyunits_1.2.0      httr_1.4.7             ## [100] htmlwidgets_1.6.4      ModelMetrics_1.2.2.2   uwot_0.1.16            ## [103] pkgconfig_2.0.3        gtable_0.3.4           timeDate_4032.109      ## [106] lmtest_0.9-40          selectr_0.4-2          furrr_0.3.1            ## [109] OmnipathR_3.10.1       htmltools_0.5.7        dotCall64_1.1-1        ## [112] bookdown_0.38          scales_1.3.0           png_0.1-8              ## [115] gower_1.0.1            knitr_1.45             tzdb_0.4.0             ## [118] reshape2_1.4.4         checkmate_2.3.1        nlme_3.1-164           ## [121] curl_5.2.1             cachem_1.0.8           zoo_1.8-12             ## [124] KernSmooth_2.23-22     parallel_4.3.3         miniUI_0.1.1.1         ## [127] desc_1.4.3             pillar_1.9.0           grid_4.3.3             ## [130] logger_0.3.0           vctrs_0.6.5            RANN_2.6.1             ## [133] promises_1.2.1         xtable_1.8-4           cluster_2.1.6          ## [136] evaluate_0.23          cli_3.6.2              compiler_4.3.3         ## [139] rlang_1.1.3            crayon_1.5.2           future.apply_1.11.1    ## [142] labeling_0.4.3         plyr_1.8.9             fs_1.6.3               ## [145] stringi_1.8.3          viridisLite_0.4.2      deldir_2.0-4           ## [148] assertthat_0.2.1       munsell_0.5.0          lazyeval_0.2.2         ## [151] spatstat.geom_3.2-9    Matrix_1.6-5           RcppHNSW_0.6.0         ## [154] hms_1.1.3              patchwork_1.2.0        bit64_4.0.5            ## [157] shiny_1.8.0            highr_0.10             ROCR_1.0-11            ## [160] igraph_2.0.3           memoise_2.0.1          bslib_0.6.2            ## [163] bit_4.0.5              readxl_1.4.3"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"MISTy designed analyze spatial omics datasets within distinct spatial contexts referred views. analysis can focus solely structural information. Spatial transcriptomic methods 10x Visium capture information areas containing multiple cells. , deconvolution applied relate measured data spots back individual cells. commonly used tool deconvolution step cell2location. vignette presents workflow analysis structural data, guiding users application mistyR results cell2location deconvolution. Load necessary packages:","code":"# MISTy  library(mistyR)  library(future)   #Seurat  library(Seurat) library(SeuratObject)  # Data manipulation  library(tidyverse)   # Distances library(distances)"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"get-and-load-the-data","dir":"Articles","previous_headings":"","what":"Get and load the data","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"showcase, use 10X Visium spatial slide Kuppe et al., 2022, created spatial multi-omic map human myocardial infarction. example data comes human heart later state myocardial infarction used study. Seurat object contains, among things, coordinates spots slides cellular composition estimated cell2location. First, download extract file: next step load data extract cell composition location spots. rows shifted, means real distances two spots always . therefore advantageous use pixel coordinates instead row column numbers, distances represented accurately.","code":"download.file(\"https://zenodo.org/records/6580069/files/10X_Visium_ACH005.tar.gz?download=1\",     destfile = \"10X_Visium_ACH005.tar.gz\", method = \"curl\") untar(\"10X_Visium_ACH005.tar.gz\") # Load file into R seurat_vs <- readRDS(\"ACH005/ACH005.rds\")  # Extract the cell composition composition <- as_tibble(t(seurat_vs[[\"c2l_props\"]]$data))   # Extract the location data geometry <- GetTissueCoordinates(seurat_vs, cols = c(\"imagerow\", \"imagecol\"), scale = NULL)"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"visualize-cell-proportion-in-spots","dir":"Articles","previous_headings":"","what":"Visualize cell proportion in spots","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"First, visually explore slide graphical representation cell-type proportions spot. adding interactive = TRUE SpatialFeaturePlot can cycle proportions different celltypes.   Based plots, can observe cell types found frequently others. Additionally, can identify patterns distribution cells, widespread across entire slide others concentrated specific areas. Furthermore, cell types share similar distribution.","code":"# Tissue Slide SpatialPlot(seurat_vs, keep.scale = NULL, alpha = 0) # Cell type proportions DefaultAssay(seurat_vs) <- \"c2l_props\" SpatialFeaturePlot(seurat_vs, keep.scale = NULL, features = \"CM\")"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"misty-views","dir":"Articles","previous_headings":"","what":"MISTy views","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"First, need define intraview captures cell type proportions within spot. capture distribution cell type proportions surrounding tissue, add paraview. vignette, radius choose mean distance nearest neighbor plus standard deviation. calculate weights spot family = gaussian. run MISTy collect results.","code":"# Calculating the radius geom_dist <- as.matrix(distances(geometry))   dist_nn <- apply(geom_dist, 1, function(x) (sort(x)[2])) paraview_radius <- ceiling(mean(dist_nn+ sd(dist_nn)))  # Create views heart_views <- create_initial_view(composition) %>%   add_paraview(geometry, l= paraview_radius, family = \"gaussian\")  # Run misty and collect results run_misty(heart_views, \"result/vignette_structural_pipeline\") ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/vignette_structural_pipeline\" misty_results <- collect_results(\"result/vignette_structural_pipeline\")"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"downstream-analysis","dir":"Articles","previous_headings":"","what":"Downstream Analysis","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"collected results, can now answer following questions:","code":""},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"to-what-extent-can-the-occurring-cell-types-of-the-surrounding-tissue-explain-the-cell-type-composition-of-the-spot-compared-to-the-intraview","dir":"Articles","previous_headings":"Downstream Analysis","what":"1. To what extent can the occurring cell types of the surrounding tissue explain the cell type composition of the spot compared to the intraview?","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"can look two different statistics: multi.R2 shows total variance explained multiview model. gain.R2 shows increase explainable variance paraview.   paraview particularly increases explained variance adipocytes mast cells. general, significant gain R2 can interpreted following: “can better explain expression marker X consider additional views intrinsic view.”","code":"misty_results %>%   plot_improvement_stats(\"multi.R2\") %>%    plot_improvement_stats(\"gain.R2\") ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`)."},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"what-are-the-specific-relations-that-can-explain-the-contributions","dir":"Articles","previous_headings":"Downstream Analysis","what":"2. What are the specific relations that can explain the contributions?","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"explain contributions, can visualize importance cell type predicting cell type distribution view separately. First, intrinsic view:  can observe cardiomyocytes significant predictor several cell types spot. identify target best prediction cardiomyocytes, can view importance values follows: Let’s take look spatial distribution cell types tissue slide:  can observe areas high proportions cardiomyocytes low proportions fibroblasts vice versa. Now repeat analysis paraview. trim display targets value 1.75% gain.R2. set importance threshold apply cutoff.  , select target adipocytes, know previous analysis paraview contributes large part explaining distribution. best predictor adipocytes proliferating cells:  plots show us , places, localization two cell types overlap.","code":"misty_results %>% plot_interaction_heatmap(view = \"intra\", clean = TRUE) misty_results$importances.aggregated %>%   filter(view == \"intra\", Predictor == \"CM\") %>%   arrange(-Importance) ## # A tibble: 11 × 5 ##    view  Predictor Target   Importance nsamples ##    <chr> <chr>     <chr>         <dbl>    <int> ##  1 intra CM        Fib          2.74          1 ##  2 intra CM        vSMCs        2.43          1 ##  3 intra CM        prolif       2.23          1 ##  4 intra CM        Myeloid      2.21          1 ##  5 intra CM        Endo         2.15          1 ##  6 intra CM        Mast         2.02          1 ##  7 intra CM        PC           1.90          1 ##  8 intra CM        Lymphoid     0.844         1 ##  9 intra CM        Adipo       -0.0416        1 ## 10 intra CM        Neuronal    -0.0865        1 ## 11 intra CM        CM          NA             1 SpatialFeaturePlot(seurat_vs, keep.scale = NULL, features = c(\"Fib\",\"CM\"), image.alpha = 0) misty_results %>% plot_interaction_heatmap(view = \"para.126\", clean = TRUE,                                             trim = 1.75, trim.measure = \"gain.R2\",                                            cutoff = 0.5) SpatialFeaturePlot(seurat_vs, keep.scale = NULL, features = c(\"prolif\",\"Adipo\"), image.alpha = 0)"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"browseVignettes(\"mistyR\")","code":""},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineC2L.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Structural analysis with MISTy - based on cell2location deconvolution","text":"output sessionInfo() point document compiled.","code":"sessionInfo() ## R version 4.3.3 (2024-02-29) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] distances_0.1.10   lubridate_1.9.3    forcats_1.0.0      stringr_1.5.1      ##  [5] dplyr_1.1.4        purrr_1.0.2        readr_2.1.5        tidyr_1.3.1        ##  [9] tibble_3.2.1       ggplot2_3.5.0      tidyverse_2.0.0    Seurat_5.0.3       ## [13] SeuratObject_5.0.1 sp_2.1-3           future_1.33.1      mistyR_1.10.0      ## [17] BiocStyle_2.30.0   ##  ## loaded via a namespace (and not attached): ##   [1] RcppAnnoy_0.0.22       splines_4.3.3          later_1.3.2            ##   [4] filelock_1.0.3         R.oo_1.26.0            polyclip_1.10-6        ##   [7] hardhat_1.3.1          pROC_1.18.5            rpart_4.1.23           ##  [10] fastDummies_1.7.3      lifecycle_1.0.4        vroom_1.6.5            ##  [13] globals_0.16.3         lattice_0.22-5         MASS_7.3-60.0.1        ##  [16] magrittr_2.0.3         plotly_4.10.4          sass_0.4.9             ##  [19] rmarkdown_2.26         jquerylib_0.1.4        yaml_2.3.8             ##  [22] rlist_0.4.6.2          httpuv_1.6.14          sctransform_0.4.1      ##  [25] spam_2.10-0            spatstat.sparse_3.0-3  reticulate_1.35.0      ##  [28] cowplot_1.1.3          pbapply_1.7-2          RColorBrewer_1.1-3     ##  [31] abind_1.4-5            Rtsne_0.17             R.utils_2.12.3         ##  [34] nnet_7.3-19            ipred_0.9-14           lava_1.8.0             ##  [37] ggrepel_0.9.5          irlba_2.3.5.1          listenv_0.9.1          ##  [40] spatstat.utils_3.0-4   goftest_1.2-3          RSpectra_0.16-1        ##  [43] spatstat.random_3.2-3  fitdistrplus_1.1-11    parallelly_1.37.1      ##  [46] pkgdown_2.0.7          leiden_0.4.3.1         codetools_0.2-19       ##  [49] tidyselect_1.2.1       farver_2.1.1           stats4_4.3.3           ##  [52] matrixStats_1.2.0      spatstat.explore_3.2-7 jsonlite_1.8.8         ##  [55] caret_6.0-94           ellipsis_0.3.2         progressr_0.14.0       ##  [58] ggridges_0.5.6         survival_3.5-8         iterators_1.0.14       ##  [61] systemfonts_1.0.6      foreach_1.5.2          tools_4.3.3            ##  [64] ragg_1.3.0             ica_1.0-3              Rcpp_1.0.12            ##  [67] glue_1.7.0             prodlim_2023.08.28     gridExtra_2.3          ##  [70] xfun_0.42              ranger_0.16.0          withr_3.0.0            ##  [73] BiocManager_1.30.22    fastmap_1.1.1          fansi_1.0.6            ##  [76] digest_0.6.35          timechange_0.3.0       R6_2.5.1               ##  [79] mime_0.12              textshaping_0.3.7      colorspace_2.1-0       ##  [82] scattermore_1.2        tensor_1.5             spatstat.data_3.0-4    ##  [85] R.methodsS3_1.8.2      utf8_1.2.4             generics_0.1.3         ##  [88] data.table_1.15.2      recipes_1.0.10         class_7.3-22           ##  [91] httr_1.4.7             ridge_3.3              htmlwidgets_1.6.4      ##  [94] ModelMetrics_1.2.2.2   uwot_0.1.16            pkgconfig_2.0.3        ##  [97] gtable_0.3.4           timeDate_4032.109      lmtest_0.9-40          ## [100] furrr_0.3.1            htmltools_0.5.7        dotCall64_1.1-1        ## [103] bookdown_0.38          scales_1.3.0           png_0.1-8              ## [106] gower_1.0.1            knitr_1.45             tzdb_0.4.0             ## [109] reshape2_1.4.4         nlme_3.1-164           cachem_1.0.8           ## [112] zoo_1.8-12             KernSmooth_2.23-22     parallel_4.3.3         ## [115] miniUI_0.1.1.1         desc_1.4.3             pillar_1.9.0           ## [118] grid_4.3.3             vctrs_0.6.5            RANN_2.6.1             ## [121] promises_1.2.1         xtable_1.8-4           cluster_2.1.6          ## [124] evaluate_0.23          cli_3.6.2              compiler_4.3.3         ## [127] crayon_1.5.2           rlang_1.1.3            future.apply_1.11.1    ## [130] labeling_0.4.3         plyr_1.8.9             fs_1.6.3               ## [133] stringi_1.8.3          viridisLite_0.4.2      deldir_2.0-4           ## [136] assertthat_0.2.1       munsell_0.5.0          lazyeval_0.2.2         ## [139] spatstat.geom_3.2-9    Matrix_1.6-5           RcppHNSW_0.6.0         ## [142] hms_1.1.3              patchwork_1.2.0        bit64_4.0.5            ## [145] shiny_1.8.0            highr_0.10             ROCR_1.0-11            ## [148] igraph_2.0.3           memoise_2.0.1          bslib_0.6.2            ## [151] bit_4.0.5"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"MISTy designed analyze spatial omics datasets within distinct spatial contexts referred views. analysis can focus solely structural information. Spatial transcriptomic methods Visium capture information areas containing multiple cells. , deconvolution applied relate measured data spots back individual cells. vignette use R package DOT deconvolution. vignette presents workflow analysis structural data, guiding users application mistyR results DOT deconvolution. package DOT can installed Github remotes::install_github(\"saezlab/DOT\"). Load necessary packages:","code":"# MISTy  library(mistyR)  library(future)   # DOT library(DOT)  # Loading experiment data  library(Seurat) library(SeuratObject)  # Data manipulation  library(tidyverse)   # Distances library(distances)"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"get-and-load-the-data","dir":"Articles","previous_headings":"","what":"Get and load the data","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"showcase, use 10X Visium spatial slide Kuppe et al., 2022, created spatial multi-omic map human myocardial infarction. tissue example data comes human heart patient 14 later state myocardial infarction. Seurat object contains, among things, spot coordinates slides need decomposition. First, download extract file: next step load data extract location spots. rows shifted, means real distances two spots always . therefore advantageous use pixel coordinates instead row column numbers, distances represented accurately. deconvolution, additionally need reference single-cell data set containing gene x cell count matrix vector containing corresponding cell annotations. Kuppe et al., 2022, isolated nuclei sample’s remaining tissue snRNA-seq. data corresponding patient spatial data used reference data DOT. First download file: Now load data. , retrieve gene x cell count matrix respective cell annotations.","code":"# Download the data download.file(\"https://zenodo.org/records/6580069/files/10X_Visium_ACH005.tar.gz?download=1\",     destfile = \"10X_Visium_ACH005.tar.gz\", method = \"curl\") untar(\"10X_Visium_ACH005.tar.gz\") spatial_data <- readRDS(\"ACH005/ACH005.rds\")  geometry <- GetTissueCoordinates(spatial_data, cols = c(\"imagerow\", \"imagecol\"), scale = NULL) download.file(\"https://www.dropbox.com/scl/fi/sq24xaavxplkc98iimvpz/hca_p14.rds?rlkey=h8cyxzhypavkydbv0z3pqadus&dl=1\",               destfile = \"hca_p14.rds\",               mode = \"wb\") ref_data <- readRDS(\"hca_p14.rds\")  ref_counts_P14 <- ref_data$counts ref_ct <- ref_data$celltypes"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"deconvolution-with-dot","dir":"Articles","previous_headings":"","what":"Deconvolution with DOT","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"Next, need set DOT object. inputs need count matrix pixel coordinates spatial data count matrix cell annotations single-cell reference data. Now can carry deconvolution: results can found dot@weights. obtain calculated cell-type proportion per spot, normalize result row sum 1.","code":"dot.srt <-setup.srt(srt_data = spatial_data@assays$Spatial@counts, srt_coords = geometry)   dot.ref <- setup.ref(ref_data = ref_counts_P14, ref_annotations = ref_ct, 10)  dot <- create.DOT(dot.srt, dot.ref) # Run DOT dot <- run.DOT.lowresolution(dot) # Normalize DOT results DOT_weights <- sweep(dot@weights, 1, rowSums(dot@weights), \"/\")"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"visualize-cell-proportion-in-spots","dir":"Articles","previous_headings":"","what":"Visualize cell proportion in spots","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"Now can visually explore slide abundance cell types spot.   Based plots, can observe cell types found frequently others. Additionally, can identify patterns distribution cells, widespread across entire slide others concentrated specific areas. Furthermore, cell types share similar distribution.","code":"# Tissue Slide SpatialPlot(spatial_data, keep.scale = NULL, alpha = 0) # Results DOT draw_maps(geometry,            DOT_weights,            background = \"white\",            normalize = FALSE,            ncol = 3,            viridis_option = \"viridis\")"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"misty-views","dir":"Articles","previous_headings":"","what":"MISTy views","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"First, need define intraview captures cell type proportions within spot. capture distribution cell type proportions surrounding tissue, add paraview. vignette, radius choose mean distance nearest neighbor plus standard deviation. calculate weights spot family = gaussian. run MISTy collect results.","code":"# Calculating the radius geom_dist <- as.matrix(distances(geometry))   dist_nn <- apply(geom_dist, 1, function(x) (sort(x)[2])) paraview_radius <- ceiling(mean(dist_nn+ sd(dist_nn)))  # Create views heart_views <- create_initial_view(as.data.frame(DOT_weights)) %>%   add_paraview(geometry, l= paraview_radius, family = \"gaussian\")  # Run misty and collect results run_misty(heart_views, \"result/vignette_structural_pipeline\") ## [1] \"/home/runner/work/mistyR/mistyR/vignettes/result/vignette_structural_pipeline\" misty_results <- collect_results(\"result/vignette_structural_pipeline\")"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"downstream-analysis","dir":"Articles","previous_headings":"","what":"Downstream Analysis","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"collected results, can now answer following questions:","code":""},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"to-what-extent-can-the-occurring-cell-types-of-the-surrounding-tissue-explain-the-cell-type-composition-of-the-spot-compared-to-the-intraview","dir":"Articles","previous_headings":"Downstream Analysis","what":"1. To what extent can the occurring cell types of the surrounding tissue explain the cell type composition of the spot compared to the intraview?","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"can look two different statistics: multi.R2 shows total variance explained multiview model. gain.R2 shows increase explainable variance paraview.   paraview particularly increases explained variance adipocytes. general, significant gain R2 can interpreted following: “can better explain expression marker X consider additional views intrinsic view.”","code":"misty_results %>%   plot_improvement_stats(\"multi.R2\") %>%    plot_improvement_stats(\"gain.R2\") ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`). ## Warning: Removed 11 rows containing missing values or values outside the scale range ## (`geom_segment()`)."},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"what-are-the-specific-relations-that-can-explain-the-contributions","dir":"Articles","previous_headings":"Downstream Analysis","what":"2. What are the specific relations that can explain the contributions?","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"explain contributions, can visualize importance cell type predicting cell type distribution view separately. trim, display targets value 50% multi.R2. set importance threshold apply cutoff. First, intrinsic view:  can observe cardiomyocytes significant predictor cell types spot. identify target best prediction cardiomyocytes, can view importance values follows: Let’s take look spatial distribution Cardiomyocytes important target, fibroblasts, tissue slide:  can observe areas high proportions cardiomyocytes low proportions fibroblasts vice versa. Now repeat analysis paraview:  , select target adipocytes, know previous analysis adipocytes highest gain.R2. best predictor adipocytes Myeloid cells. better identify localization two cell types, set color scaling smaller range, spots high proportion, makes distribution spots low proportion difficult recognize.  plots show us , places, localization two cell types overlap.","code":"misty_results %>% plot_interaction_heatmap(view = \"intra\",                                             clean = TRUE,                                            trim.measure = \"multi.R2\",                                            trim = 50) misty_results$importances.aggregated %>%   filter(view == \"intra\", Predictor == \"CM\") %>%   arrange(-Importance) ## # A tibble: 11 × 5 ##    view  Predictor Target   Importance nsamples ##    <chr> <chr>     <chr>         <dbl>    <int> ##  1 intra CM        Fib          2.82          1 ##  2 intra CM        vSMCs        2.71          1 ##  3 intra CM        Endo         2.55          1 ##  4 intra CM        PC           2.48          1 ##  5 intra CM        Myeloid      2.35          1 ##  6 intra CM        Adipo        1.87          1 ##  7 intra CM        Mast         0.475         1 ##  8 intra CM        prolif       0.457         1 ##  9 intra CM        Lymphoid     0.325         1 ## 10 intra CM        Neuronal    -0.0959        1 ## 11 intra CM        CM          NA             1 draw_maps(geometry,            DOT_weights[, c(\"Fib\", \"CM\")],            background = \"white\",            size = 1.25,            normalize = FALSE,            ncol = 1,           viridis_option = \"viridis\") misty_results %>% plot_interaction_heatmap(view = \"para.126\",                                             clean = TRUE,                                             trim = 0.1,                                            trim.measure = \"gain.R2\") draw_maps(geometry,           DOT_weights[, c(\"Myeloid\",\"Adipo\")],           background = \"white\",           size = 1.25,           normalize = FALSE,            ncol = 1,           viridis_option = \"viridis\") +        scale_colour_viridis_c(limits = c(0,0.33))"},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"browseVignettes(\"mistyR\")","code":""},{"path":"https://saezlab.github.io/mistyR/articles/MistyRStructuralAnalysisPipelineDOT.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Structural analysis with MISTy - based on DOT deconvolution","text":"output sessionInfo() point document compiled.","code":"sessionInfo() ## R version 4.3.3 (2024-02-29) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] distances_0.1.10   lubridate_1.9.3    forcats_1.0.0      stringr_1.5.1      ##  [5] dplyr_1.1.4        purrr_1.0.2        readr_2.1.5        tidyr_1.3.1        ##  [9] tibble_3.2.1       ggplot2_3.5.0      tidyverse_2.0.0    Seurat_5.0.3       ## [13] SeuratObject_5.0.1 sp_2.1-3           DOT_0.0.0.9000     future_1.33.1      ## [17] mistyR_1.10.0      BiocStyle_2.30.0   ##  ## loaded via a namespace (and not attached): ##   [1] RcppAnnoy_0.0.22       splines_4.3.3          later_1.3.2            ##   [4] filelock_1.0.3         fields_15.2            R.oo_1.26.0            ##   [7] polyclip_1.10-6        hardhat_1.3.1          pROC_1.18.5            ##  [10] rpart_4.1.23           fastDummies_1.7.3      lifecycle_1.0.4        ##  [13] vroom_1.6.5            globals_0.16.3         lattice_0.22-5         ##  [16] MASS_7.3-60.0.1        magrittr_2.0.3         plotly_4.10.4          ##  [19] sass_0.4.9             rmarkdown_2.26         jquerylib_0.1.4        ##  [22] yaml_2.3.8             rlist_0.4.6.2          httpuv_1.6.14          ##  [25] sctransform_0.4.1      spam_2.10-0            spatstat.sparse_3.0-3  ##  [28] reticulate_1.35.0      cowplot_1.1.3          pbapply_1.7-2          ##  [31] RColorBrewer_1.1-3     maps_3.4.2             abind_1.4-5            ##  [34] Rtsne_0.17             R.utils_2.12.3         nnet_7.3-19            ##  [37] ipred_0.9-14           lava_1.8.0             ggrepel_0.9.5          ##  [40] irlba_2.3.5.1          listenv_0.9.1          spatstat.utils_3.0-4   ##  [43] goftest_1.2-3          RSpectra_0.16-1        spatstat.random_3.2-3  ##  [46] fitdistrplus_1.1-11    parallelly_1.37.1      pkgdown_2.0.7          ##  [49] leiden_0.4.3.1         codetools_0.2-19       tidyselect_1.2.1       ##  [52] farver_2.1.1           stats4_4.3.3           matrixStats_1.2.0      ##  [55] spatstat.explore_3.2-7 jsonlite_1.8.8         caret_6.0-94           ##  [58] ellipsis_0.3.2         progressr_0.14.0       ggridges_0.5.6         ##  [61] survival_3.5-8         iterators_1.0.14       systemfonts_1.0.6      ##  [64] foreach_1.5.2          tools_4.3.3            ragg_1.3.0             ##  [67] ica_1.0-3              Rcpp_1.0.12            glue_1.7.0             ##  [70] prodlim_2023.08.28     gridExtra_2.3          xfun_0.42              ##  [73] ranger_0.16.0          withr_3.0.0            BiocManager_1.30.22    ##  [76] fastmap_1.1.1          fansi_1.0.6            digest_0.6.35          ##  [79] timechange_0.3.0       R6_2.5.1               mime_0.12              ##  [82] textshaping_0.3.7      colorspace_2.1-0       scattermore_1.2        ##  [85] tensor_1.5             spatstat.data_3.0-4    R.methodsS3_1.8.2      ##  [88] utf8_1.2.4             generics_0.1.3         data.table_1.15.2      ##  [91] recipes_1.0.10         class_7.3-22           httr_1.4.7             ##  [94] ridge_3.3              htmlwidgets_1.6.4      ModelMetrics_1.2.2.2   ##  [97] uwot_0.1.16            pkgconfig_2.0.3        gtable_0.3.4           ## [100] timeDate_4032.109      lmtest_0.9-40          furrr_0.3.1            ## [103] htmltools_0.5.7        dotCall64_1.1-1        bookdown_0.38          ## [106] scales_1.3.0           png_0.1-8              gower_1.0.1            ## [109] knitr_1.45             tzdb_0.4.0             reshape2_1.4.4         ## [112] nlme_3.1-164           cachem_1.0.8           zoo_1.8-12             ## [115] KernSmooth_2.23-22     parallel_4.3.3         miniUI_0.1.1.1         ## [118] desc_1.4.3             pillar_1.9.0           grid_4.3.3             ## [121] vctrs_0.6.5            RANN_2.6.1             promises_1.2.1         ## [124] xtable_1.8-4           cluster_2.1.6          evaluate_0.23          ## [127] cli_3.6.2              compiler_4.3.3         crayon_1.5.2           ## [130] rlang_1.1.3            future.apply_1.11.1    labeling_0.4.3         ## [133] plyr_1.8.9             fs_1.6.3               stringi_1.8.3          ## [136] viridisLite_0.4.2      deldir_2.0-4           assertthat_0.2.1       ## [139] munsell_0.5.0          lazyeval_0.2.2         spatstat.geom_3.2-9    ## [142] Matrix_1.6-5           RcppHNSW_0.6.0         hms_1.1.3              ## [145] patchwork_1.2.0        bit64_4.0.5            shiny_1.8.0            ## [148] highr_0.10             ROCR_1.0-11            igraph_2.0.3           ## [151] memoise_2.0.1          bslib_0.6.2            bit_4.0.5"},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"MISTy representation based analysis of IMC breast cancer data","text":"MISTy uses explainable machine learning algorithm analyze spatial omics data sets within spatial contexts, called views. Structural functional data can used train MISTy model one samples. training model, result space, samples represented vector consisting sample signatures. three signatures: performance, contribution, importance. marker, signatures concatenation following values: Performance signature: variance explained using intraview alone, variance explained multiview model, well explained gain variance marker. Contribution signature: Fraction contribution view marker. Importance signature: estimated weighted importance predictor-target marker pair views. Based signatures, analyze causes differences performance metrics samples. vignette, reproduce signature analysis original publication. data used obtained Imaging Mass Cytometry (IMC) 46 breast cancer samples. total, 26 protein markers measured across three different tumor degrees. MISTy analysis, three views created: intraview, juxtaview, paraview. zone indifference (ZOI) paraview set threshold juxtaview. way, overlap avoided. parameter l optimized marker can found Fig. S8. information paraview parameters see ?add_paraview(). MISTy model trained standard parameters. now continue training MISTy model. collected results available imc_bc_optim_zoi.RDS file. First load necessary packages load data:","code":"#MISTy library(mistyR) library(future)  #Data manipulation library(tidyverse)  #Data analysis library(factoextra)  plan(multisession, workers = 6)  #Data  download.file(\"https://www.dropbox.com/scl/fi/yolsq97ouc7ay8wvdibp6/imc_bc_optim_zoi.RDS?rlkey=txu88dec23mtw7tfy99e7ucb0&dl=1\",               destfile = \"imc_bc_optim_zoi.RDS\",                method = \"auto\",               mode = \"wb\")  download.file(\"https://www.dropbox.com/scl/fi/h19svd580yxmue5x2c3he/bc_metadata.tsv?rlkey=j08v6ivjqz5uwn8ldjjbs4f5j&dl=1\",                destfile = \"bc_metadata.tsv\",                method = \"auto\",               mode = \"wb\")  bc_results <- readRDS(\"imc_bc_optim_zoi.RDS\") meta <- read_delim(\"bc_metadata.tsv\", delim = \"\\t\")"},{"path":[]},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"extract-signatures","dir":"Articles","previous_headings":"Performance signature","what":"Extract signatures","title":"MISTy representation based analysis of IMC breast cancer data","text":"Now can extract signatures loaded results. first look R2 signature. Furthermore, remove markers R2 gain less 2% setting trim = 2.","code":"per_signature <- extract_signature(bc_results,                                 type = \"performance\",                                 trim = 2,                                  trim.measure = \"gain.R2\")"},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"perform-pca","dir":"Articles","previous_headings":"Performance signature","what":"Perform PCA","title":"MISTy representation based analysis of IMC breast cancer data","text":"goal find factors responsible differences R2. , perform PCA signatures: identify groups drive differences R2, join metadata PCA results.","code":"persig_pca <- prcomp(per_signature %>% select(-sample)) permeta_pca <- left_join(as_tibble(persig_pca$x) %>%                            mutate(sample = per_signature$sample),                       meta %>%                            filter(`Sample ID` %in% per_signature$sample),                       by = c(\"sample\" = \"Sample ID\")) %>%   mutate(Grade = as.factor(Grade))"},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"plot-results","dir":"Articles","previous_headings":"Performance signature","what":"Plot results","title":"MISTy representation based analysis of IMC breast cancer data","text":"combined data, plot PCA colored factors grade clinical sub-type.   plots show slight, clearly defined groupings according two factors. Next, investigate importance R2 signature components protein markers PCA.  first two principal components cover 50.8% variance samples. observe gain variance protein markers CD68, ki67, SMA (smooth muscle actin) highest. proteins associate processes promoting phagocytosis, cell proliferation, vascularization, respectively. suggests changes processes may drive differences tumor grades clinical sub-types.","code":"#Grade ggplot(permeta_pca %>% filter(!is.na(Grade)), aes(x = PC1, y = PC2)) +   geom_point(aes(color = Grade), size = 3) +   coord_fixed() +   scale_color_brewer(palette = \"Set2\") +   theme_classic() #Sub-type ggplot(permeta_pca %>%filter(!is.na(Grade), HER2 != \"?\"),           aes(x = PC1, y = PC2)) +   geom_point(aes(color = clinical_type), size = 3) +   coord_fixed() +   scale_color_brewer(palette = \"Set2\") +   theme_classic() fviz_pca_var(persig_pca,              col.var = \"cos2\",               repel = TRUE,               select.var = list(cos2 = 15),              gradient.cols = c(\"#666666\", \"#377EB8\", \"#E41A1C\")) +    theme_classic()"},{"path":[]},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"extract-signatures-1","dir":"Articles","previous_headings":"Importance signature","what":"Extract signatures","title":"MISTy representation based analysis of IMC breast cancer data","text":"repeat approach now importance signatures. First, extract : , removed markers exhibit less 2% gain R2.","code":"imp_signature <- extract_signature(bc_results,                                     type = \"importance\",                                     trim = 2,                                      trim.measure = \"gain.R2\")"},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"perform-pca-1","dir":"Articles","previous_headings":"Importance signature","what":"Perform PCA","title":"MISTy representation based analysis of IMC breast cancer data","text":"Perform PCA: Join metadata PCA results:","code":"impsig_pca <- prcomp(imp_signature %>% select(-sample)) impmeta_pca <- left_join(as_tibble(impsig_pca$x) %>%                            mutate(sample = imp_signature$sample),                       meta %>%                            filter(`Sample ID` %in% imp_signature$sample),                       by = c(\"sample\" = \"Sample ID\")) %>%   mutate(Grade = as.factor(Grade))"},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"plot-results-1","dir":"Articles","previous_headings":"Importance signature","what":"Plot results","title":"MISTy representation based analysis of IMC breast cancer data","text":"Plot PCA colored factors grade clinical sub-type:   observe weak clustering colored tumor grade. Lastly, take look importance signature components PCA. case, importance interaction protein markers predictor-target pairs view. Thus variable naming follows pattern view_predictor_target.  time, first two principal components cover 16% variance samples. can explained richer information used PCA. notice driving interactions paraview, reminding us significant role spatial context.","code":"#Grade ggplot(impmeta_pca %>% filter(!is.na(Grade)), aes(x = PC1, y = PC2)) +   geom_point(aes(color = Grade), size = 3) +   coord_fixed() +   scale_color_brewer(palette = \"Set2\") +   theme_classic() #Sub-type ggplot(impmeta_pca %>% filter(!is.na(Grade), HER2 != \"?\") %>%           mutate(clinical_type = paste0(ifelse(ER==\"+\" | PR==\"+\", \"HR+\", \"HR-\"),\"HER2\",HER2)),        aes(x = PC1, y = PC2)) +   geom_point(aes(color = clinical_type), size = 3) +   coord_fixed() +   scale_color_brewer(palette = \"Set2\") +   theme_classic() fviz_pca_var(impsig_pca,              col.var = \"cos2\",               select.var = list(cos2 = 15),              gradient.cols = c(\"#666666\", \"#377EB8\", \"#E41A1C\"),               repel = TRUE) +    theme_classic()"},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"MISTy representation based analysis of IMC breast cancer data","text":"browseVignettes(\"mistyR\")","code":""},{"path":"https://saezlab.github.io/mistyR/articles/ReproduceSignaturePaper.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"MISTy representation based analysis of IMC breast cancer data","text":"output sessionInfo() point document compiled.","code":"sessionInfo() ## R version 4.3.3 (2024-02-29) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] factoextra_1.0.7 lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1    ##  [5] dplyr_1.1.4      purrr_1.0.2      readr_2.1.5      tidyr_1.3.1      ##  [9] tibble_3.2.1     ggplot2_3.5.0    tidyverse_2.0.0  future_1.33.1    ## [13] mistyR_1.10.0    BiocStyle_2.30.0 ##  ## loaded via a namespace (and not attached): ##  [1] gtable_0.3.4        xfun_0.42           bslib_0.6.2         ##  [4] rstatix_0.7.2       ggrepel_0.9.5       tzdb_0.4.0          ##  [7] vctrs_0.6.5         tools_4.3.3         generics_0.1.3      ## [10] parallel_4.3.3      fansi_1.0.6         highr_0.10          ## [13] pkgconfig_2.0.3     RColorBrewer_1.1-3  desc_1.4.3          ## [16] assertthat_0.2.1    lifecycle_1.0.4     farver_2.1.1        ## [19] compiler_4.3.3      textshaping_0.3.7   munsell_0.5.0       ## [22] codetools_0.2-19    carData_3.0-5       htmltools_0.5.7     ## [25] sass_0.4.9          yaml_2.3.8          car_3.1-2           ## [28] ggpubr_0.6.0        pillar_1.9.0        pkgdown_2.0.7       ## [31] crayon_1.5.2        jquerylib_0.1.4     cachem_1.0.8        ## [34] abind_1.4-5         parallelly_1.37.1   tidyselect_1.2.1    ## [37] digest_0.6.35       stringi_1.8.3       bookdown_0.38       ## [40] listenv_0.9.1       labeling_0.4.3      fastmap_1.1.1       ## [43] grid_4.3.3          colorspace_2.1-0    cli_3.6.2           ## [46] magrittr_2.0.3      utf8_1.2.4          broom_1.0.5         ## [49] withr_3.0.0         backports_1.4.1     scales_1.3.0        ## [52] bit64_4.0.5         timechange_0.3.0    rmarkdown_2.26      ## [55] globals_0.16.3      bit_4.0.5           ggsignif_0.6.4      ## [58] ragg_1.3.0          hms_1.1.3           memoise_2.0.1       ## [61] evaluate_0.23       knitr_1.45          rlang_1.1.3         ## [64] Rcpp_1.0.12         glue_1.7.0          BiocManager_1.30.22 ## [67] vroom_1.6.5         jsonlite_1.8.8      R6_2.5.1            ## [70] systemfonts_1.0.6   fs_1.6.3"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"mistyR and data formats","text":"mistyR can used analyze spatial omics data sets stored SpatialExperiment, SeuratObject anndata object just couple functions. vignette demonstrate build user friendly workflow starting data preprocessing, running mistyR, analysis results, focusing functional representation 10x Visium data. First load packages needed analysis. example, analyze 10X Visium spatial gene expression dataset one breast cancer section (Block Section 1) available [https://support.10xgenomics.com/spatial-gene-expression/datasets]. convenience, make dataset available object several popular formats including SpatialExperiment, SeuratObject anndata demonstrate extract data needed analysis objects. explore spatial interactions Hypoxia pathway responsive genes Estrogen pathway responsive genes. end convert count based representation data representation based pathway specific genes /estimated pathway activities. end use package decoupleR.","code":"# MISTy library(mistyR) library(future)  # data manipulation library(Matrix) library(tibble) library(dplyr) library(purrr)  # normalization library(sctransform)  # resource library(decoupleR)  # plotting library(ggplot2)  # setup parallel execution plan(multisession)"},{"path":[]},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"spatialexperiment","dir":"Articles","previous_headings":"Get the data","what":"SpatialExperiment","title":"mistyR and data formats","text":"load packages needed work SpatialExperiment data download object. Next, read object extract expression location data.","code":"# SpatialExperiment library(SpatialExperiment) #> Loading required package: SingleCellExperiment #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: 'matrixStats' #> The following object is masked from 'package:dplyr': #>  #>     count #>  #> Attaching package: 'MatrixGenerics' #> The following objects are masked from 'package:matrixStats': #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following objects are masked from 'package:dplyr': #>  #>     combine, intersect, setdiff, union #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     anyDuplicated, aperm, append, as.data.frame, basename, cbind, #>     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find, #>     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply, #>     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, #>     Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort, #>     table, tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: 'S4Vectors' #> The following objects are masked from 'package:dplyr': #>  #>     first, rename #> The following objects are masked from 'package:Matrix': #>  #>     expand, unname #> The following object is masked from 'package:utils': #>  #>     findMatches #> The following objects are masked from 'package:base': #>  #>     expand.grid, I, unname #> Loading required package: IRanges #>  #> Attaching package: 'IRanges' #> The following object is masked from 'package:purrr': #>  #>     reduce #> The following objects are masked from 'package:dplyr': #>  #>     collapse, desc, slice #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: 'Biobase' #> The following object is masked from 'package:MatrixGenerics': #>  #>     rowMedians #> The following objects are masked from 'package:matrixStats': #>  #>     anyMissing, rowMedians library(SingleCellExperiment) library(SummarizedExperiment)   download.file(\"https://www.dropbox.com/scl/fi/7mdmz6vk10ib55qn7w3fw/visium_spe.rds?rlkey=j03qamdm9zcin577chlabms0m&dl=1\",     destfile = \"visium_spe.rds\", mode =\"wb\", quiet = TRUE   ) spe.vs <- readRDS(\"visium_spe.rds\")   # Expression data expression <- counts(spe.vs)  # deal with duplicate names symbols <- rowData(spe.vs)$symbol d.index <- which(duplicated(symbols)) symbols[d.index] <- paste0(symbols[d.index],\".1\") rownames(expression) <- symbols  # Location data geometry <- as.data.frame(colData(spe.vs)) %>%   select(array_row, array_col)  colnames(geometry) <- c(\"row\", \"col\")"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"seurat","dir":"Articles","previous_headings":"Get the data","what":"Seurat","title":"mistyR and data formats","text":"load packages needed work SeuratObject data download object. Next, read object extract expression location data.","code":"# Seurat library(Seurat)  download.file(\"https://www.dropbox.com/scl/fi/44zf4le1xcq7ichjp11bg/visium_seurat.rds?rlkey=ikrrsp2rncqde0nnsbdte1joa&dl=1\",     destfile = \"visium_seurat.rds\", mode =\"wb\", quiet = TRUE   ) seurat.vs <- readRDS(\"visium_seurat.rds\")   # Expression data expression <- GetAssayData(   object = seurat.vs,   slot = \"counts\",   assay = \"Spatial\" )  # Seurat deals with duplicates internally in similar way as above  # Location data geometry <- GetTissueCoordinates(seurat.vs,     cols = c(\"row\", \"col\"), scale = NULL   )"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"anndata","dir":"Articles","previous_headings":"Get the data","what":"AnnData","title":"mistyR and data formats","text":"load packages needed work SeuratObject data download object. Next, read object extract expression location data.","code":"# AnnData library(anndata)  download.file(\"https://www.dropbox.com/scl/fi/jubijl0pr8rhka8mfjpcn/visium_anndata.h5ad?rlkey=xmhmfl5oz61dgngmackkklp32&dl=1\",     destfile = \"visium_anndata.h5ad\", mode =\"wb\", quiet = TRUE   ) anndata.vs <- read_h5ad(\"visium_anndata.h5ad\")   # Expression data # Here the dgRMatrix is converted to a dense matrix for vst compatibility reasons expression <- t(as.matrix(anndata.vs$X))  # deal with duplicate names (alternatively see AnnData.var_names_make_unique) symbols <- rownames(expression) d.index <- which(duplicated(symbols)) symbols[d.index] <- paste0(symbols[d.index],\".1\") rownames(expression) <- symbols  # Location data geometry <- anndata.vs$obs[,c(\"array_row\", \"array_col\")] colnames(geometry) <- c(\"row\", \"col\")"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"preprocess-the-data","dir":"Articles","previous_headings":"","what":"Preprocess the data","title":"mistyR and data formats","text":", analysis proceeds way matter input format.","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"normalize-counts-and-drop-duplicates","dir":"Articles","previous_headings":"Preprocess the data","what":"Normalize counts and drop duplicates","title":"mistyR and data formats","text":"example normalize counts using vst normalization. However, user must define ’s best solution analysis.","code":"norm.data <- vst(as(expression, \"dgCMatrix\"), verbosity = 0)$y"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"filtering-genes-that-are-expressed-in-at-least-5-of-the-spots","dir":"Articles","previous_headings":"Preprocess the data","what":"Filtering genes that are expressed in at least 5% of the spots","title":"mistyR and data formats","text":"","code":"coverage <- rowSums(norm.data > 0) / ncol(norm.data) slide.markers <- names(coverage[coverage >= 0.05])"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"run-misty-on-pathway-specific-genes","dir":"Articles","previous_headings":"","what":"Run MISTy on pathway specific genes","title":"mistyR and data formats","text":"use casewe like dissect relationships Estrogen Hypoxia responsive genes coming two spatial contexts: Relationships within spot relationships broader tissue structure. particular, intrinsic representation use normalized counts Hypoxia responsive genes. explore relationships Hypoxia responsive genes context Visium spot, relationships Hypoxia responsive genes broader tissue structure relationships Estrogen responsive genes Hypoxia responsive genes broader tissue structure.","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"defining-estrogen-and-hypoxia-responsive-genes","dir":"Articles","previous_headings":"Run MISTy on pathway specific genes","what":"Defining Estrogen and Hypoxia responsive genes","title":"mistyR and data formats","text":"simple example pick top 15 significantly responsive genes pathway model matrix resource progeny available package decoupleR.","code":"resource <- get_progeny(organism =\"human\", top = 15)  estrogen.footprints <- resource %>%   filter(source == \"Estrogen\", weight != 0, target %in% slide.markers) %>%    pull(target)  hypoxia.footprints <- resource %>%   filter(source == \"Hypoxia\", weight != 0, target %in% slide.markers) %>%    pull(target)"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"view-composition","dir":"Articles","previous_headings":"Run MISTy on pathway specific genes","what":"View composition","title":"mistyR and data formats","text":"capture relationships interest within descrbed contexts, MISTy model consist three views. First construct Hypoxia specific intraview (capturing expression within spot) add Hypoxia specific paraview (capturing expression broader tissue structure) significance radius 5 spots. next create similar view composition using Estrogen reponsive genes. easy way generate view capture expression Estrogen responsive genes broader tissue structure add previously generated view composition. next combine view composition composition capturing relationships interest: Hypoxia intraview + Hypoxia paraview + Estrogen paraview.","code":"hypoxia.views <- create_initial_view(t(norm.data)[, hypoxia.footprints] %>% as_tibble()) %>%   add_paraview(geometry, l=5) #>  #> Generating paraview estrogen.views <- create_initial_view(t(norm.data)[,estrogen.footprints] %>% as_tibble()) %>%   add_paraview(geometry, l=5) #>  #> Generating paraview misty.views <- hypoxia.views %>% add_views(create_view(\"paraview.estrogen.5\", estrogen.views[[\"paraview.5\"]]$data, \"para.estrogen.5\"))"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"run-misty-and-collect-results","dir":"Articles","previous_headings":"Run MISTy on pathway specific genes","what":"Run MISTy and collect results","title":"mistyR and data formats","text":"","code":"run_misty(misty.views, \"vignette_model_footprints\") #> [1] \"/home/runner/work/mistyR/mistyR/vignettes/vignette_model_footprints\"  misty.results <- collect_results(\"vignette_model_footprints\")"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"interpretation-and-downstream-analysis","dir":"Articles","previous_headings":"Run MISTy on pathway specific genes","what":"Interpretation and downstream analysis","title":"mistyR and data formats","text":"MISTy gives explanatory answers three general questions: 1. much can broader spatial context explain expression markers (contrast intraview)? can observed gain R2 (RMSE) using multiview model contrast single main view model.  example, PGK1 marker whose expression can explained better modeling broader spatial context around spot. can inspect significance gain variance explained, assigned p-value improvement based cross-validation. general, significant gain R2 can interpreted following: “can better explain expression marker X, consider additional views, intrinsic view.” 2.much different view components contribute explaining expression?  case PGK1, observe around 37.7% contribution final model comes expression markers hypoxia intrinsically broader tissue structure. rest (62.3%) comes expression estrogen hypoxia responsive genes broader tissue structure. 3.specific relations can explain contributions? explain contributions, can visualize importances markers coming view separately predictors expression intrinsic markers hypoxia. First, intrinsic importances hypoxia markers.  importances associated relationship markers spot. Let’s pick best predictor PGK1 confirm :   Second, paraview importances hypoxia markers.  importances associated relationship markers spot markers neighborhood (controlled parameter l).   expected, expression EGLN1 (predictor hign importance view) neighborhood spot allows explain expression PGK1. Finally, paraview importances estrogen markers. inspect best predictor view.    visible areas local expression TPD52L1 overlaps areas highest expression PGK1.","code":"misty.results %>%   plot_improvement_stats(\"gain.R2\") %>%   plot_improvement_stats(\"gain.RMSE\") misty.results$improvements %>%   filter(measure == \"p.R2\") %>%   arrange(value) #> # A tibble: 15 × 4 #>    target  sample                                                measure   value #>    <chr>   <chr>                                                 <chr>     <dbl> #>  1 PGK1    /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    4.57e-4 #>  2 ANKZF1  /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    8.78e-4 #>  3 PDK1    /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    3.14e-3 #>  4 FUT11   /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    1.56e-2 #>  5 FAM162A /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    3.11e-2 #>  6 HILPDA  /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    3.24e-2 #>  7 INSIG2  /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    7.65e-2 #>  8 ENO2    /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    1.09e-1 #>  9 NDRG1   /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    1.11e-1 #> 10 EGLN1   /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    1.26e-1 #> 11 PFKFB4  /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    1.79e-1 #> 12 BNIP3L  /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    2.00e-1 #> 13 KDM3A   /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    2.25e-1 #> 14 ANKRD37 /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    2.82e-1 #> 15 GBE1    /home/runner/work/mistyR/mistyR/vignettes/vignette_m… p.R2    8.57e-1 misty.results %>% plot_view_contributions() misty.results$contributions.stats %>% filter(target == \"PGK1\") #> # A tibble: 3 × 6 #>   target view             mean fraction p.mean  p.sd #>   <chr>  <chr>           <dbl>    <dbl>  <dbl> <dbl> #> 1 PGK1   intra           0.513    0.375      0    NA #> 2 PGK1   para.5          0.325    0.237      0    NA #> 3 PGK1   para.estrogen.5 0.531    0.388      0    NA misty.results %>% plot_interaction_heatmap(view = \"intra\") misty.results$importances.aggregated %>%    filter(view == \"intra\", Target == \"PGK1\") %>%   arrange(-Importance) #> # A tibble: 15 × 5 #>    view  Predictor Target Importance nsamples #>    <chr> <chr>     <chr>       <dbl>    <int> #>  1 intra NDRG1     PGK1       2.45          1 #>  2 intra FAM162A   PGK1       1.97          1 #>  3 intra HILPDA    PGK1       0.345         1 #>  4 intra PFKFB4    PGK1       0.203         1 #>  5 intra ENO2      PGK1       0.0588        1 #>  6 intra EGLN1     PGK1      -0.339         1 #>  7 intra KDM3A     PGK1      -0.483         1 #>  8 intra GBE1      PGK1      -0.486         1 #>  9 intra ANKRD37   PGK1      -0.528         1 #> 10 intra ANKZF1    PGK1      -0.565         1 #> 11 intra BNIP3L    PGK1      -0.579         1 #> 12 intra FUT11     PGK1      -0.646         1 #> 13 intra INSIG2    PGK1      -0.674         1 #> 14 intra PDK1      PGK1      -0.733         1 #> 15 intra PGK1      PGK1      NA             1 vis.data <- cbind(geometry, t(norm.data)[,hypoxia.footprints], t(norm.data)[,estrogen.footprints])  ggplot(vis.data, aes(x=col, y=row, color = PGK1)) + geom_point() + theme_void() ggplot(vis.data, aes(x=col, y=row, color = NDRG1)) + geom_point() + theme_void() misty.results %>% plot_interaction_heatmap(view = \"para.5\") ggplot(vis.data, aes(x=col, y=row, color = PGK1)) + geom_point() + theme_void() ggplot(vis.data, aes(x=col, y=row, color = EGLN1)) + geom_point() + theme_void() misty.results %>% plot_interaction_heatmap(view = \"para.estrogen.5\") ggplot(vis.data, aes(x=col, y=row, color = PGK1)) + geom_point() + theme_void() ggplot(vis.data, aes(x=col, y=row, color = TPD52L1)) + geom_point() + theme_void()"},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"important-notes","dir":"Articles","previous_headings":"Run MISTy on pathway specific genes","what":"Important notes","title":"mistyR and data formats","text":"relationships captured importances assumed interpreted linear casual. 1--1 importances predictor markers always interpreted context predictors, since training MISTy models multivariate predictive task.","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"other-use-cases","dir":"Articles","previous_headings":"","what":"Other use cases","title":"mistyR and data formats","text":"shown example way use mistyR analyze spatial transcriptomics data. Similar complementary workflows can constructed describe different aspects biology, example: Spatial interactions pathway activities putative ligands, shown . Spatial interactions cell-state lineage markers putative ligands, shown . Spatial interactions cell-type abundances leveraging deconvolution methods creating descriptions cell colocalization tissue architecture. Additionally, mistyR function collect_results() allows group results multiple slides, allowing robust, integrative comparative analysis spatial interactions.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"more-examples","dir":"Articles","previous_headings":"See also","what":"More examples","title":"mistyR and data formats","text":"browseVignettes(\"mistyR\") Online articles","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"publication","dir":"Articles","previous_headings":"See also","what":"Publication","title":"mistyR and data formats","text":"Jovan Tanevski, Ricardo Omar Ramirez Flores, Attila Gabor, Denis Schapiro, Julio Saez-Rodriguez. Explainable multiview framework dissecting spatial relationships highly multiplexed data. Genome Biology 23, 97 (2022). https://doi.org/10.1186/s13059-022-02663-5","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyDataFormats.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"mistyR and data formats","text":"output sessionInfo() point document compiled:","code":"#> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] SpatialExperiment_1.12.0    SingleCellExperiment_1.24.0 #>  [3] SummarizedExperiment_1.32.0 Biobase_2.62.0              #>  [5] GenomicRanges_1.54.1        GenomeInfoDb_1.38.8         #>  [7] IRanges_2.36.0              S4Vectors_0.40.2            #>  [9] BiocGenerics_0.48.1         MatrixGenerics_1.14.0       #> [11] matrixStats_1.2.0           ggplot2_3.5.0               #> [13] decoupleR_2.8.0             sctransform_0.4.1           #> [15] purrr_1.0.2                 dplyr_1.1.4                 #> [17] tibble_3.2.1                Matrix_1.6-5                #> [19] future_1.33.1               mistyR_1.10.0               #> [21] BiocStyle_2.30.0            #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3      jsonlite_1.8.8          magrittr_2.0.3          #>   [4] magick_2.8.3            farver_2.1.1            rmarkdown_2.26          #>   [7] fs_1.6.3                zlibbioc_1.48.2         ragg_1.3.0              #>  [10] vctrs_0.6.5             memoise_2.0.1           RCurl_1.98-1.14         #>  [13] htmltools_0.5.7         S4Arrays_1.2.1          progress_1.2.3          #>  [16] curl_5.2.1              cellranger_1.1.0        SparseArray_1.2.4       #>  [19] sass_0.4.9              parallelly_1.37.1       bslib_0.6.2             #>  [22] desc_1.4.3              plyr_1.8.9              lubridate_1.9.3         #>  [25] cachem_1.0.8            igraph_2.0.3            lifecycle_1.0.4         #>  [28] pkgconfig_2.0.3         R6_2.5.1                fastmap_1.1.1           #>  [31] GenomeInfoDbData_1.2.11 digest_0.6.35           selectr_0.4-2           #>  [34] colorspace_2.1-0        furrr_0.3.1             textshaping_0.3.7       #>  [37] filelock_1.0.3          labeling_0.4.3          fansi_1.0.6             #>  [40] timechange_0.3.0        httr_1.4.7              abind_1.4-5             #>  [43] compiler_4.3.3          bit64_4.0.5             withr_3.0.0             #>  [46] backports_1.4.1         logger_0.3.0            OmnipathR_3.10.1        #>  [49] highr_0.10              R.utils_2.12.3          MASS_7.3-60.0.1         #>  [52] rappdirs_0.3.3          DelayedArray_0.28.0     rjson_0.2.21            #>  [55] tools_4.3.3             future.apply_1.11.1     R.oo_1.26.0             #>  [58] glue_1.7.0              grid_4.3.3              checkmate_2.3.1         #>  [61] reshape2_1.4.4          generics_0.1.3          gtable_0.3.4            #>  [64] tzdb_0.4.0              R.methodsS3_1.8.2       tidyr_1.3.1             #>  [67] data.table_1.15.2       hms_1.1.3               xml2_1.3.6              #>  [70] utf8_1.2.4              XVector_0.42.0          pillar_1.9.0            #>  [73] stringr_1.5.1           vroom_1.6.5             later_1.3.2             #>  [76] lattice_0.22-5          bit_4.0.5               tidyselect_1.2.1        #>  [79] knitr_1.45              gridExtra_2.3           bookdown_0.38           #>  [82] xfun_0.42               stringi_1.8.3           yaml_2.3.8              #>  [85] evaluate_0.23           codetools_0.2-19        BiocManager_1.30.22     #>  [88] cli_3.6.2               systemfonts_1.0.6       munsell_0.5.0           #>  [91] jquerylib_0.1.4         Rcpp_1.0.12             readxl_1.4.3            #>  [94] globals_0.16.3          parallel_4.3.3          pkgdown_2.0.7           #>  [97] readr_2.1.5             assertthat_0.2.1        prettyunits_1.2.0       #> [100] bitops_1.0-7            listenv_0.9.1           rlist_0.4.6.2           #> [103] scales_1.3.0            crayon_1.5.2            rlang_1.1.3             #> [106] rvest_1.0.4             distances_0.1.10"},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Modeling spatially resolved omics with mistyR","text":"use mistyR conceptualized around building workflow analysis spatial omics data four classes functions: View composition Model training Result processing Plotting construct workflow mistyR designed use pipe operators (example operator %>% magrittr) chaining functions mind. loading mistyR please consider configuring future::multisession() parallel execution plan. mistyR use available cores execution computationally demanding functions. recommended user modifies future::plan() according needs. following example uses synthetically generated benchmark data synthetic included package. dataset list 10 tibbles, representing data generated random layout four cell types empty space 100--100 grid. data generated simulating two-dimensional cellular automata model focuses signaling events. model simulates production, diffusion, degradation interactions 11 molecular species. Note dataset contains simulated measurements non-empty spaces.   information underlying model data generation see help(synthetic) publication.","code":"# MISTy library(mistyR) library(future)  # data manipulation library(dplyr) library(purrr) library(distances)  # plotting library(ggplot2)  plan(multisession) data(\"synthetic\")  ggplot(synthetic[[1]], aes(x = col, y = row, color = type)) +   geom_point(shape = 15, size = 0.7) +   scale_color_manual(values = c(\"#e9eed3\", \"#dcc38d\", \"#c9e2ad\", \"#a6bab6\")) +   theme_void() str(synthetic[[1]], give.attr = FALSE) #> spc_tbl_ [4,205 × 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame) #>  $ row  : num [1:4205] 1 1 1 1 1 1 1 1 1 1 ... #>  $ col  : num [1:4205] 100 11 13 14 15 20 23 24 26 32 ... #>  $ ECM  : num [1:4205] 0.0385 0.0327 0.1444 0.387 0.1635 ... #>  $ ligA : num [1:4205] 0.834 0.119 0.525 0.269 0.195 ... #>  $ ligB : num [1:4205] 0.0157 0.0104 0.014 0.0367 0.1176 ... #>  $ ligC : num [1:4205] 0.236 0.804 0.334 0.502 0.232 ... #>  $ ligD : num [1:4205] 1.183 0.101 0.434 0.241 0.203 ... #>  $ protE: num [1:4205] 1.18 0 1.67 0 0 ... #>  $ protF: num [1:4205] 2.547 0.386 1.614 0.913 0.162 ... #>  $ prodA: num [1:4205] 0.382 0 0.472 0 0 ... #>  $ prodB: num [1:4205] 0 0 0 0 0.16 ... #>  $ prodC: num [1:4205] 0 0.536 0 0.418 0 ... #>  $ prodD: num [1:4205] 0.588 0 0.379 0 0 ... #>  $ type : chr [1:4205] \"CT1\" \"CT2\" \"CT1\" \"CT2\" ..."},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"view-composition","dir":"Articles","previous_headings":"","what":"View composition","title":"Modeling spatially resolved omics with mistyR","text":"mistyR workflow always starts defining intraview (create_initial_view()) containing measurements markers target modeling cell interest. first sample synthetic dataset select markers except ligands available cells. intrinsic view (intraview)1 mistyR model expression marker function expression markers within cell. interested exploring marker expressions coming different spatial contexts complementary, .e., distinguishable contribute explanation overall expression markers. mistyR includes two default helper functions calculating adding views take account spatial context data: add_juxtaview() add_paraview(). juxtaview represent local spatial view captures expression markers available intraview within immediate neighborhood cell. paraview captures expression markers avainalbe intraview boarder tissue structure importance influence proportional inverse distance two cells. add paraview view composition, first need information location cell intraview. Using information can create add paraview importance radius 10 view composition. calculation juxtaview paraview can computationally intensive large number cells sample. Therefore calculation run parallel set future::plan(). computational time needed calculation paraview can also significantly reduced approximation. Refer documentation function (help(add_paraview)) details. relevant custom views can created (create_view()) external resource (data.frame, tibble) added view composition. data contain one row per cell order intraview. example can create view captures mean expression 10 nearest neighbors cell. created view(s) can added (add_views()) existing view composition one one providing form list. examples creating adding custom views composition can found resources See also. Views can also removed composition providing one names views remove_views(). intraview misty.uniqueid removed function.","code":"expr <- synthetic[[1]] %>% select(-c(row, col, type, starts_with(\"lig\")))  misty.intra <- create_initial_view(expr)  summary(misty.intra) #>                Length Class  Mode      #> intraview      2      -none- list      #> misty.uniqueid 1      -none- character summary(misty.intra$intraview) #>        Length Class       Mode      #> abbrev 1      -none-      character #> data   7      spec_tbl_df list pos <- synthetic[[1]] %>% select(row, col)  misty.views <- misty.intra %>% add_paraview(pos, l = 10) #>  #> Generating paraview  summary(misty.views) #>                Length Class  Mode      #> intraview      2      -none- list      #> misty.uniqueid 1      -none- character #> paraview.10    2      -none- list # find the 10 nearest neighbors neighbors <- nearest_neighbor_search(distances(as.matrix(pos)), k = 11)[-1, ]  # calculate the mean expression of the nearest neighbors for all markers # for each cell in expr nnexpr <- seq_len(nrow(expr)) %>%   map_dfr(~ expr %>%     slice(neighbors[, .x]) %>%     colMeans())  nn.view <- create_view(\"nearest\", nnexpr, \"nn\")  nn.view #> $nearest #> $nearest$abbrev #> [1] \"nn\" #>  #> $nearest$data #> # A tibble: 4,205 × 7 #>      ECM protE protF  prodA  prodB  prodC  prodD #>    <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> #>  1 0.169 0.337 1.07  0.120  0.0138 0.146  0.165  #>  2 0.346 0.676 0.549 0.0969 0.0140 0.190  0.0766 #>  3 0.219 0.304 0.495 0.0496 0.0288 0.236  0.0387 #>  4 0.238 0.607 0.651 0.132  0.0288 0.0954 0.122  #>  5 0.313 0.688 0.835 0.166  0.0297 0.0837 0.173  #>  6 0.527 0.743 0.616 0.0722 0.0184 0.135  0.0964 #>  7 0.278 0.399 0.501 0.0413 0.0632 0.160  0.0604 #>  8 0.266 0.537 0.624 0.0738 0.0463 0.154  0.117  #>  9 0.356 0.564 0.565 0.0696 0.0415 0.208  0.106  #> 10 0.625 0.863 0.458 0.0350 0.0823 0.230  0.0576 #> # ℹ 4,195 more rows extended.views <- misty.views %>% add_views(nn.view)  summary(extended.views) #>                Length Class  Mode      #> intraview      2      -none- list      #> misty.uniqueid 1      -none- character #> paraview.10    2      -none- list      #> nearest        2      -none- list extended.views %>%   remove_views(\"nearest\") %>%   summary() #>                Length Class  Mode      #> intraview      2      -none- list      #> misty.uniqueid 1      -none- character #> paraview.10    2      -none- list  extended.views %>%   remove_views(\"intraview\") %>%   summary() #>                Length Class  Mode      #> intraview      2      -none- list      #> misty.uniqueid 1      -none- character #> paraview.10    2      -none- list      #> nearest        2      -none- list"},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"model-training","dir":"Articles","previous_headings":"","what":"Model training","title":"Modeling spatially resolved omics with mistyR","text":"view composition created, model training managed function run_misty(). default, models trained marker available intraview view independently. results model training stored folder named “results”. workflow used first sample synthetic dataset can easily extended applied 10 samples completely reproduce one results reported publication. results sample stored subfolder folder “results”. Note default, mistyR caches calculated views2 trained models, case repeated running workflow retrieved instead recalculated, thus saving significant computational time. However, size generated cache files can large. Therefore, functions can work cached files, run_misty(), parameter named cached can set FALSE. Additionally function clear_cache() provides means remove cache files.","code":"misty.views %>% run_misty() #>  #> Training models #> [1] \"/home/runner/work/mistyR/mistyR/vignettes/results\" result.folders <- synthetic %>% imap_chr(function(sample, name) {   sample.expr <- sample %>% select(-c(row, col, type, starts_with(\"lig\")))   sample.pos <- sample %>% select(row, col)      create_initial_view(sample.expr) %>% add_paraview(sample.pos, l = 10) %>%     run_misty(results.folder = paste0(\"results\", .Platform$file.sep, name)) }) #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models  result.folders #>                                                      synthetic1  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic1\"  #>                                                     synthetic10  #> \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic10\"  #>                                                      synthetic2  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic2\"  #>                                                      synthetic3  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic3\"  #>                                                      synthetic4  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic4\"  #>                                                      synthetic5  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic5\"  #>                                                      synthetic6  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic6\"  #>                                                      synthetic7  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic7\"  #>                                                      synthetic8  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic8\"  #>                                                      synthetic9  #>  \"/home/runner/work/mistyR/mistyR/vignettes/results/synthetic9\""},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"result-processing","dir":"Articles","previous_headings":"","what":"Result processing","title":"Modeling spatially resolved omics with mistyR","text":"raw mistyR results stored several text files output folder analyzed sample. results one samples can collected, aggregated coverted R object function collect_results(), providing path(s) folder(s) containing results generated run_misty(). See help(collect_results) information structure misty.results.","code":"misty.results <- collect_results(result.folders) #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating  summary(misty.results) #>                        Length Class  Mode #> improvements           4      tbl_df list #> contributions          4      tbl_df list #> importances            5      tbl_df list #> improvements.stats     5      tbl_df list #> contributions.stats    6      tbl_df list #> importances.aggregated 5      tbl_df list"},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"plotting","dir":"Articles","previous_headings":"","what":"Plotting","title":"Modeling spatially resolved omics with mistyR","text":"MISTy gives explanatory answers three general questions. question can answered looking corresponding plot. 1. much can broader spatial context explain expression markers (contrast intraview)? can observed gain R2 (absolute percentage) (relative percentage decrease RMSE) using multiview model contrast single intraview model.  can inspect significance gain variance explained, assigned p-value improvement based cross-validation. general, significant gain R2 can interpreted following: “can better explain expression marker X, consider additional views, intrinsic view.” 2.much different view components contribute explaining expression?  expected contribution prediction expression markers comes intraview. However markers observed significant improvement variance can also observe proportional estimated contribution paraview. 3.specific relations can explain contributions? explain contributions, can visualize importances markers coming view separately predictors expression markers. First, intraview importances.  importances associated relationship markers cell. didn’t use information cell types way process modeling significant interactions see heatmap may come cell types. Second, paraview importances.  importances associated relationship markers cell markers broader structure (controlled parameter l). can observe interactions paraview might redundant, .e., also found important intraview. focus interactions coming paraview can plot contrast results.  Futhermore, since predictor target markers views , can plot interaction communities can extracted estimated interaction pairs intraview  paraview.  interpreting results plots important note relationships captured importances assumed interpreted linear casual. Furthermore, estimated importance single predictor - marker pair interpreted isolation context predictors, since training MISTy models multivariate predictive task.","code":"misty.results %>%   plot_improvement_stats(\"gain.R2\") %>%   plot_improvement_stats(\"gain.RMSE\") misty.results$improvements %>%   filter(measure == \"p.R2\") %>%   group_by(target) %>%    summarize(mean.p = mean(value)) %>%   arrange(mean.p) #> # A tibble: 7 × 2 #>   target mean.p #>   <chr>   <dbl> #> 1 ECM    0.0184 #> 2 protF  0.0496 #> 3 protE  0.421  #> 4 prodA  0.460  #> 5 prodB  0.499  #> 6 prodC  0.503  #> 7 prodD  0.505 misty.results %>% plot_view_contributions() misty.results %>% plot_interaction_heatmap(view = \"intra\", cutoff = 0.8) misty.results %>% plot_interaction_heatmap(view = \"para.10\", cutoff = 0.5) misty.results %>% plot_contrast_heatmap(\"intra\", \"para.10\", cutoff = 0.5) #> Warning: Specifying the `id_cols` argument by position was deprecated in tidyr 1.3.0. #> ℹ Please explicitly name `id_cols`, like `id_cols = -c(view, nsamples)`. #> ℹ The deprecated feature was likely used in the mistyR package. #>   Please report the issue at <https://github.com/saezlab/mistyR/issues>. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated. misty.results %>% plot_interaction_communities(\"intra\") misty.results %>% plot_interaction_communities(\"para.10\", cutoff = 0.5)"},{"path":[]},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"more-examples","dir":"Articles","previous_headings":"See also","what":"More examples","title":"Modeling spatially resolved omics with mistyR","text":"browseVignettes(\"mistyR\") Online articles","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"publication","dir":"Articles","previous_headings":"See also","what":"Publication","title":"Modeling spatially resolved omics with mistyR","text":"Jovan Tanevski, Ricardo Omar Ramirez Flores, Attila Gabor, Denis Schapiro, Julio Saez-Rodriguez. Explainable multiview framework dissecting spatial relationships highly multiplexed data. Genome Biology 23, 97 (2022). https://doi.org/10.1186/s13059-022-02663-5","code":""},{"path":"https://saezlab.github.io/mistyR/articles/mistyR.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Modeling spatially resolved omics with mistyR","text":"output sessionInfo() point document compiled:","code":"#> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> Random number generation: #>  RNG:     L'Ecuyer-CMRG  #>  Normal:  Inversion  #>  Sample:  Rejection  #>   #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_3.5.0    distances_0.1.10 purrr_1.0.2      dplyr_1.1.4      #> [5] future_1.33.1    mistyR_1.10.0    BiocStyle_2.30.0 #>  #> loaded via a namespace (and not attached): #>  [1] tidyr_1.3.1         sass_0.4.9          utf8_1.2.4          #>  [4] generics_0.1.3      stringi_1.8.3       listenv_0.9.1       #>  [7] digest_0.6.35       magrittr_2.0.3      RColorBrewer_1.1-3  #> [10] evaluate_0.23       grid_4.3.3          bookdown_0.38       #> [13] fastmap_1.1.1       R.oo_1.26.0         jsonlite_1.8.8      #> [16] R.utils_2.12.3      BiocManager_1.30.22 fansi_1.0.6         #> [19] scales_1.3.0        codetools_0.2-19    textshaping_0.3.7   #> [22] jquerylib_0.1.4     rlist_0.4.6.2       cli_3.6.2           #> [25] crayon_1.5.2        rlang_1.1.3         R.methodsS3_1.8.2   #> [28] parallelly_1.37.1   munsell_0.5.0       withr_3.0.0         #> [31] cachem_1.0.8        yaml_2.3.8          tools_4.3.3         #> [34] parallel_4.3.3      memoise_2.0.1       colorspace_2.1-0    #> [37] filelock_1.0.3      globals_0.16.3      assertthat_0.2.1    #> [40] vctrs_0.6.5         R6_2.5.1            lifecycle_1.0.4     #> [43] stringr_1.5.1       fs_1.6.3            furrr_0.3.1         #> [46] ragg_1.3.0          pkgconfig_2.0.3     desc_1.4.3          #> [49] pkgdown_2.0.7       pillar_1.9.0        bslib_0.6.2         #> [52] gtable_0.3.4        data.table_1.15.2   glue_1.7.0          #> [55] systemfonts_1.0.6   highr_0.10          xfun_0.42           #> [58] tibble_3.2.1        tidyselect_1.2.1    knitr_1.45          #> [61] farver_2.1.1        igraph_2.0.3        htmltools_0.5.7     #> [64] rmarkdown_2.26      labeling_0.4.3      compiler_4.3.3"},{"path":"https://saezlab.github.io/mistyR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jovan Tanevski. Maintainer, author. Ricardo Omar Ramirez Flores. Contributor. Philipp Schäfer. Contributor.","code":""},{"path":"https://saezlab.github.io/mistyR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jovan Tanevski, Ricardo Omar Ramirez Flores, Attila Gabor, Denis Schapiro, Julio Saez-Rodriguez. Explainable multiview framework dissecting spatial relationships highly multiplexed data. Genome Biology 23, 97 (2022). https://doi.org/10.1186/s13059-022-02663-5","code":"@Article{,   author = {Jovan Tanevski and Ricardo Omar {Ramirez Flores} and Attila Gabor and Denis Schapiro and Julio Saez-Rodriguez},   title = {Explainable multiview framework for dissecting spatial relationships from highly multiplexed data},   journal = {Genome Biology},   volume = {23},   number = {97},   year = {2022},   url = {https://doi.org/10.1186/s13059-022-02663-5}, }"},{"path":[]},{"path":"https://saezlab.github.io/mistyR/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Multiview Intercellular SpaTial modeling framework","text":"advancement technologies measurement highly multiplexed spatial data require development scalable methods can leverage availability spatial context. Multiview Intercellular SpaTial modeling framework (MISTy) explainable machine learning framework knowledge extraction analysis single-cell, highly multiplexed, spatially resolved data.  MISTy facilitates -depth understanding marker interactions profiling intra- intercellular relationships. MISTy flexible framework able process custom number views. views can describe different spatial context, .e., define relationship among observed expressions markers, intracellular regulation paracrine regulation. However, views can also capture cell-type specific relationships, capture relations functional footprints focus relations different anatomical regions. MISTy view considered potential source variability measured marker expressions. MISTy view analyzed contribution total expression marker explained terms interactions measurements led observed contribution. approach modular, easily parallelizable thus scalable samples millions cells thousands measured markers. mistyR R package implementing MISTy.","code":""},{"path":"https://saezlab.github.io/mistyR/index.html","id":"system-requirements","dir":"","previous_headings":"","what":"System Requirements","title":"Multiview Intercellular SpaTial modeling framework","text":"mistyR requires standard configuration enough RAM store analyzed dataset support -memory operations. package requires R version 4.0 higher. package developed macOS Big Sur. package compatible Windows, Linux maxOS operating systems.","code":""},{"path":"https://saezlab.github.io/mistyR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Multiview Intercellular SpaTial modeling framework","text":"Install Bioconductor: can install latest stable development versions GitHub remotes: stable development","code":"# install.packages(\"BiocManager\") BiocManager::install(\"mistyR\") # install.packages(\"remotes\") remotes::install_github(\"saezlab/mistyR\") remotes::install_github(\"saezlab/mistyR@devel\")"},{"path":"https://saezlab.github.io/mistyR/index.html","id":"docker","dir":"","previous_headings":"","what":"Docker","title":"Multiview Intercellular SpaTial modeling framework","text":"released latest stable development versions also provide Docker images based Rocker project - rocker/r-base image. create start container latest docker image run R interactive mode:","code":"docker run -it tanevski/mistyr:latest"},{"path":"https://saezlab.github.io/mistyR/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Multiview Intercellular SpaTial modeling framework","text":"Start reading vignette(\"mistyR\") learn run mistyR. learn use package commonly used objects spatial omics data see articles. Example pipelines synthetic data mistyR also available repository. run mistyR provided synthetic data run script synthetic_pipeline.R.","code":""},{"path":"https://saezlab.github.io/mistyR/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Multiview Intercellular SpaTial modeling framework","text":"use mistyR research please cite following publication: Jovan Tanevski, Ricardo Omar Ramirez Flores, Attila Gabor, Denis Schapiro, Julio Saez-Rodriguez. Explainable multiview framework dissecting spatial relationships highly multiplexed data. Genome Biology 23, 97 (2022). https://doi.org/10.1186/s13059-022-02663-5","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_juxtaview.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate and add a juxtaview to the current view composition — add_juxtaview","title":"Generate and add a juxtaview to the current view composition — add_juxtaview","text":"juxtaview captures expression markers within immediate neighborhood spatial unit.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_juxtaview.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate and add a juxtaview to the current view composition — add_juxtaview","text":"","code":"add_juxtaview(   current.views,   positions,   neighbor.thr = 15,   prefix = \"\",   cached = FALSE,   verbose = TRUE )"},{"path":"https://saezlab.github.io/mistyR/reference/add_juxtaview.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate and add a juxtaview to the current view composition — add_juxtaview","text":"current.views current view composition. positions data.frame, tibble matrix named coordinates columns rows spatial unit ordered intraview. neighbor.thr threshold value used indicate largest distance two spatial units can considered neighboring. prefix prefix add column names. cached logical indicating whether cache calculated view first calculation reuse previously cached view already exists sample. verbose logical controlling verbosity output function execution.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_juxtaview.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate and add a juxtaview to the current view composition — add_juxtaview","text":"mistyR view composition added juxtaview.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_juxtaview.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate and add a juxtaview to the current view composition — add_juxtaview","text":"neighborhood spatial unit estimated constructing graph 2D Delaunay triangulation following removal edges length larger neighbor.thr. spatial unit juxtaview contains sum expressions across estimated neighbors marker.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/add_juxtaview.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate and add a juxtaview to the current view composition — add_juxtaview","text":"","code":"# Create a view composition of an intraview and a juxtaview.  library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type)) # get the coordinates for each cell pos <- synthetic[[1]] %>% select(row, col)  # compose misty.views <- create_initial_view(expr) %>% add_juxtaview(pos, neighbor.thr = 1.5) #>  #> Computing triangulation #>  #> Generating juxtaview  # preview str(misty.views[[\"juxtaview.1.5\"]]) #> List of 2 #>  $ abbrev: chr \"juxta.1.5\" #>  $ data  :'data.frame':\t4205 obs. of  11 variables: #>   ..$ ECM  : num [1:4205] 0.116 0.105 1.395 1.315 1.395 ... #>   ..$ ligA : num [1:4205] 1.3988 0.0653 0.5141 0.965 0.5141 ... #>   ..$ ligB : num [1:4205] 0.0394 0.0188 0.0629 0.1578 0.0629 ... #>   ..$ ligC : num [1:4205] 0.53 0.856 0.825 0.89 0.825 ... #>   ..$ ligD : num [1:4205] 1.9261 0.0577 0.4646 0.8604 0.4646 ... #>   ..$ protE: num [1:4205] 0.779 0 1.617 3.286 1.617 ... #>   ..$ protF: num [1:4205] 4.31 0.25 0.988 1.851 0.988 ... #>   ..$ prodA: num [1:4205] 0.455 0 0 0.472 0 ... #>   ..$ prodB: num [1:4205] 0 0 0 0.16 0 ... #>   ..$ prodC: num [1:4205] 0.433 0.548 0.418 0 0.418 ... #>   ..$ prodD: num [1:4205] 0.536 0 0 0.379 0 ..."},{"path":"https://saezlab.github.io/mistyR/reference/add_paraview.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate and add a paraview to the current view composition — add_paraview","title":"Generate and add a paraview to the current view composition — add_paraview","text":"paraview captures expression markers  broader tissue structure.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_paraview.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate and add a paraview to the current view composition — add_paraview","text":"","code":"add_paraview(   current.views,   positions,   l,   zoi = 0,   family = c(\"gaussian\", \"exponential\", \"linear\", \"constant\"),   approx = 1,   nn = NULL,   prefix = \"\",   cached = FALSE,   verbose = TRUE )"},{"path":"https://saezlab.github.io/mistyR/reference/add_paraview.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate and add a paraview to the current view composition — add_paraview","text":"current.views current view composition. positions data.frame, tibble matrix named coordinates columns rows spatial unit ordered intraview. l effective radius influence expression broader tissue structure. zoi spatial units distance smaller zone indifference taken account generating paraview. family family f functions used generate weights. (see Details) approx rank Nyström approximation matrix. (see Details) nn number spatial units used approximating paraview using fast nearest neighbor search. (see Details) prefix prefix add column names. cached logical indicating whether cache calculated view first calculation reuse previously cached view already exists sample. verbose logical controlling verbosity output function execution.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_paraview.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate and add a paraview to the current view composition — add_paraview","text":"mistyR view composition added paraview parameter l.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_paraview.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate and add a paraview to the current view composition — add_paraview","text":"paraview generated weighted sum expression spatial units marker. weights spatial unit dependent family can one \"gaussian\", \"exponential\", \"linear\" \"constant\". \"gaussian\" weights calculated based distance spatial unit j parameter l using radial basis function $$w_{ij} = e^{-\\frac{d_{ij}^2}{l^2}}$$ parameter l denotes \"effective\" radius influence. \"exponential\" weights calculated based distance spatial unit j parameter l using exponential function $$w_{ij} = e^{-\\frac{d_{ij}}{l}}$$ parameter l denotes signaling length. information consult Oyler-Yaniv et. al. Immunity 46(4) 2017. \"linear\" weights calculated based distance spatial unit j parameter l using linear function $$w_{ij} = 1- d(,j)/l$$ parameter l denotes intersect linear function. distances larger l weight equal 0. \"constant\" weights always 1. parameter l denotes number nearest neighbors take account nn defined. Since generation paraview requires calculation pairwise distances spatial units can take significant amount computation time. parameters approx nn can set speed calculation approximation. approximation can achieved using Nyström low-rank approximation method limiting calculation paraview number nearest neighbors around spatial unit. value approx 0 1 interpreted fraction number spatial units. Discrete values 1 interpreted size approximation block. number nearest neighbors nn around spatial unit determined using fast nearest neighbor search. approx nn non-null values, nn priority approximation based fast nearest neighbor search used generate paraview.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/add_paraview.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate and add a paraview to the current view composition — add_paraview","text":"","code":"# Create a view composition of an intraview and a paraview with radius 10.  library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type)) # get the coordinates for each cell pos <- synthetic[[1]] %>% select(row, col)  # compose misty.views <- create_initial_view(expr) %>% add_paraview(pos, l = 10) #>  #> Generating paraview  # preview str(misty.views[[\"paraview.10\"]]) #> List of 2 #>  $ abbrev: chr \"para.10\" #>  $ data  :'data.frame':\t4205 obs. of  11 variables: #>   ..$ ECM  : num [1:4205] 6.98 15.05 17.37 18.4 19.93 ... #>   ..$ ligA : num [1:4205] 13.2 12.9 13.6 14.3 14.7 ... #>   ..$ ligB : num [1:4205] 1.29 2.31 2.78 3 3.16 ... #>   ..$ ligC : num [1:4205] 9.56 18.52 20.42 20.97 21.99 ... #>   ..$ ligD : num [1:4205] 17 15.1 16.1 16.9 17.5 ... #>   ..$ protE: num [1:4205] 14 26.6 28.1 31.5 33.2 ... #>   ..$ protF: num [1:4205] 28.1 27.7 29 30.9 32.7 ... #>   ..$ prodA: num [1:4205] 4.37 5.24 5.04 5.61 5.69 ... #>   ..$ prodB: num [1:4205] 0.816 1.659 1.948 2.093 2.076 ... #>   ..$ prodC: num [1:4205] 3.87 7.29 8.23 8 8.61 ... #>   ..$ prodD: num [1:4205] 5.64 6.01 5.98 6.51 6.64 ..."},{"path":"https://saezlab.github.io/mistyR/reference/add_views.html","id":null,"dir":"Reference","previous_headings":"","what":"Add custom views to the current view composition — add_views","title":"Add custom views to the current view composition — add_views","text":"Add one custom views current view composition.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_views.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add custom views to the current view composition — add_views","text":"","code":"add_views(current.views, new.views)"},{"path":"https://saezlab.github.io/mistyR/reference/add_views.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add custom views to the current view composition — add_views","text":"current.views current view composition. new.views view list views created create_view() otherwise.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/add_views.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add custom views to the current view composition — add_views","text":"mistyR view composition containing union views  current.views new.views.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/add_views.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add custom views to the current view composition — add_views","text":"","code":"# create random views view1 <- data.frame(marker1 = rnorm(100, 10, 2), marker2 = rnorm(100, 15, 3)) view2 <- data.frame(marker1 = rnorm(100, 10, 5), marker2 = rnorm(100, 15, 5))  misty.views <- create_initial_view(view1)  new.view <- create_view(\"dummyname\", view2, \"dname\") add_views(misty.views, new.view) #> $intraview #> $intraview$abbrev #> [1] \"intra\" #>  #> $intraview$data #>       marker1   marker2 #> 1    7.199913 13.838359 #> 2   10.510634 12.643702 #> 3    5.125473 11.829789 #> 4    9.988857 12.613376 #> 5   11.243105  9.731174 #> 6   12.296823 12.928386 #> 7    6.356365 13.324374 #> 8    9.505349 13.390010 #> 9    9.511601 15.681381 #> 10   9.434589 17.935365 #> 11   8.892601 14.373352 #> 12  11.257964 10.801769 #> 13  14.130050 15.775612 #> 14   6.738021 13.674602 #> 15  11.024854 16.705800 #> 16   6.273977 21.380551 #> 17   8.955975 16.274575 #> 18   9.894796  9.947155 #> 19  11.085993 15.748205 #> 20   8.171850 18.218515 #> 21  10.936309 21.118108 #> 22  10.725903 16.348361 #> 23   7.390913 19.175442 #> 24  11.475553 16.279700 #> 25  13.777010 15.322752 #> 26   9.805110 15.066884 #> 27   8.128305 16.810833 #> 28   9.968099 14.212048 #> 29   8.346422 13.415208 #> 30   6.975201 15.576448 #> 31  11.870726 11.561401 #> 32  10.352977 17.538554 #> 33  10.487371 15.245159 #> 34  13.247098 11.084649 #> 35  10.224076 12.165264 #> 36   9.732006 16.363025 #> 37   6.179825 12.434392 #> 38   9.441526 14.139314 #> 39   9.373108 17.684885 #> 40  12.134616 15.201913 #> 41  10.140070 14.511971 #> 42   8.721753 12.518069 #> 43   9.900070 20.629517 #> 44   9.497033 17.299321 #> 45  10.889594 17.939870 #> 46  15.510835 18.965343 #> 47  10.093063 11.640868 #> 48  11.155418 16.543799 #> 49  10.236390 10.472700 #> 50   6.176559 19.598224 #> 51  11.724173 16.287442 #> 52   9.513527 15.366310 #> 53   9.587826 11.585963 #> 54  10.038355 13.325955 #> 55  10.059122 18.157616 #> 56  11.099655 17.033051 #> 57   5.451770 15.115499 #> 58  15.365114 13.930856 #> 59   9.277557 17.348532 #> 60  10.426711 17.413235 #> 61  12.148692  9.299818 #> 62   8.669824 17.807353 #> 63  12.227905 14.072845 #> 64   9.508207 15.789200 #> 65   7.644873  9.628224 #> 66   8.048299 12.635223 #> 67  12.130115 11.600935 #> 68  10.263341 16.090958 #> 69  10.977258 14.142336 #> 70   6.601099 16.553007 #> 71   7.058527 14.691274 #> 72  10.568301 12.077791 #> 73  12.674641 18.812017 #> 74  10.473393 17.882594 #> 75  12.636587 17.306164 #> 76  11.047820 18.107792 #> 77  11.213496 13.578339 #> 78   9.780129 11.173995 #> 79  10.344363 14.083138 #> 80   9.819345 21.635308 #> 81  13.848687 11.874995 #> 82  12.596786 11.560428 #> 83  11.497583  9.974018 #> 84  11.112449 19.577816 #> 85   8.903485 16.662557 #> 86  12.221070 20.979331 #> 87   4.775331 14.537638 #> 88   9.688612 22.693225 #> 89  10.867780 18.185997 #> 90   9.236098 18.428085 #> 91  10.848375 18.371517 #> 92  12.126204 13.808996 #> 93  12.097425 12.530217 #> 94   9.923794 13.263346 #> 95  10.972298 20.291368 #> 96  13.345765 15.398976 #> 97   9.291278 16.129498 #> 98  11.892696 18.416123 #> 99  12.633653 18.723789 #> 100  9.406720 16.836273 #>  #>  #> $misty.uniqueid #> [1] \"b0782b57cbeec2bcbbdf3e54abecd6fe\" #>  #> $dummyname #> $dummyname$abbrev #> [1] \"dname\" #>  #> $dummyname$data #>        marker1   marker2 #> 1    7.8530996 13.219378 #> 2   16.8023066  9.677679 #> 3    9.6457128 20.385583 #> 4    8.6392316 20.907878 #> 5   -2.2334001 15.991960 #> 6   10.3274332 12.997974 #> 7    4.5074555 18.080771 #> 8    6.8341091 24.870784 #> 9   -0.3182723 24.423312 #> 10  23.2446601  7.056897 #> 11   4.2330081 12.300384 #> 12   8.2968106  9.152693 #> 13  13.9318129 17.795530 #> 14   3.6474344  5.903264 #> 15  12.7107077 16.966720 #> 16  10.3755295 15.210671 #> 17  12.7925721 20.898321 #> 18  12.0770320 13.715394 #> 19   2.7385012  9.718320 #> 20  14.7060306 15.993886 #> 21   8.3053206 18.252668 #> 22   9.6221288 16.719567 #> 23  10.2010220 22.387662 #> 24  10.6215053 15.360128 #> 25   5.0078372 25.632223 #> 26  16.1669503  7.619015 #> 27  11.7021224 17.039442 #> 28   7.6364876 21.969889 #> 29  13.5437653 16.801391 #> 30   2.3552064 18.272751 #> 31  11.1871267 20.260777 #> 32   3.4359288  5.102224 #> 33  13.7351429 21.041928 #> 34   2.1874078 14.153600 #> 35  10.3552668 16.475149 #> 36   6.8023261 21.331703 #> 37   5.7740213  9.323284 #> 38  13.3762235  9.344731 #> 39  15.7668790 15.549967 #> 40   1.5674763 19.264527 #> 41   5.4859253 13.828311 #> 42  16.5881685 25.433443 #> 43  15.5009487 14.445403 #> 44  16.0188392  8.035765 #> 45   2.8436461  9.288546 #> 46  16.9145543 23.523044 #> 47  10.0156297 14.599632 #> 48   9.6105659 12.813594 #> 49  12.2071411 14.403925 #> 50  10.6446145 18.932314 #> 51   5.8489287 12.105274 #> 52   7.4820355 14.272866 #> 53   4.0317941 17.632290 #> 54   6.2413834 23.667891 #> 55  17.2792070 22.243286 #> 56   5.8569823 22.590966 #> 57  11.4488723 13.079964 #> 58   7.5997326 24.135626 #> 59   6.9758532 12.242541 #> 60  17.3005509 10.671232 #> 61  10.7483968 13.280843 #> 62   2.8333945 20.314382 #> 63   9.9484834 19.065291 #> 64   8.9388198 24.017417 #> 65   5.4682991 14.474657 #> 66  -0.5107624 19.912267 #> 67  19.4668023  6.433487 #> 68   5.1593708 10.839902 #> 69   9.4869848 20.502459 #> 70  11.1997979 14.130899 #> 71  10.3044945 15.894060 #> 72  -0.8878801 11.507853 #> 73   9.4106993 10.197754 #> 74  10.5614739 10.122885 #> 75  10.0394310 13.307117 #> 76  19.3887194 20.761735 #> 77  20.7937828 17.025506 #> 78  13.5485726 12.645388 #> 79  13.8349169 14.333745 #> 80   8.4589429 21.133412 #> 81  15.0600092 16.664720 #> 82   5.4047420 13.264558 #> 83  12.8169004 14.507247 #> 84  11.6124137 15.173830 #> 85  11.8333718 16.930635 #> 86  15.6491758 15.104156 #> 87   5.2925096 15.037934 #> 88  11.0891882 19.654220 #> 89  17.0770615 11.576250 #> 90   8.0813348 16.687008 #> 91   9.1295681 12.939311 #> 92   8.8912774 19.671306 #> 93   4.9523564 24.201584 #> 94  12.4036263 11.475902 #> 95  18.0220366 15.042552 #> 96   2.4248774 25.170949 #> 97   2.9198804  8.291570 #> 98  14.3838866 20.794896 #> 99  13.1206621 13.983955 #> 100 20.5613864 13.109857 #>  #>   misty.views %>% add_views(create_view(\"dummyname\", view2, \"dname\")) #> $intraview #> $intraview$abbrev #> [1] \"intra\" #>  #> $intraview$data #>       marker1   marker2 #> 1    7.199913 13.838359 #> 2   10.510634 12.643702 #> 3    5.125473 11.829789 #> 4    9.988857 12.613376 #> 5   11.243105  9.731174 #> 6   12.296823 12.928386 #> 7    6.356365 13.324374 #> 8    9.505349 13.390010 #> 9    9.511601 15.681381 #> 10   9.434589 17.935365 #> 11   8.892601 14.373352 #> 12  11.257964 10.801769 #> 13  14.130050 15.775612 #> 14   6.738021 13.674602 #> 15  11.024854 16.705800 #> 16   6.273977 21.380551 #> 17   8.955975 16.274575 #> 18   9.894796  9.947155 #> 19  11.085993 15.748205 #> 20   8.171850 18.218515 #> 21  10.936309 21.118108 #> 22  10.725903 16.348361 #> 23   7.390913 19.175442 #> 24  11.475553 16.279700 #> 25  13.777010 15.322752 #> 26   9.805110 15.066884 #> 27   8.128305 16.810833 #> 28   9.968099 14.212048 #> 29   8.346422 13.415208 #> 30   6.975201 15.576448 #> 31  11.870726 11.561401 #> 32  10.352977 17.538554 #> 33  10.487371 15.245159 #> 34  13.247098 11.084649 #> 35  10.224076 12.165264 #> 36   9.732006 16.363025 #> 37   6.179825 12.434392 #> 38   9.441526 14.139314 #> 39   9.373108 17.684885 #> 40  12.134616 15.201913 #> 41  10.140070 14.511971 #> 42   8.721753 12.518069 #> 43   9.900070 20.629517 #> 44   9.497033 17.299321 #> 45  10.889594 17.939870 #> 46  15.510835 18.965343 #> 47  10.093063 11.640868 #> 48  11.155418 16.543799 #> 49  10.236390 10.472700 #> 50   6.176559 19.598224 #> 51  11.724173 16.287442 #> 52   9.513527 15.366310 #> 53   9.587826 11.585963 #> 54  10.038355 13.325955 #> 55  10.059122 18.157616 #> 56  11.099655 17.033051 #> 57   5.451770 15.115499 #> 58  15.365114 13.930856 #> 59   9.277557 17.348532 #> 60  10.426711 17.413235 #> 61  12.148692  9.299818 #> 62   8.669824 17.807353 #> 63  12.227905 14.072845 #> 64   9.508207 15.789200 #> 65   7.644873  9.628224 #> 66   8.048299 12.635223 #> 67  12.130115 11.600935 #> 68  10.263341 16.090958 #> 69  10.977258 14.142336 #> 70   6.601099 16.553007 #> 71   7.058527 14.691274 #> 72  10.568301 12.077791 #> 73  12.674641 18.812017 #> 74  10.473393 17.882594 #> 75  12.636587 17.306164 #> 76  11.047820 18.107792 #> 77  11.213496 13.578339 #> 78   9.780129 11.173995 #> 79  10.344363 14.083138 #> 80   9.819345 21.635308 #> 81  13.848687 11.874995 #> 82  12.596786 11.560428 #> 83  11.497583  9.974018 #> 84  11.112449 19.577816 #> 85   8.903485 16.662557 #> 86  12.221070 20.979331 #> 87   4.775331 14.537638 #> 88   9.688612 22.693225 #> 89  10.867780 18.185997 #> 90   9.236098 18.428085 #> 91  10.848375 18.371517 #> 92  12.126204 13.808996 #> 93  12.097425 12.530217 #> 94   9.923794 13.263346 #> 95  10.972298 20.291368 #> 96  13.345765 15.398976 #> 97   9.291278 16.129498 #> 98  11.892696 18.416123 #> 99  12.633653 18.723789 #> 100  9.406720 16.836273 #>  #>  #> $misty.uniqueid #> [1] \"b0782b57cbeec2bcbbdf3e54abecd6fe\" #>  #> $dummyname #> $dummyname$abbrev #> [1] \"dname\" #>  #> $dummyname$data #>        marker1   marker2 #> 1    7.8530996 13.219378 #> 2   16.8023066  9.677679 #> 3    9.6457128 20.385583 #> 4    8.6392316 20.907878 #> 5   -2.2334001 15.991960 #> 6   10.3274332 12.997974 #> 7    4.5074555 18.080771 #> 8    6.8341091 24.870784 #> 9   -0.3182723 24.423312 #> 10  23.2446601  7.056897 #> 11   4.2330081 12.300384 #> 12   8.2968106  9.152693 #> 13  13.9318129 17.795530 #> 14   3.6474344  5.903264 #> 15  12.7107077 16.966720 #> 16  10.3755295 15.210671 #> 17  12.7925721 20.898321 #> 18  12.0770320 13.715394 #> 19   2.7385012  9.718320 #> 20  14.7060306 15.993886 #> 21   8.3053206 18.252668 #> 22   9.6221288 16.719567 #> 23  10.2010220 22.387662 #> 24  10.6215053 15.360128 #> 25   5.0078372 25.632223 #> 26  16.1669503  7.619015 #> 27  11.7021224 17.039442 #> 28   7.6364876 21.969889 #> 29  13.5437653 16.801391 #> 30   2.3552064 18.272751 #> 31  11.1871267 20.260777 #> 32   3.4359288  5.102224 #> 33  13.7351429 21.041928 #> 34   2.1874078 14.153600 #> 35  10.3552668 16.475149 #> 36   6.8023261 21.331703 #> 37   5.7740213  9.323284 #> 38  13.3762235  9.344731 #> 39  15.7668790 15.549967 #> 40   1.5674763 19.264527 #> 41   5.4859253 13.828311 #> 42  16.5881685 25.433443 #> 43  15.5009487 14.445403 #> 44  16.0188392  8.035765 #> 45   2.8436461  9.288546 #> 46  16.9145543 23.523044 #> 47  10.0156297 14.599632 #> 48   9.6105659 12.813594 #> 49  12.2071411 14.403925 #> 50  10.6446145 18.932314 #> 51   5.8489287 12.105274 #> 52   7.4820355 14.272866 #> 53   4.0317941 17.632290 #> 54   6.2413834 23.667891 #> 55  17.2792070 22.243286 #> 56   5.8569823 22.590966 #> 57  11.4488723 13.079964 #> 58   7.5997326 24.135626 #> 59   6.9758532 12.242541 #> 60  17.3005509 10.671232 #> 61  10.7483968 13.280843 #> 62   2.8333945 20.314382 #> 63   9.9484834 19.065291 #> 64   8.9388198 24.017417 #> 65   5.4682991 14.474657 #> 66  -0.5107624 19.912267 #> 67  19.4668023  6.433487 #> 68   5.1593708 10.839902 #> 69   9.4869848 20.502459 #> 70  11.1997979 14.130899 #> 71  10.3044945 15.894060 #> 72  -0.8878801 11.507853 #> 73   9.4106993 10.197754 #> 74  10.5614739 10.122885 #> 75  10.0394310 13.307117 #> 76  19.3887194 20.761735 #> 77  20.7937828 17.025506 #> 78  13.5485726 12.645388 #> 79  13.8349169 14.333745 #> 80   8.4589429 21.133412 #> 81  15.0600092 16.664720 #> 82   5.4047420 13.264558 #> 83  12.8169004 14.507247 #> 84  11.6124137 15.173830 #> 85  11.8333718 16.930635 #> 86  15.6491758 15.104156 #> 87   5.2925096 15.037934 #> 88  11.0891882 19.654220 #> 89  17.0770615 11.576250 #> 90   8.0813348 16.687008 #> 91   9.1295681 12.939311 #> 92   8.8912774 19.671306 #> 93   4.9523564 24.201584 #> 94  12.4036263 11.475902 #> 95  18.0220366 15.042552 #> 96   2.4248774 25.170949 #> 97   2.9198804  8.291570 #> 98  14.3838866 20.794896 #> 99  13.1206621 13.983955 #> 100 20.5613864 13.109857 #>  #>"},{"path":"https://saezlab.github.io/mistyR/reference/clear_cache.html","id":null,"dir":"Reference","previous_headings":"","what":"Clear cached objects — clear_cache","title":"Clear cached objects — clear_cache","text":"Purge cache clear cached objects single sample.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/clear_cache.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clear cached objects — clear_cache","text":"","code":"clear_cache(id = NULL)"},{"path":"https://saezlab.github.io/mistyR/reference/clear_cache.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clear cached objects — clear_cache","text":"id unique id sample.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/clear_cache.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clear cached objects — clear_cache","text":"None (NULL)","code":""},{"path":"https://saezlab.github.io/mistyR/reference/clear_cache.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Clear cached objects — clear_cache","text":"cached objects removed disk retrieved. Whenever possible specifying id reccomended. id = NULL contents folder .misty.temp removed.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/clear_cache.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clear cached objects — clear_cache","text":"","code":"clear_cache(\"b98ad35f4e671871cba35f2155228612\") #> Warning: Cache folder for requested id doesn't exist.  clear_cache() #> Warning: Cache folder doesn't exist."},{"path":"https://saezlab.github.io/mistyR/reference/collect_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Collect and aggregate results — collect_results","title":"Collect and aggregate results — collect_results","text":"Collect aggregate performance, contribution importance estimations set raw results produced run_misty().","code":""},{"path":"https://saezlab.github.io/mistyR/reference/collect_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collect and aggregate results — collect_results","text":"","code":"collect_results(folders)"},{"path":"https://saezlab.github.io/mistyR/reference/collect_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collect and aggregate results — collect_results","text":"folders Paths folders containing raw results run_misty().","code":""},{"path":"https://saezlab.github.io/mistyR/reference/collect_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collect and aggregate results — collect_results","text":"List collected performance, contributions importances per sample,     performance contribution statistics aggregated importances.  improvements Long format tibble measurements             performance target sample.             Available performance measures RMSE variance explained             (R2) model containing intrinsic view             (intra.RMSE, intra.R2), model views             (multi.RMSE, multi.R2), gain RMSE gain             variance explained multi-view model intrisic model             gain.RMSE relative decrease RMSE percent,             gain.R2 absolute increase variance explained             percent. value represents mean performance across             folds (k-fold cross-validation). p values one sided             t-test improvement performance (p.RMSE, p.R2)             also available measure. improvements.stats Long format tibble summary             statistics (mean, standard deviation coefficient variation)             performance measures target samples. contributions Long format tibble values             coefficients view meta-model,             target sample. p values coefficient             view, null hypothesis zero contribution             meta model also available. contributions.stats Long format tibble summary             statistics views per target samples. Including             mean coffecient value, fraction contribution, mean standard             deviation p values. importances List view-specific predictor-target         importance tables per sample. importances table         standardized per target weighted quantile coefficient         target view. Columns Predictor         represent target markers. importances.aggregated list aggregated view-specific         predictor-target importance tables . Aggregation         reducing mean samples.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/collect_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collect and aggregate results — collect_results","text":"","code":"# Train and collect results for 3 samples in synthetic  library(dplyr) library(purrr)  data(\"synthetic\")  misty.results <- synthetic[seq_len(3)] %>%   imap_chr(~ create_initial_view(.x %>% select(-c(row, col, type))) %>%     add_paraview(.x %>% select(row, col), l = 10) %>%     run_misty(paste0(\"results/\", .y))) %>%   collect_results() #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Generating paraview #>  #> Training models #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating str(misty.results) #> List of 6 #>  $ improvements          : tibble [264 × 4] (S3: tbl_df/tbl/data.frame) #>   ..$ target : chr [1:264] \"ECM\" \"ECM\" \"ECM\" \"ECM\" ... #>   ..$ sample : chr [1:264] \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" ... #>   ..$ measure: chr [1:264] \"intra.RMSE\" \"intra.R2\" \"multi.RMSE\" \"multi.R2\" ... #>   ..$ value  : num [1:264] 0.1058 92.4635 0.0988 93.4217 0.0101 ... #>  $ contributions         : tibble [198 × 4] (S3: tbl_df/tbl/data.frame) #>   ..$ target: chr [1:198] \"ECM\" \"ECM\" \"ECM\" \"ECM\" ... #>   ..$ sample: chr [1:198] \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" ... #>   ..$ view  : chr [1:198] \"intercept\" \"intra\" \"para.10\" \"p.intercept\" ... #>   ..$ value : num [1:198] -0.074 0.991 0.259 NA 0 ... #>  $ importances           : tibble [726 × 5] (S3: tbl_df/tbl/data.frame) #>   ..$ sample    : chr [1:726] \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results/synthetic1\" ... #>   ..$ view      : chr [1:726] \"intra\" \"intra\" \"intra\" \"intra\" ... #>   ..$ Predictor : chr [1:726] \"ECM\" \"ECM\" \"ECM\" \"ECM\" ... #>   ..$ Target    : chr [1:726] \"ECM\" \"ligA\" \"ligB\" \"ligC\" ... #>   ..$ Importance: num [1:726] NA -0.621 0.305 -0.375 -0.598 ... #>  $ improvements.stats    : tibble [66 × 5] (S3: tbl_df/tbl/data.frame) #>   ..$ target : chr [1:66] \"ECM\" \"ECM\" \"ECM\" \"ECM\" ... #>   ..$ measure: chr [1:66] \"gain.R2\" \"gain.RMSE\" \"intra.R2\" \"intra.RMSE\" ... #>   ..$ mean   : num [1:66] 0.861 6.202 92.807 0.101 93.668 ... #>   ..$ sd     : num [1:66] 0.10931 0.77475 0.38239 0.00582 0.37607 ... #>   ..$ cv     : num [1:66] 0.12699 0.12491 0.00412 0.05781 0.00401 ... #>  $ contributions.stats   : tibble [22 × 6] (S3: tbl_df/tbl/data.frame) #>   ..$ target  : chr [1:22] \"ECM\" \"ECM\" \"ligA\" \"ligA\" ... #>   ..$ view    : chr [1:22] \"intra\" \"para.10\" \"intra\" \"para.10\" ... #>   ..$ mean    : num [1:22] 0.989 0.245 0.996 0.066 0.985 ... #>   ..$ fraction: num [1:22] 0.8012 0.1988 0.9379 0.0621 0.7747 ... #>   ..$ p.mean  : num [1:22] 0 0 0 0 0 0 0 0 0 0 ... #>   ..$ p.sd    : num [1:22] 0 0 0 0 0 0 0 0 0 0 ... #>  $ importances.aggregated: tibble [242 × 5] (S3: tbl_df/tbl/data.frame) #>   ..$ view      : chr [1:242] \"intra\" \"intra\" \"intra\" \"intra\" ... #>   ..$ Predictor : chr [1:242] \"ECM\" \"ECM\" \"ECM\" \"ECM\" ... #>   ..$ Target    : chr [1:242] \"ECM\" \"ligA\" \"ligB\" \"ligC\" ... #>   ..$ Importance: num [1:242] NA -0.616 0.345 -0.388 -0.615 ... #>   ..$ nsamples  : int [1:242] 3 3 3 3 3 3 3 3 3 3 ..."},{"path":"https://saezlab.github.io/mistyR/reference/create_initial_view.html","id":null,"dir":"Reference","previous_headings":"","what":"Start here: create a basic view composition with an intraview — create_initial_view","title":"Start here: create a basic view composition with an intraview — create_initial_view","text":"function first one called building mistyR workflow, starting view composition. initial view describes intraview sample.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/create_initial_view.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Start here: create a basic view composition with an intraview — create_initial_view","text":"","code":"create_initial_view(data, unique.id = NULL)"},{"path":"https://saezlab.github.io/mistyR/reference/create_initial_view.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Start here: create a basic view composition with an intraview — create_initial_view","text":"data data.frame tibble containing expression information markers interest (named columns) spatial unit (rows). unique.id character vector. Identifier current sample. provided (unique.id = NULL) id automatically generated calculating md5 hash table.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/create_initial_view.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Start here: create a basic view composition with an intraview — create_initial_view","text":"initial mistyR view composition containing intraview list     item named described abbreviation \"intra\" data provided     data misty.uniqueid list item containing     provided automatically calculated unique.id. cache folder     sample automatically created working directory     subfolder .misty.temp/ name unique.id.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/create_initial_view.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Start here: create a basic view composition with an intraview — create_initial_view","text":"","code":"# Create an intrinsic view from the first sample in the dataset synthetic.  library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type))  create_initial_view(expr) #> $intraview #> $intraview$abbrev #> [1] \"intra\" #>  #> $intraview$data #> # A tibble: 4,205 × 11 #>       ECM  ligA   ligB  ligC  ligD protE  protF prodA  prodB prodC prodD #>     <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl> <dbl> <dbl> #>  1 0.0385 0.834 0.0157 0.236 1.18   1.18 2.55   0.382 0      0     0.588 #>  2 0.0327 0.119 0.0104 0.804 0.101  0    0.386  0     0      0.536 0     #>  3 0.144  0.525 0.0140 0.334 0.434  1.67 1.61   0.472 0      0     0.379 #>  4 0.387  0.269 0.0367 0.502 0.241  0    0.913  0     0      0.418 0     #>  5 0.163  0.195 0.118  0.232 0.203  0    0.162  0     0.160  0     0     #>  6 0.203  0.178 0.0247 0.738 0.236  0    0.603  0     0      0.555 0     #>  7 0.200  0.170 0.122  0.715 0.246  0    0.862  0     0      0.496 0     #>  8 0.0642 0.162 0.0999 0.549 0.243  0    0.0636 0     0.0623 0     0     #>  9 0.0331 0.229 0.0404 0.246 0.378  0    0.0328 0     0.0322 0     0     #> 10 0.268  0.146 0.0186 0.944 0.232  0    0.490  0     0      0.583 0     #> # ℹ 4,195 more rows #>  #>  #> $misty.uniqueid #> [1] \"b98ad35f4e671871cba35f2155228612\" #>"},{"path":"https://saezlab.github.io/mistyR/reference/create_view.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a custom view — create_view","title":"Create a custom view — create_view","text":"Create custom view data.frame tibble.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/create_view.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a custom view — create_view","text":"","code":"create_view(name, data, abbrev = name)"},{"path":"https://saezlab.github.io/mistyR/reference/create_view.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a custom view — create_view","text":"name Name view. character vector. data data.frame tibble named variables columns rows spatial unit ordered intraview. abbrev Abbreviated name. character vector.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/create_view.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a custom view — create_view","text":"new mistyR view. list single named item described     provided abbreviation data containing provided  data.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/create_view.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a custom view — create_view","text":"Creating custom view add current view composition.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/create_view.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a custom view — create_view","text":"","code":"# Create a view from the mean expression of the 10 nearest neighbors of # each cell.  library(dplyr) library(purrr) library(distances)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type)) # get the coordinates for each cell pos <- synthetic[[1]] %>% select(row, col)  # find the 10 nearest neighbors neighbors <- nearest_neighbor_search(distances(as.matrix(pos)), k = 11)[-1, ]  # calculate the mean expression of the nearest neighbors for all markers # for each cell in expr nnexpr <- seq_len(nrow(expr)) %>%   map_dfr(~ expr %>%     slice(neighbors[, .x]) %>%     colMeans())  create_view(\"nearest\", nnexpr, \"nn\") #> $nearest #> $nearest$abbrev #> [1] \"nn\" #>  #> $nearest$data #> # A tibble: 4,205 × 11 #>      ECM  ligA   ligB  ligC  ligD protE protF  prodA  prodB  prodC  prodD #>    <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> #>  1 0.169 0.449 0.0349 0.242 0.619 0.337 1.07  0.120  0.0138 0.146  0.165  #>  2 0.346 0.223 0.0303 0.478 0.191 0.676 0.549 0.0969 0.0140 0.190  0.0766 #>  3 0.219 0.242 0.0375 0.456 0.218 0.304 0.495 0.0496 0.0288 0.236  0.0387 #>  4 0.238 0.312 0.0433 0.311 0.303 0.607 0.651 0.132  0.0288 0.0954 0.122  #>  5 0.313 0.341 0.0480 0.269 0.357 0.688 0.835 0.166  0.0297 0.0837 0.173  #>  6 0.527 0.257 0.0668 0.369 0.346 0.743 0.616 0.0722 0.0184 0.135  0.0964 #>  7 0.278 0.241 0.0952 0.480 0.347 0.399 0.501 0.0413 0.0632 0.160  0.0604 #>  8 0.266 0.260 0.0912 0.444 0.385 0.537 0.624 0.0738 0.0463 0.154  0.117  #>  9 0.356 0.210 0.0811 0.522 0.311 0.564 0.565 0.0696 0.0415 0.208  0.106  #> 10 0.625 0.152 0.0923 0.612 0.229 0.863 0.458 0.0350 0.0823 0.230  0.0576 #> # ℹ 4,195 more rows #>  #>"},{"path":"https://saezlab.github.io/mistyR/reference/extract_signature.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract signatures from the results — extract_signature","title":"Extract signatures from the results — extract_signature","text":"Signature representation sample space mistyR results.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/extract_signature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract signatures from the results — extract_signature","text":"","code":"extract_signature(   misty.results,   type = c(\"performance\", \"contribution\", \"importance\"),   trim = -Inf,   trim.measure = c(\"gain.R2\", \"multi.R2\", \"intra.R2\", \"gain.RMSE\", \"multi.RMSE\",     \"intra.RMSE\") )"},{"path":"https://saezlab.github.io/mistyR/reference/extract_signature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract signatures from the results — extract_signature","text":"misty.results results list generated collect_results(). type type signature extract results. trim display targets performance value (R2 gain) (otherwise) value . trim.measure measure used trimming.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/extract_signature.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract signatures from the results — extract_signature","text":"table one row per sample misty.results representing signature.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/extract_signature.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract signatures from the results — extract_signature","text":"performance signature sample concatenation estimated values variance explained using intraview, variance explained multiview model gain variance explained marker. performance signature vector sample available misty.results length \\(\\textrm{markers} \\cdot 3\\). contribution signature sample concatenation estimated fraction contribution view marker. contribution signature vector sample available misty.results length \\(\\textrm{markers} \\cdot \\textrm{views}\\). importance signature sample concatenation estimated weighted importances predictor-target marker pair views. importance signature vector sample available misty.results length \\(\\textrm{markers}^2 \\cdot \\textrm{views}\\).","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/extract_signature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract signatures from the results — extract_signature","text":"","code":"library(dplyr)  misty.results <-   list.files(\"results\", full.names = TRUE) %>% collect_results() #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating  extract_signature(misty.results, \"performance\") #> # A tibble: 3 × 34 #>   sample       ECM_intra.R2 ECM_multi.R2 ECM_gain.R2 ligA_intra.R2 ligA_multi.R2 #>   <chr>               <dbl>        <dbl>       <dbl>         <dbl>         <dbl> #> 1 /tmp/Rtmpcr…         92.5         93.4       0.958          98.6          98.7 #> 2 /tmp/Rtmpcr…         93.2         94.1       0.882          98.7          98.7 #> 3 /tmp/Rtmpcr…         92.7         93.5       0.743          98.6          98.6 #> # ℹ 28 more variables: ligA_gain.R2 <dbl>, ligB_intra.R2 <dbl>, #> #   ligB_multi.R2 <dbl>, ligB_gain.R2 <dbl>, ligC_intra.R2 <dbl>, #> #   ligC_multi.R2 <dbl>, ligC_gain.R2 <dbl>, ligD_intra.R2 <dbl>, #> #   ligD_multi.R2 <dbl>, ligD_gain.R2 <dbl>, protE_intra.R2 <dbl>, #> #   protE_multi.R2 <dbl>, protE_gain.R2 <dbl>, protF_intra.R2 <dbl>, #> #   protF_multi.R2 <dbl>, protF_gain.R2 <dbl>, prodA_intra.R2 <dbl>, #> #   prodA_multi.R2 <dbl>, prodA_gain.R2 <dbl>, prodB_intra.R2 <dbl>, …"},{"path":"https://saezlab.github.io/mistyR/reference/filter_views.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter spatial units — filter_views","title":"Filter spatial units — filter_views","text":"Select, remove (duplicate) rows views composition row locations according conditions based specific view.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/filter_views.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter spatial units — filter_views","text":"","code":"filter_views(current.views, rows, view = \"intraview\", ...)"},{"path":"https://saezlab.github.io/mistyR/reference/filter_views.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter spatial units — filter_views","text":"current.views current view composition. rows row (integer) location; positive values keep (duplicate) /negative remove. view name view used filtering. ... logical expressions defined terms variables view passed dplyr::filter().","code":""},{"path":"https://saezlab.github.io/mistyR/reference/filter_views.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter spatial units — filter_views","text":"mistyR view composition filtered spatial units views.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/filter_views.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter spatial units — filter_views","text":"values rows priority parameters. rows contain integer values filtering performed based view specified view expressions (...) returning logical values defined terms variables view.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/filter_views.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter spatial units — filter_views","text":"","code":"# Create a view composition with an intraview and filter  library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type))  # compose misty.views <- create_initial_view(expr)  # select only the first 10 spatial units and preview misty.views %>%   filter_views(1:10) %>%   str() #> List of 2 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  : tibble [10 × 11] (S3: tbl_df/tbl/data.frame) #>   .. ..$ ECM  : num [1:10] 0.0385 0.0327 0.1444 0.387 0.1635 ... #>   .. ..$ ligA : num [1:10] 0.834 0.119 0.525 0.269 0.195 ... #>   .. ..$ ligB : num [1:10] 0.0157 0.0104 0.014 0.0367 0.1176 ... #>   .. ..$ ligC : num [1:10] 0.236 0.804 0.334 0.502 0.232 ... #>   .. ..$ ligD : num [1:10] 1.183 0.101 0.434 0.241 0.203 ... #>   .. ..$ protE: num [1:10] 1.18 0 1.67 0 0 ... #>   .. ..$ protF: num [1:10] 2.547 0.386 1.614 0.913 0.162 ... #>   .. ..$ prodA: num [1:10] 0.382 0 0.472 0 0 ... #>   .. ..$ prodB: num [1:10] 0 0 0 0 0.16 ... #>   .. ..$ prodC: num [1:10] 0 0.536 0 0.418 0 ... #>   .. ..$ prodD: num [1:10] 0.588 0 0.379 0 0 ... #>  $ misty.uniqueid: chr \"b98ad35f4e671871cba35f2155228612\"  # select only the units where the expression of ligA is larger than 0.5 # and preview misty.views %>%   filter_views(NA, \"intraview\", ligA > 0.5) %>%   str() #> List of 2 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  : tibble [213 × 11] (S3: tbl_df/tbl/data.frame) #>   .. ..$ ECM  : num [1:213] 0.0385 0.1444 0.0307 0.2313 0.0181 ... #>   .. ..$ ligA : num [1:213] 0.834 0.525 0.817 0.514 0.554 ... #>   .. ..$ ligB : num [1:213] 0.0157 0.014 0.0186 0.0313 0.0117 ... #>   .. ..$ ligC : num [1:213] 0.236 0.334 0.156 0.242 0.25 ... #>   .. ..$ ligD : num [1:213] 1.183 0.434 1.092 0.674 0.699 ... #>   .. ..$ protE: num [1:213] 1.178 1.669 0.779 1.21 1.249 ... #>   .. ..$ protF: num [1:213] 2.55 1.61 2.51 1.63 1.7 ... #>   .. ..$ prodA: num [1:213] 0.382 0.472 0.455 0.443 0.401 ... #>   .. ..$ prodB: num [1:213] 0 0 0 0 0 0 0 0 0 0 ... #>   .. ..$ prodC: num [1:213] 0 0 0 0 0 0 0 0 0 0 ... #>   .. ..$ prodD: num [1:213] 0.588 0.379 0.536 0.584 0.458 ... #>  $ misty.uniqueid: chr \"b98ad35f4e671871cba35f2155228612\""},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmap of local contrast between two views — plot_contrast_heatmap","title":"Plot heatmap of local contrast between two views — plot_contrast_heatmap","text":"heatmap shows interactions present importance cutoff value .view .view.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmap of local contrast between two views — plot_contrast_heatmap","text":"","code":"plot_contrast_heatmap(   misty.results,   from.view,   to.view,   cutoff = 1,   trim = -Inf,   trim.measure = c(\"gain.R2\", \"multi.R2\", \"intra.R2\", \"gain.RMSE\", \"multi.RMSE\",     \"intra.RMSE\") )"},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmap of local contrast between two views — plot_contrast_heatmap","text":"misty.results results list generated collect_results(). .view, .view abbreviated name view. cutoff importance threshold. Importances value colored white heatmap considered relevant. trim display targets performance value (R2 gain) (otherwise) value . trim.measure measure used trimming.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmap of local contrast between two views — plot_contrast_heatmap","text":"misty.results list (invisibly).","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmap of local contrast between two views — plot_contrast_heatmap","text":"","code":"all.samples <- list.dirs(\"results\", recursive = FALSE)  misty.results <- collect_results(all.samples) #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating  misty.results %>%   plot_contrast_heatmap(\"intra\", \"para.10\") #> Warning: Specifying the `id_cols` argument by position was deprecated in tidyr 1.3.0. #> ℹ Please explicitly name `id_cols`, like `id_cols = -c(view, nsamples)`. #> ℹ The deprecated feature was likely used in the mistyR package. #>   Please report the issue at <https://github.com/saezlab/mistyR/issues>.   misty.results %>%   plot_contrast_heatmap(\"intra\", \"para.10\", cutoff = 0.5)"},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmap of contrast between two result lists — plot_contrast_results","title":"Plot heatmap of contrast between two result lists — plot_contrast_results","text":"Plot interexperiment contrast views.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmap of contrast between two result lists — plot_contrast_results","text":"","code":"plot_contrast_results(   misty.results.from,   misty.results.to,   views = NULL,   cutoff.from = 1,   cutoff.to = 1,   trim = -Inf,   trim.measure = c(\"gain.R2\", \"multi.R2\", \"intra.R2\", \"gain.RMSE\", \"multi.RMSE\",     \"intra.RMSE\") )"},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmap of contrast between two result lists — plot_contrast_results","text":"misty.results., misty.results.results list generated collect_results(). views one abbreviated names views. cutoff., cutoff.importance thresholds respective result lists. trim display targets performance value (R2 gain) (otherwise) value . trim.measure measure used trimming.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmap of contrast between two result lists — plot_contrast_results","text":"misty.results.list (invisibly).","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot heatmap of contrast between two result lists — plot_contrast_results","text":"heatmaps show interactions present importance cutoff.value views misty.results.present importance cutoff.views misty.results..","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/plot_contrast_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmap of contrast between two result lists — plot_contrast_results","text":"","code":"# if for example the available samples come from different grades of tumors  grade1.results <- collect_results(c(\"results/synthetic1\", \"results/synthetic2\")) #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating grade3.results <- collect_results(\"results/synthetic10\") #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating  # highlight interactions present in grade 1 tumors but not in grade 3 tumors # in the paraview  grade3.results %>% plot_contrast_results(grade1.results, views = \"para.10\")   # see the loss of interactions in all views with lower sensitivity  plot_contrast_results(grade3.results, grade1.results, cutoff.from = 0.75, cutoff.to = 0.5)"},{"path":"https://saezlab.github.io/mistyR/reference/plot_improvement_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot observed performance and improvement per target — plot_improvement_stats","title":"Plot observed performance and improvement per target — plot_improvement_stats","text":"Generates plot mean (+- standard deviation) performance value per target across samples results.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_improvement_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot observed performance and improvement per target — plot_improvement_stats","text":"","code":"plot_improvement_stats(   misty.results,   measure = c(\"gain.R2\", \"multi.R2\", \"intra.R2\", \"gain.RMSE\", \"multi.RMSE\", \"intra.RMSE\"),   trim = -Inf )"},{"path":"https://saezlab.github.io/mistyR/reference/plot_improvement_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot observed performance and improvement per target — plot_improvement_stats","text":"misty.results results list generated collect_results(). measure performance measure plotted (See collect_results()). trim display targets performance value (R2 gain) (otherwise) value .","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_improvement_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot observed performance and improvement per target — plot_improvement_stats","text":"misty.results list (invisibly).","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/plot_improvement_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot observed performance and improvement per target — plot_improvement_stats","text":"","code":"all.samples <- list.dirs(\"results\", recursive = FALSE)  collect_results(all.samples) %>% plot_improvement_stats() #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating   misty.results <- collect_results(all.samples) #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating misty.results %>% plot_improvement_stats(measure = \"gain.RMSE\")  misty.results %>% plot_improvement_stats(measure = \"intra.R2\")"},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_communities.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot marker interaction communities — plot_interaction_communities","title":"Plot marker interaction communities — plot_interaction_communities","text":"Identify plot graph marker interaction communities.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_communities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot marker interaction communities — plot_interaction_communities","text":"","code":"plot_interaction_communities(misty.results, view, cutoff = 1)"},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_communities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot marker interaction communities — plot_interaction_communities","text":"misty.results results list generated collect_results(). view abbreviated name view. cutoff importance threshold. Importances value colored white heatmap considered relevant.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_communities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot marker interaction communities — plot_interaction_communities","text":"misty.results list (invisibly).","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_communities.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot marker interaction communities — plot_interaction_communities","text":"communities identified using Louvain algorithm. Communities can extracted views predictor target markers.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_communities.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot marker interaction communities — plot_interaction_communities","text":"","code":"all.samples <- list.dirs(\"results\", recursive = FALSE)  misty.results <- collect_results(all.samples) #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating  misty.results %>%   plot_interaction_communities(\"intra\") %>%   plot_interaction_communities(\"para.10\")    misty.results %>%   plot_interaction_communities(\"para.10\", cutoff = 0.5)"},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot importance heatmap for a view — plot_interaction_heatmap","title":"Plot importance heatmap for a view — plot_interaction_heatmap","text":"Generate heatmap importances predictor-target interaction.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot importance heatmap for a view — plot_interaction_heatmap","text":"","code":"plot_interaction_heatmap(   misty.results,   view,   cutoff = 1,   trim = -Inf,   trim.measure = c(\"gain.R2\", \"multi.R2\", \"intra.R2\", \"gain.RMSE\", \"multi.RMSE\",     \"intra.RMSE\"),   clean = FALSE )"},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot importance heatmap for a view — plot_interaction_heatmap","text":"misty.results results list generated collect_results(). view abbreviated name view. cutoff importance threshold. Importances value colored white heatmap considered relevant. trim display targets performance value (R2 gain) (otherwise) value . trim.measure measure used trimming. clean logical indicating whether remove rows columns importances cutoff heatmap.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot importance heatmap for a view — plot_interaction_heatmap","text":"misty.results list (invisibly).","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/plot_interaction_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot importance heatmap for a view — plot_interaction_heatmap","text":"","code":"all.samples <- list.dirs(\"results\", recursive = FALSE)  collect_results(all.samples) %>%   plot_interaction_heatmap(\"intra\") %>%   plot_interaction_heatmap(\"para.10\", cutoff = 0.5) #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating"},{"path":"https://saezlab.github.io/mistyR/reference/plot_view_contributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot view contributions per target — plot_view_contributions","title":"Plot view contributions per target — plot_view_contributions","text":"Generate stacked barplot average view contribution fraction per target across samples results.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_view_contributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot view contributions per target — plot_view_contributions","text":"","code":"plot_view_contributions(   misty.results,   trim = -Inf,   trim.measure = c(\"gain.R2\", \"multi.R2\", \"intra.R2\", \"gain.RMSE\", \"multi.RMSE\",     \"intra.RMSE\") )"},{"path":"https://saezlab.github.io/mistyR/reference/plot_view_contributions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot view contributions per target — plot_view_contributions","text":"misty.results results list generated collect_results(). trim display targets performance value (R2 gain) (otherwise) value . trim.measure measure used trimming.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/plot_view_contributions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot view contributions per target — plot_view_contributions","text":"misty.results list (invisibly).","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/plot_view_contributions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot view contributions per target — plot_view_contributions","text":"","code":"all.samples <- list.dirs(\"results\", recursive = FALSE)  collect_results(all.samples) %>% plot_view_contributions() #>  #> Collecting improvements #>  #> Collecting contributions #>  #> Collecting importances #>  #> Aggregating"},{"path":"https://saezlab.github.io/mistyR/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. dplyr %>%","code":""},{"path":"https://saezlab.github.io/mistyR/reference/reexports.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Objects exported from other packages — reexports","text":"","code":"# Create a view composition of an intraview and a paraview with radius 10 then # run MISTy for a single sample.  library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type)) # get the coordinates for each cell pos <- synthetic[[1]] %>% select(row, col)  # compose misty.views <- create_initial_view(expr) %>% add_paraview(pos, l = 10) #>  #> Generating paraview  # run with default parameters run_misty(misty.views) #>  #> Training models #> [1] \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results\""},{"path":"https://saezlab.github.io/mistyR/reference/remove_views.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove views from the current view composition — remove_views","title":"Remove views from the current view composition — remove_views","text":"Remove one views view composition.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/remove_views.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove views from the current view composition — remove_views","text":"","code":"remove_views(current.views, view.names)"},{"path":"https://saezlab.github.io/mistyR/reference/remove_views.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove views from the current view composition — remove_views","text":"current.views current view composition. view.names names one views removed.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/remove_views.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove views from the current view composition — remove_views","text":"mistyR view composition view.names views removed.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/remove_views.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Remove views from the current view composition — remove_views","text":"intraview unique id removed function.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/remove_views.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove views from the current view composition — remove_views","text":"","code":"library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type)) # get the coordinates for each cell pos <- synthetic[[1]] %>% select(row, col)  # compose misty.views <- create_initial_view(expr) %>%   add_juxtaview(pos, neighbor.thr = 1.5) %>%   add_paraview(pos, l = 10) #>  #> Computing triangulation #>  #> Generating juxtaview #>  #> Generating paraview  # preview str(misty.views) #> List of 4 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  : tibble [4,205 × 11] (S3: tbl_df/tbl/data.frame) #>   .. ..$ ECM  : num [1:4205] 0.0385 0.0327 0.1444 0.387 0.1635 ... #>   .. ..$ ligA : num [1:4205] 0.834 0.119 0.525 0.269 0.195 ... #>   .. ..$ ligB : num [1:4205] 0.0157 0.0104 0.014 0.0367 0.1176 ... #>   .. ..$ ligC : num [1:4205] 0.236 0.804 0.334 0.502 0.232 ... #>   .. ..$ ligD : num [1:4205] 1.183 0.101 0.434 0.241 0.203 ... #>   .. ..$ protE: num [1:4205] 1.18 0 1.67 0 0 ... #>   .. ..$ protF: num [1:4205] 2.547 0.386 1.614 0.913 0.162 ... #>   .. ..$ prodA: num [1:4205] 0.382 0 0.472 0 0 ... #>   .. ..$ prodB: num [1:4205] 0 0 0 0 0.16 ... #>   .. ..$ prodC: num [1:4205] 0 0.536 0 0.418 0 ... #>   .. ..$ prodD: num [1:4205] 0.588 0 0.379 0 0 ... #>  $ misty.uniqueid: chr \"b98ad35f4e671871cba35f2155228612\" #>  $ juxtaview.1.5 :List of 2 #>   ..$ abbrev: chr \"juxta.1.5\" #>   ..$ data  :'data.frame':\t4205 obs. of  11 variables: #>   .. ..$ ECM  : num [1:4205] 0.116 0.105 1.395 1.315 1.395 ... #>   .. ..$ ligA : num [1:4205] 1.3988 0.0653 0.5141 0.965 0.5141 ... #>   .. ..$ ligB : num [1:4205] 0.0394 0.0188 0.0629 0.1578 0.0629 ... #>   .. ..$ ligC : num [1:4205] 0.53 0.856 0.825 0.89 0.825 ... #>   .. ..$ ligD : num [1:4205] 1.9261 0.0577 0.4646 0.8604 0.4646 ... #>   .. ..$ protE: num [1:4205] 0.779 0 1.617 3.286 1.617 ... #>   .. ..$ protF: num [1:4205] 4.31 0.25 0.988 1.851 0.988 ... #>   .. ..$ prodA: num [1:4205] 0.455 0 0 0.472 0 ... #>   .. ..$ prodB: num [1:4205] 0 0 0 0.16 0 ... #>   .. ..$ prodC: num [1:4205] 0.433 0.548 0.418 0 0.418 ... #>   .. ..$ prodD: num [1:4205] 0.536 0 0 0.379 0 ... #>  $ paraview.10   :List of 2 #>   ..$ abbrev: chr \"para.10\" #>   ..$ data  :'data.frame':\t4205 obs. of  11 variables: #>   .. ..$ ECM  : num [1:4205] 6.98 15.05 17.37 18.4 19.93 ... #>   .. ..$ ligA : num [1:4205] 13.2 12.9 13.6 14.3 14.7 ... #>   .. ..$ ligB : num [1:4205] 1.29 2.31 2.78 3 3.16 ... #>   .. ..$ ligC : num [1:4205] 9.56 18.52 20.42 20.97 21.99 ... #>   .. ..$ ligD : num [1:4205] 17 15.1 16.1 16.9 17.5 ... #>   .. ..$ protE: num [1:4205] 14 26.6 28.1 31.5 33.2 ... #>   .. ..$ protF: num [1:4205] 28.1 27.7 29 30.9 32.7 ... #>   .. ..$ prodA: num [1:4205] 4.37 5.24 5.04 5.61 5.69 ... #>   .. ..$ prodB: num [1:4205] 0.816 1.659 1.948 2.093 2.076 ... #>   .. ..$ prodC: num [1:4205] 3.87 7.29 8.23 8 8.61 ... #>   .. ..$ prodD: num [1:4205] 5.64 6.01 5.98 6.51 6.64 ...  # remove juxtaview and preview misty.views %>%   remove_views(\"juxtaview.1.5\") %>%   str() #> List of 3 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  : tibble [4,205 × 11] (S3: tbl_df/tbl/data.frame) #>   .. ..$ ECM  : num [1:4205] 0.0385 0.0327 0.1444 0.387 0.1635 ... #>   .. ..$ ligA : num [1:4205] 0.834 0.119 0.525 0.269 0.195 ... #>   .. ..$ ligB : num [1:4205] 0.0157 0.0104 0.014 0.0367 0.1176 ... #>   .. ..$ ligC : num [1:4205] 0.236 0.804 0.334 0.502 0.232 ... #>   .. ..$ ligD : num [1:4205] 1.183 0.101 0.434 0.241 0.203 ... #>   .. ..$ protE: num [1:4205] 1.18 0 1.67 0 0 ... #>   .. ..$ protF: num [1:4205] 2.547 0.386 1.614 0.913 0.162 ... #>   .. ..$ prodA: num [1:4205] 0.382 0 0.472 0 0 ... #>   .. ..$ prodB: num [1:4205] 0 0 0 0 0.16 ... #>   .. ..$ prodC: num [1:4205] 0 0.536 0 0.418 0 ... #>   .. ..$ prodD: num [1:4205] 0.588 0 0.379 0 0 ... #>  $ misty.uniqueid: chr \"b98ad35f4e671871cba35f2155228612\" #>  $ paraview.10   :List of 2 #>   ..$ abbrev: chr \"para.10\" #>   ..$ data  :'data.frame':\t4205 obs. of  11 variables: #>   .. ..$ ECM  : num [1:4205] 6.98 15.05 17.37 18.4 19.93 ... #>   .. ..$ ligA : num [1:4205] 13.2 12.9 13.6 14.3 14.7 ... #>   .. ..$ ligB : num [1:4205] 1.29 2.31 2.78 3 3.16 ... #>   .. ..$ ligC : num [1:4205] 9.56 18.52 20.42 20.97 21.99 ... #>   .. ..$ ligD : num [1:4205] 17 15.1 16.1 16.9 17.5 ... #>   .. ..$ protE: num [1:4205] 14 26.6 28.1 31.5 33.2 ... #>   .. ..$ protF: num [1:4205] 28.1 27.7 29 30.9 32.7 ... #>   .. ..$ prodA: num [1:4205] 4.37 5.24 5.04 5.61 5.69 ... #>   .. ..$ prodB: num [1:4205] 0.816 1.659 1.948 2.093 2.076 ... #>   .. ..$ prodC: num [1:4205] 3.87 7.29 8.23 8 8.61 ... #>   .. ..$ prodD: num [1:4205] 5.64 6.01 5.98 6.51 6.64 ...  # remove juxtaview and paraview and preview misty.views %>%   remove_views(c(\"juxtaview.1.5\", \"paraview.10\")) %>%   str() #> List of 2 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  : tibble [4,205 × 11] (S3: tbl_df/tbl/data.frame) #>   .. ..$ ECM  : num [1:4205] 0.0385 0.0327 0.1444 0.387 0.1635 ... #>   .. ..$ ligA : num [1:4205] 0.834 0.119 0.525 0.269 0.195 ... #>   .. ..$ ligB : num [1:4205] 0.0157 0.0104 0.014 0.0367 0.1176 ... #>   .. ..$ ligC : num [1:4205] 0.236 0.804 0.334 0.502 0.232 ... #>   .. ..$ ligD : num [1:4205] 1.183 0.101 0.434 0.241 0.203 ... #>   .. ..$ protE: num [1:4205] 1.18 0 1.67 0 0 ... #>   .. ..$ protF: num [1:4205] 2.547 0.386 1.614 0.913 0.162 ... #>   .. ..$ prodA: num [1:4205] 0.382 0 0.472 0 0 ... #>   .. ..$ prodB: num [1:4205] 0 0 0 0 0.16 ... #>   .. ..$ prodC: num [1:4205] 0 0.536 0 0.418 0 ... #>   .. ..$ prodD: num [1:4205] 0.588 0 0.379 0 0 ... #>  $ misty.uniqueid: chr \"b98ad35f4e671871cba35f2155228612\""},{"path":"https://saezlab.github.io/mistyR/reference/rename_view.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename view in a view composition — rename_view","title":"Rename view in a view composition — rename_view","text":"Rename view view composition","code":""},{"path":"https://saezlab.github.io/mistyR/reference/rename_view.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename view in a view composition — rename_view","text":"","code":"rename_view(current.views, old.name, new.name, new.abbrev = new.name)"},{"path":"https://saezlab.github.io/mistyR/reference/rename_view.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename view in a view composition — rename_view","text":"current.views current view composition. old.name old name view. new.name new name view. new.abbrev new abbreviated name.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/rename_view.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename view in a view composition — rename_view","text":"mistyR view composition renamed view.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/rename_view.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename view in a view composition — rename_view","text":"","code":"view1 <- data.frame(marker1 = rnorm(100, 10, 2), marker2 = rnorm(100, 15, 3)) view2 <- data.frame(marker1 = rnorm(100, 10, 5), marker2 = rnorm(100, 15, 5))  misty.views <- create_initial_view(view1) %>%   add_views(create_view(\"originalname\", view2, \"on\")) str(misty.views) #> List of 3 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  :'data.frame':\t100 obs. of  2 variables: #>   .. ..$ marker1: num [1:100] 7.05 7.19 13.98 9.18 8.68 ... #>   .. ..$ marker2: num [1:100] 5.82 17.39 13.54 7.83 18.56 ... #>  $ misty.uniqueid: chr \"397aabb41517c46aac7d78a2001bec9f\" #>  $ originalname  :List of 2 #>   ..$ abbrev: chr \"on\" #>   ..$ data  :'data.frame':\t100 obs. of  2 variables: #>   .. ..$ marker1: num [1:100] 12.61 9.46 12.83 17.66 8.12 ... #>   .. ..$ marker2: num [1:100] 20.7 17.2 19.1 20.7 17.1 ...  # rename and preview misty.views %>%   rename_view(\"originalname\", \"renamed\", \"rn\") %>%   str() #> List of 3 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  :'data.frame':\t100 obs. of  2 variables: #>   .. ..$ marker1: num [1:100] 7.05 7.19 13.98 9.18 8.68 ... #>   .. ..$ marker2: num [1:100] 5.82 17.39 13.54 7.83 18.56 ... #>  $ misty.uniqueid: chr \"397aabb41517c46aac7d78a2001bec9f\" #>  $ renamed       :List of 2 #>   ..$ abbrev: chr \"rn\" #>   ..$ data  :'data.frame':\t100 obs. of  2 variables: #>   .. ..$ marker1: num [1:100] 12.61 9.46 12.83 17.66 8.12 ... #>   .. ..$ marker2: num [1:100] 20.7 17.2 19.1 20.7 17.1 ..."},{"path":"https://saezlab.github.io/mistyR/reference/run_misty.html","id":null,"dir":"Reference","previous_headings":"","what":"Train MISTy models — run_misty","title":"Train MISTy models — run_misty","text":"Trains multi-view models target markers, estimates performance, contributions view specific models importance predictor markers target marker.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/run_misty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Train MISTy models — run_misty","text":"","code":"run_misty(   views,   results.folder = \"results\",   seed = 42,   target.subset = NULL,   bypass.intra = FALSE,   cv.folds = 10,   cached = FALSE,   append = FALSE,   model.function = random_forest_model,   ... )"},{"path":"https://saezlab.github.io/mistyR/reference/run_misty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Train MISTy models — run_misty","text":"views view composition. results.folder path top level folder store raw results. seed seed used random sampling ensure reproducibility. target.subset subset targets train models . NULL, models trained markers intraview. bypass.intra logical indicating whether train baseline model using intraview data (see Details). cv.folds number cross-validation folds consider estimating performance multi-view models cached logical indicating whether cache trained models reuse previously cached ones already exist sample. append logical indicating whether append performance coefficient files results.folder. Consider setting TRUE rerunning workflow different target.subset parameters. model.function function used model view, default model random_forest_model. models included mistyR gradient_boosting_model, bagged_mars_model, mars_model, linear_model, svm_model, mlp_model ... additional parameters passed chosen ML model training view-specific models","code":""},{"path":"https://saezlab.github.io/mistyR/reference/run_misty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Train MISTy models — run_misty","text":"Path results folder can passed  collect_results().","code":""},{"path":"https://saezlab.github.io/mistyR/reference/run_misty.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Train MISTy models — run_misty","text":"bypass.intra set TRUE variable intraview intraview data treated targets . baseline intraview model case trivial model predicts average target. intraview one variable switch automatically set TRUE. Default model train view-specific views Random Forest model based ranger() --   run_misty(views, model.function = random_forest_model) following parameters default configuration: num.trees = 100, importance = \"impurity\", num.threads = 1, seed = seed. Gradient boosting alternative model view using gradient  boosting. algorithm based xgb.train() --  run_misty(views, model.function = gradient_boosting_model) following parameters default configuration: booster = \"gbtree\", rounds = 10, objective = \"reg:squarederror\". Set booster \"gblinear\" linear boosting. Bagged MARS alternative model view using bagged MARS, (multivariate adaptive spline regression models) trained  bootstrap aggregation samples. algorithm based  earth() -- run_misty(views, model.function = bagged_mars_model) following parameters default configuration: degree = 2. Furthermore 50 base learners used default (pass n.bags parameter via ... change value). MARS alternative model view using  multivariate adaptive spline regression model. algorithm based  earth() -- run_misty(views, model.function = mars_model) following parameters default configuration: degree = 2. Linear model alternative model view using simple linear model. algorithm based lm() -- run_misty(views, model.function = linear_model) SVM alternative model view using support vector  machines. algorithm based ksvm() -- run_misty(views, model.function = svm_model) following parameters default configuration: kernel = \"vanilladot\"  (linear kernel), C = 1, type = \"eps-svr\". MLP alternative model view using multi-layer perceptron. alogorithm based mlp() -- run_misty(views, model.function = mlp_model) following parameters default configuration: size = c(10)  (meaning 1 hidden layer 10 units).","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/run_misty.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Train MISTy models — run_misty","text":"","code":"# Create a view composition of an intraview and a paraview with radius 10 then # run MISTy for a single sample.  library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type)) # get the coordinates for each cell pos <- synthetic[[1]] %>% select(row, col)  # compose misty.views <- create_initial_view(expr) %>% add_paraview(pos, l = 10) #>  #> Generating paraview  # run with default parameters run_misty(misty.views) #>  #> Training models #> [1] \"/tmp/RtmpcrfSZ8/file2484477ca03e/reference/results\""},{"path":"https://saezlab.github.io/mistyR/reference/select_markers.html","id":null,"dir":"Reference","previous_headings":"","what":"Select a subset of markers in a view — select_markers","title":"Select a subset of markers in a view — select_markers","text":"Select subset markers view","code":""},{"path":"https://saezlab.github.io/mistyR/reference/select_markers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select a subset of markers in a view — select_markers","text":"","code":"select_markers(current.views, view = \"intraview\", ...)"},{"path":"https://saezlab.github.io/mistyR/reference/select_markers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select a subset of markers in a view — select_markers","text":"current.views current view composition. view name view select markers . ... one select expressions dplyr::select() specified view.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/select_markers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select a subset of markers in a view — select_markers","text":"mistyR view composition selected markers view.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/reference/select_markers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select a subset of markers in a view — select_markers","text":"","code":"# Create a view composition with an intraview and select  library(dplyr)  # get the expression data data(\"synthetic\") expr <- synthetic[[1]] %>% select(-c(row, col, type))  # compose misty.views <- create_initial_view(expr)  # select markers from the intraview not starting with lig and preview misty.views %>%   select_markers(\"intraview\", !starts_with(\"lig\")) %>%   str() #> List of 2 #>  $ intraview     :List of 2 #>   ..$ abbrev: chr \"intra\" #>   ..$ data  : tibble [4,205 × 7] (S3: tbl_df/tbl/data.frame) #>   .. ..$ ECM  : num [1:4205] 0.0385 0.0327 0.1444 0.387 0.1635 ... #>   .. ..$ protE: num [1:4205] 1.18 0 1.67 0 0 ... #>   .. ..$ protF: num [1:4205] 2.547 0.386 1.614 0.913 0.162 ... #>   .. ..$ prodA: num [1:4205] 0.382 0 0.472 0 0 ... #>   .. ..$ prodB: num [1:4205] 0 0 0 0 0.16 ... #>   .. ..$ prodC: num [1:4205] 0 0.536 0 0.418 0 ... #>   .. ..$ prodD: num [1:4205] 0.588 0 0.379 0 0 ... #>  $ misty.uniqueid: chr \"b98ad35f4e671871cba35f2155228612\""},{"path":"https://saezlab.github.io/mistyR/reference/synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Synthetic benchmark data for mistyR — synthetic","title":"Synthetic benchmark data for mistyR — synthetic","text":"Data generated 10 random layouts four cell types empty space 100--100 grid simulating two-dimensional cellular automata model focuses signaling events. Cell growth, division, motility death neglected. intracellular processes involve two layers, first ligand activation signaling hubs ligand production/secretion regulated proteins. model simulates production, diffusion, degradation interactions 11 molecular species. Ligands produced cell-type based activity level production nodes freely diffuse, degrade interact cells grid. molecular species involved signaling localised intracellular space activity depends ligand binding intracellular wiring.","code":""},{"path":"https://saezlab.github.io/mistyR/reference/synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Synthetic benchmark data for mistyR — synthetic","text":"","code":"data(\"synthetic\")"},{"path":"https://saezlab.github.io/mistyR/reference/synthetic.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Synthetic benchmark data for mistyR — synthetic","text":"named list length 10. list item tibble corresponds simulation one random layout information cell rows described following 14 variables: row, col location cell grid ligA, ligB, ligC, ligD expression ligands protE, protF expression intracellular proteins prodA, prodB, prodC, prodD expression regulatory proteins type cell type id","code":""},{"path":"https://saezlab.github.io/mistyR/reference/synthetic.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Synthetic benchmark data for mistyR — synthetic","text":"https://github.com/saezlab/misty_pipelines/","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-181","dir":"Changelog","previous_headings":"","what":"mistyR 1.8.1","title":"mistyR 1.8.1","text":"Requires dplyr >=1.1.0 due change sorting order arrange()","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-180","dir":"Changelog","previous_headings":"","what":"mistyR 1.8.0","title":"mistyR 1.8.0","text":"Release version Bioconductor 3.17.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-161","dir":"Changelog","previous_headings":"","what":"mistyR 1.6.1","title":"mistyR 1.6.1","text":"Discontinue use .data due deprecation since tidyselect 1.2.0. Update minimum required versions tidyverse related packages due function deprecation.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-160","dir":"Changelog","previous_headings":"","what":"mistyR 1.6.0","title":"mistyR 1.6.0","text":"Release version Bioconductor 3.16. See changes 1.5.x.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-15x","dir":"Changelog","previous_headings":"","what":"mistyR 1.5.x","title":"mistyR 1.5.x","text":"Added different modeling functions. Might completely backwards compatible!","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-140","dir":"Changelog","previous_headings":"","what":"mistyR 1.4.0","title":"mistyR 1.4.0","text":"Release version Bioconductor 3.15. See changes 1.3.x.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-13x","dir":"Changelog","previous_headings":"","what":"mistyR 1.3.x","title":"mistyR 1.3.x","text":"Switched Louvain Leiden algorithm community detection (requires igraph >= 1.2.7). metamodel now build ridge regression. Intercept p-values calculated, values set NA backwards compatibility. Unique value error cv folds downgraded warning. Prefix can added column names generated fucntions add_juxtaview add_paraview. allows modeling maker expression juxtaview paraview. Bug fixes.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-121","dir":"Changelog","previous_headings":"","what":"mistyR 1.2.1","title":"mistyR 1.2.1","text":"Fixed separator issue results aggregation signature generation might cause issues variable names containing “_“.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-120","dir":"Changelog","previous_headings":"","what":"mistyR 1.2.0","title":"mistyR 1.2.0","text":"Release version Bioconductor 3.14. See changes 1.1.x.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-11x","dir":"Changelog","previous_headings":"","what":"mistyR 1.1.x","title":"mistyR 1.1.x","text":"Added functions view manipulation, including view filtering marker selection. Added functions performance, contribution importance signature extraction results. Aggregation signature generation generalized samples non-identical targets working intersection. Modeling intraview can bypassed. Added families distances calculate paraview. Paraview can exlcude measurements within used defined zone indifference around spatial unit. Improved plotting control. Complete test coverage. IMPORTANT: R2 now reported percentages intra, multi gain. Collecting results running mistyR < 1.1.11 lead miscalculation gain.R2. Update performance.txt files multiplying values columns intra.R2 multi.R2 100.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-103","dir":"Changelog","previous_headings":"","what":"mistyR 1.0.3","title":"mistyR 1.0.3","text":"Fixed display messages progress view generation. Improved plotting control display. Fixed handling NaN results. Vignette output switched BiocStyle rmarkdown pdfs due BiocStyle issue.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-102","dir":"Changelog","previous_headings":"","what":"mistyR 1.0.2","title":"mistyR 1.0.2","text":"Bugfix: models built different parameters stored retrieved cache file. Avoid calls os-dependent file.info tests.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-101","dir":"Changelog","previous_headings":"","what":"mistyR 1.0.1","title":"mistyR 1.0.1","text":"Bugfix: passing arguments ranger. Warnings clearing nonexistent cache folders tests performance. Increased test coverage.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-100","dir":"Changelog","previous_headings":"","what":"mistyR 1.0.0","title":"mistyR 1.0.0","text":"Release version Bioconductor 3.13.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-09911","dir":"Changelog","previous_headings":"","what":"mistyR 0.99.11","title":"mistyR 0.99.11","text":"Fixed bug Nystrom approximation creating paraview. Added suite tests high coverage. Cleaner cache control.","code":""},{"path":[]},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"revisions-requested-by-bioconductor-0-99-9","dir":"Changelog","previous_headings":"","what":"Revisions requested by Bioconductor","title":"mistyR 0.99.9","text":"Removed magrittr dependencies. Reexported pipe operator. Removed examples. Caching turned default. Added parameter appending performance coefficient files run_misty. Internal functions views.R now explicit. Removed alternatives additional examples function use documentation. Removed redundant messages, escalated warnings required. run_misty cleans empty cache directories. Vignette compatibility new release SpatialExperiment. Remove Seurat vignette package due missing hdf5r binary R 4.1 CRAN MacOS.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"other-changes-0-99-9","dir":"Changelog","previous_headings":"","what":"Other changes","title":"mistyR 0.99.9","text":"README.md figures moved cloud. passed paths cache location normalized. Changes mistyR vignette reflect changes insilico evaluation paper.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-0990","dir":"Changelog","previous_headings":"","what":"mistyR 0.99.0","title":"mistyR 0.99.0","text":"Version vignettes ready submit Bioconductor.","code":""},{"path":"https://saezlab.github.io/mistyR/news/index.html","id":"mistyr-010-misty","dir":"Changelog","previous_headings":"","what":"mistyR 0.1.0 (MISTy)","title":"mistyR 0.1.0 (MISTy)","text":"Initial beta release mistyR (named MISTy) function documentation.","code":""}]
