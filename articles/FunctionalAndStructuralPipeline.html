<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mistyR">
<title>Learning functional and structural spatial relationships with MISTy • mistyR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Learning functional and structural spatial relationships with MISTy">
<meta property="og:description" content="mistyR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-9"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-9');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mistyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.10.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/mistyR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FunctionalAndStructuralPipeline.html">Learning functional and structural spatial relationships with MISTy</a>
    <a class="dropdown-item" href="../articles/FunctionalPipelinePathwayActivityLigands.html">Functional analysis with MISTy - pathway activity and ligand expression</a>
    <a class="dropdown-item" href="../articles/FunctionalPipelinePathwaySpecific.html">Functional analysis with MISTy - pathway specific genes</a>
    <a class="dropdown-item" href="../articles/MistyRStructuralAnalysisPipelineC2L.html">Structural analysis with MISTy - based on cell2location deconvolution</a>
    <a class="dropdown-item" href="../articles/MistyRStructuralAnalysisPipelineDOT.html">Structural analysis with MISTy - based on DOT deconvolution</a>
    <a class="dropdown-item" href="../articles/ReproduceSignaturePaper.html">MISTy representation based analysis of IMC breast cancer data</a>
    <a class="dropdown-item" href="../articles/mistyDataFormats.html">mistyR and data formats</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/saezlab/mistyR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/saezlab">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://saezlab.org/">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Learning functional and structural spatial relationships with MISTy</h1>
                        <h4 data-toc-skip class="author">Leoni
Zimmermann</h4>
            <address class="author_afil">
      Heidelberg University, Heidelberg,
Germany<br><h4 data-toc-skip class="author">Jovan
Tanevski</h4>
            <address class="author_afil">
      Heidelberg University and Heidelberg University Hospital,
Heidelberg, Germany <br>Jožef Stefan Institute, Ljubljana,
Slovenia<br><a class="author_email" href="mailto:#"></a><a href="mailto:jovan.tanevski@uni-heidelberg.de" class="email">jovan.tanevski@uni-heidelberg.de</a>
      </address>
                  
            <h4 data-toc-skip class="date">2024-03-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/saezlab/mistyR/blob/HEAD/vignettes/FunctionalAndStructuralPipeline.Rmd" class="external-link"><code>vignettes/FunctionalAndStructuralPipeline.Rmd</code></a></small>
      <div class="d-none name"><code>FunctionalAndStructuralPipeline.Rmd</code></div>
    </address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>10X Visium captures spatially resolved transcriptomic profiles in
spots containing multiple cells. In this vignette, we will use the gene
expression information from Visium data to infer pathway and
transcription factor activity and separately investigate spatial
relationships between them and the cell-type composition. In addition,
we will examine spatial relationships of ligands and receptors.</p>
<p>Load the necessary R packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MISTy</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://saezlab.github.io/mistyR/">mistyR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For using Python </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Seurat</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pathways</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://saezlab.github.io/decoupleR/" class="external-link">decoupleR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Cleaning names</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span></code></pre></div>
<p>We will use some functions in python since the computation time is
significantly shorter than in R. Python chunks start with a #In Python.
Install and load the necessary package for Python:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_install.html" class="external-link">py_install</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decoupler"</span>,<span class="st">"omnipath"</span><span class="op">)</span>, pip <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using Python: /usr/bin/python3.10</span></span>
<span><span class="co">## Creating virtual environment '~/.virtualenvs/r-reticulate' ...</span></span></code></pre>
<pre><code><span><span class="co">## + /usr/bin/python3.10 -m venv /home/runner/.virtualenvs/r-reticulate</span></span></code></pre>
<pre><code><span><span class="co">## Done!</span></span>
<span><span class="co">## Installing packages: pip, wheel, setuptools</span></span></code></pre>
<pre><code><span><span class="co">## + /home/runner/.virtualenvs/r-reticulate/bin/python -m pip install --upgrade pip wheel setuptools</span></span></code></pre>
<pre><code><span><span class="co">## Virtual environment '~/.virtualenvs/r-reticulate' successfully created.</span></span>
<span><span class="co">## Using virtual environment '~/.virtualenvs/r-reticulate' ...</span></span></code></pre>
<pre><code><span><span class="co">## + /home/runner/.virtualenvs/r-reticulate/bin/python -m pip install --upgrade --no-user decoupler omnipath</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># In Python:</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="im">import</span> decoupler <span class="im">as</span> dc</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-and-load-data">Get and load data<a class="anchor" aria-label="anchor" href="#get-and-load-data"></a>
</h2>
<p>For this showcase, we use a 10X Visium spatial slide from <a href="https://doi.org/10.1038/s41586-022-05060-x" class="external-link">Kuppe et al.,
2022</a>, where they created a spatial multi-omic map of human
myocardial infarction. The tissue example data comes from the human
heart of patient 14, which is in a chronic state following myocardial
infarction. The Seurat object contains, among other things, the
normalized and raw gene counts. First, we have to download and extract
the file:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://zenodo.org/records/6580069/files/10X_Visium_ACH005.tar.gz?download=1"</span>,</span>
<span>    destfile <span class="op">=</span> <span class="st">"10X_Visium_ACH005.tar.gz"</span>, method <span class="op">=</span> <span class="st">"curl"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/untar.html" class="external-link">untar</a></span><span class="op">(</span><span class="st">"10X_Visium_ACH005.tar.gz"</span><span class="op">)</span></span></code></pre></div>
<p>The next step is to load the data, extract the normalized gene counts
of genes expressed in at least 5% of the spots, and pixel coordinates.
It is recommended to use pixel coordinates instead of row and column
numbers since the rows are shifted and therefore do not express the real
distance between the spots.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seurat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"ACH005/ACH005.rds"</span><span class="op">)</span></span>
<span><span class="va">expression_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/AssayData.html" class="external-link">GetAssayData</a></span><span class="op">(</span><span class="va">seurat</span>, layer <span class="op">=</span> <span class="st">"counts"</span>, assay <span class="op">=</span> <span class="st">"SCT"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">geometry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/GetTissueCoordinates.html" class="external-link">GetTissueCoordinates</a></span><span class="op">(</span><span class="va">seurat</span>, scale <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Only take genes that  expressed in at least 5% of the spots</span></span>
<span><span class="va">expression</span> <span class="op">&lt;-</span> <span class="va">expression_raw</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">expression_raw</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">expression_raw</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">expression_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0.05</span>,<span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Let’s take a look at the slide itself and some of the cell-type
niches defined by <a href="https://doi.org/10.1038/s41586-022-05060-x" class="external-link">Kuppe et al.</a>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialPlot</a></span><span class="op">(</span><span class="va">seurat</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialPlot</a></span><span class="op">(</span><span class="va">seurat</span>, group.by <span class="op">=</span> <span class="st">"celltype_niche"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="extract-cell-type-composition">Extract cell-type composition<a class="anchor" aria-label="anchor" href="#extract-cell-type-composition"></a>
</h2>
<p>The Seurat Object of the tissue slide also contains the estimated
cell type proportions from cell2location. We extract them into a
separate object we will later use with MISTy and visualize some of the
cell types:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename to more informative names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">c2l_props</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">c2l_props</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="st">'Adipo'</span> <span class="op">=</span> <span class="st">'Adipocytes'</span>,</span>
<span>         <span class="st">'CM'</span> <span class="op">=</span> <span class="st">'Cardiomyocytes'</span>,</span>
<span>         <span class="st">'Endo'</span> <span class="op">=</span> <span class="st">'Endothelial'</span>,</span>
<span>         <span class="st">'Fib'</span> <span class="op">=</span> <span class="st">'Fibroblasts'</span>,</span>
<span>         <span class="st">'PC'</span> <span class="op">=</span> <span class="st">'Pericytes'</span>,</span>
<span>         <span class="st">'prolif'</span> <span class="op">=</span> <span class="st">'Proliferating'</span>,</span>
<span>         <span class="st">'vSMCs'</span> <span class="op">=</span> <span class="st">'Vascular-SMCs'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract into a separate object</span></span>
<span><span class="va">composition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">[[</span><span class="st">"c2l_props"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Visualize cell types</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"c2l_props"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, </span>
<span>                   keep.scale <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                   features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Vascular-SMCs'</span>, <span class="st">"Cardiomyocytes"</span>, <span class="st">"Endothelial"</span>, <span class="st">"Fibroblasts"</span><span class="op">)</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="pathway-activities-on-cell-type-composition">Pathway activities on cell-type composition<a class="anchor" aria-label="anchor" href="#pathway-activities-on-cell-type-composition"></a>
</h2>
<p>Let’s investigate the relationship between the cell-type compositions
and pathway activities in our example slide. But before we create the
views, we need to estimate the pathway activities. For this we will take
pathway gene sets from <a href="https://saezlab.github.io/progeny/index.html" class="external-link"><code>PROGENy</code></a>
and estimate the activity with <a href="https://saezlab.github.io/decoupleR/" class="external-link"><code>decoupleR</code></a>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain genesets</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://saezlab.github.io/decoupleR/reference/get_progeny.html" class="external-link">get_progeny</a></span><span class="op">(</span>organism <span class="op">=</span> <span class="st">"human"</span>, top <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: One or more parsing issues, call `problems()` on your data frame for details,</span></span>
<span><span class="co">## e.g.:</span></span>
<span><span class="co">##   dat &lt;- vroom(...)</span></span>
<span><span class="co">##   problems(dat)</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use multivariate linear model to estimate activity</span></span>
<span><span class="va">est_path_act</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://saezlab.github.io/decoupleR/reference/run_mlm.html" class="external-link">run_mlm</a></span><span class="op">(</span><span class="va">expression</span>, <span class="va">model</span>,.mor <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> </span></code></pre></div>
<p>We add the result to the Seurat Object and plot the estimated
activities to see the distribution over the slide:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Delete progeny assay from Kuppe et al.</span></span>
<span><span class="va">seurat</span><span class="op">[[</span><span class="st">'progeny'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Put estimated pathway activities object into the correct format</span></span>
<span><span class="va">est_path_act_wide</span> <span class="op">&lt;-</span> <span class="va">est_path_act</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">condition</span>, names_from <span class="op">=</span> <span class="va">source</span>, values_from <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"condition"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Clean names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">est_path_act_wide</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">est_path_act_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span>parsing_option <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add</span></span>
<span><span class="va">seurat</span><span class="op">[[</span><span class="st">'progeny'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/CreateAssayObject.html" class="external-link">CreateAssayObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">est_path_act_wide</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jak.stat"</span>, <span class="st">"hypoxia"</span><span class="op">)</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="section level3">
<h3 id="misty-views">MISTy Views<a class="anchor" aria-label="anchor" href="#misty-views"></a>
</h3>
<p>For the MISTy view, we will use cell type compositions per spot as
the intraview and add the estimated <a href="https://saezlab.github.io/progeny/index.html" class="external-link"><code>PROGENy</code></a>
pathway activities as juxta and paraviews. The size of the neighborhood
and the kernel, as well as the kernel family, should be chosen depending
on the experiment. Here both distances were chosen to enclose only a
small number of neighboring spots.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clean names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">composition</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">composition</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span>parsing_option <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create intra from cell-type composition</span></span>
<span><span class="va">comp_views</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_initial_view.html">create_initial_view</a></span><span class="op">(</span><span class="va">composition</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># juxta &amp; para from pathway activity</span></span>
<span><span class="va">path_act_views</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_initial_view.html">create_initial_view</a></span><span class="op">(</span><span class="va">est_path_act_wide</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_juxtaview.html">add_juxtaview</a></span><span class="op">(</span><span class="va">geometry</span>,  neighbor.thr <span class="op">=</span> <span class="fl">130</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_paraview.html">add_paraview</a></span><span class="op">(</span><span class="va">geometry</span>, l<span class="op">=</span> <span class="fl">200</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine views</span></span>
<span><span class="va">com_path_act_views</span> <span class="op">&lt;-</span> <span class="va">comp_views</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_views.html">add_views</a></span><span class="op">(</span><span class="fu"><a href="../reference/create_view.html">create_view</a></span><span class="op">(</span><span class="st">"juxtaview.path.130"</span>, <span class="va">path_act_views</span><span class="op">[[</span><span class="st">"juxtaview.130"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>, <span class="st">"juxta.path.130"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_views.html">add_views</a></span><span class="op">(</span><span class="fu"><a href="../reference/create_view.html">create_view</a></span><span class="op">(</span><span class="st">"paraview.path.200"</span>, <span class="va">path_act_views</span><span class="op">[[</span><span class="st">"paraview.200"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>, <span class="st">"para.path.200"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Then run MISTy and collect the results:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_misty.html">run_misty</a></span><span class="op">(</span><span class="va">com_path_act_views</span>, <span class="st">"result/comp_path_act"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner/work/mistyR/mistyR/vignettes/result/comp_path_act"</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collect_results.html">collect_results</a></span><span class="op">(</span><span class="st">"result/comp_path_act/"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downstream-analysis">Downstream analysis<a class="anchor" aria-label="anchor" href="#downstream-analysis"></a>
</h3>
<p>With the collected results, we can now answer the following
questions:</p>
<div class="section level4">
<h4 id="to-what-extent-can-the-analyzed-surrounding-tissues-pathway-activities-explain-the-cell-type-composition-of-the-spot-compared-to-the-intraview">1. To what extent can the analyzed surrounding tissues’ pathway
activities explain the cell-type composition of the spot compared to the
intraview?<a class="anchor" aria-label="anchor" href="#to-what-extent-can-the-analyzed-surrounding-tissues-pathway-activities-explain-the-cell-type-composition-of-the-spot-compared-to-the-intraview"></a>
</h4>
<p>Here we can look at two different statistics: <code>intra.R2</code>
shows the variance explained by the intraview alone, and
<code>gain.R2</code> shows the increase in explainable variance when we
additionally consider the other views (here juxta and para).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_improvement_stats.html">plot_improvement_stats</a></span><span class="op">(</span><span class="st">"intra.R2"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_improvement_stats.html">plot_improvement_stats</a></span><span class="op">(</span><span class="st">"gain.R2"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 11 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_segment()`).</span></span></code></pre>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">## Warning: Removed 11 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_segment()`).</span></span></code></pre>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<p>The juxta and paraview particularly increase the explained variance
for mast cells and adipocytes.</p>
<p>In general, the significant gain in R2 can be interpreted as the
following:</p>
<p>“We can better explain the expression of marker X when we consider
additional views other than the intrinsic view.”</p>
<p>To see the individual contributions of the views we can use:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/plot_view_contributions.html">plot_view_contributions</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We see, that the intraview explains the most variance for nearly all
cell types (as expected).</p>
</div>
<div class="section level4">
<h4 id="what-are-the-specific-relations-that-can-explain-the-cell-type-composition">2. What are the specific relations that can explain the cell-type
composition?<a class="anchor" aria-label="anchor" href="#what-are-the-specific-relations-that-can-explain-the-cell-type-composition"></a>
</h4>
<p>We can individually show the importance of the markers from each
viewpoint as predictors of the spot intrinsic cell-type composition to
explain the contributions.</p>
<p>Let’s look at the juxtaview:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_interaction_heatmap.html">plot_interaction_heatmap</a></span><span class="op">(</span><span class="st">"juxta.path.130"</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>We observe that TNFa is a significant predictor for adipocytes. We
can compare their distributions:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"tnfa"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"c2l_props"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"Adipocytes"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
<p>We observe similar distributions for both.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="pathway-activities-on-cell-type-composition---linear-model">Pathway activities on cell-type composition - Linear Model<a class="anchor" aria-label="anchor" href="#pathway-activities-on-cell-type-composition---linear-model"></a>
</h2>
<p>The default model used by MISTy to model each view is the random
forest. However, there are different models to choose from, like the
faster and more interpretable linear model.</p>
<p>Another option we haven’t used yet is <code>bypass.intra</code>. With
this, we bypass training the baseline model that predicts the intraview
with features from the intraview itself. We will still be able to see
how the other views explain the intraview. We will use the same view
composition as before:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_misty.html">run_misty</a></span><span class="op">(</span><span class="va">com_path_act_views</span>, <span class="st">"result/comp_path_act_linear"</span>, model.function <span class="op">=</span> <span class="va">linear_model</span>, bypass.intra <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner/work/mistyR/mistyR/vignettes/result/comp_path_act_linear"</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collect_results.html">collect_results</a></span><span class="op">(</span><span class="st">"result/comp_path_act_linear"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="downstream-analysis-1">Downstream analysis<a class="anchor" aria-label="anchor" href="#downstream-analysis-1"></a>
</h3>
<p>Let’s check again the <code>gain.R2</code> and view
contributions:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act_linear</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_improvement_stats.html">plot_improvement_stats</a></span><span class="op">(</span><span class="st">"gain.R2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_view_contributions.html">plot_view_contributions</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 11 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_segment()`).</span></span></code></pre>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
<p>For the specific target-predictor interaction, we look again at the
juxtaview:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_com_path_act_linear</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_interaction_heatmap.html">plot_interaction_heatmap</a></span><span class="op">(</span><span class="st">"juxta.path.130"</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Visualize the activity of the JAK-STAT pathway and myeloid
distribution:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"jak.stat"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Could not find jak.stat in the default search locations, found in</span></span>
<span><span class="co">## 'progeny' assay instead</span></span></code></pre>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"c2l_props"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"Myeloid"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-19-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="pathway-activities-and-transcriptionfactors-on-cell-type-composition">Pathway activities and Transcriptionfactors on cell-type
composition<a class="anchor" aria-label="anchor" href="#pathway-activities-and-transcriptionfactors-on-cell-type-composition"></a>
</h2>
<p>In addition to the estimated pathway activities, we can also add a
view to examine the relationship between cell-type composition and TF
activity. First, we need to estimate the TF activity with decoupler. It
is recommended to compute it with Python, as it is significantly
faster:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expression_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># In Python:</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>net <span class="op">=</span> dc.get_collectri()</span></code></pre></div>
<pre><code><span><span class="co">## 0.00B [00:00, ?B/s]466kB [00:00, 4.14MB/s]1.11MB [00:00, 4.51MB/s]2.75MB [00:00, 7.99MB/s]5.72MB [00:00, 13.4MB/s]11.7MB [00:00, 24.3MB/s]24.1MB [00:00, 46.8MB/s]49.0MB [00:00, 90.3MB/s]52.7MB [00:00, 55.3MB/s]</span></span>
<span><span class="co">## 0.00B [00:00, ?B/s]118kB [00:00, 244MB/s]</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>acts_tfs<span class="op">=</span>  dc.run_ulm(</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>  mat <span class="op">=</span> r.expression_df,</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  net <span class="op">=</span> net,</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  verbose <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  use_raw <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code><span><span class="co">## Running ulm on mat with 3175 samples and 7241 targets for 545 sources.</span></span></code></pre>
<p>The object with the estimation contains two elements: The first are
the estimates and their respective p-values can be found in the second
element.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">est_TF</span> <span class="op">&lt;-</span> <span class="va">py</span><span class="op">$</span><span class="va">acts_tfs</span></span></code></pre></div>
<p>To speed up the following model training, we calculate the 1000 most
variable genes expressed. We then extract the TF from the highly
variable genes to create a MISTy view.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Highly variable genes</span></span>
<span><span class="va">hvg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="va">expression</span>, selection.method <span class="op">=</span> <span class="st">"vst"</span>, nfeatures <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hvg_expr</span> <span class="op">&lt;-</span> <span class="va">expression</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hvg</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract TF from the highly variable genes</span></span>
<span><span class="va">hvg_TF</span><span class="op">&lt;-</span> <span class="va">est_TF</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">est_TF</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hvg_expr</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="misty-views-1">Misty Views<a class="anchor" aria-label="anchor" href="#misty-views-1"></a>
</h3>
<p>We will combine the intraview from the cell-type composition and
paraviews from the estimated pathway and TF activities:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TF_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_initial_view.html">create_initial_view</a></span><span class="op">(</span><span class="va">hvg_TF</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_paraview.html">add_paraview</a></span><span class="op">(</span><span class="va">geometry</span>, l <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>           <span class="co"># This may still take some time</span></span>
<span></span>
<span><span class="co"># Combine Views</span></span>
<span><span class="va">comp_TF_path_views</span> <span class="op">&lt;-</span> <span class="va">comp_views</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/add_views.html">add_views</a></span><span class="op">(</span><span class="fu"><a href="../reference/create_view.html">create_view</a></span><span class="op">(</span><span class="st">"paraview.TF.200"</span>, <span class="va">TF_view</span><span class="op">[[</span><span class="st">"paraview.200"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>, <span class="st">"para.TF.200"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_views.html">add_views</a></span><span class="op">(</span><span class="fu"><a href="../reference/create_view.html">create_view</a></span><span class="op">(</span><span class="st">"paraview.path.200"</span>, <span class="va">path_act_views</span><span class="op">[[</span><span class="st">"paraview.200"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>, <span class="st">"para.path.200"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run Misty</span></span>
<span><span class="fu"><a href="../reference/run_misty.html">run_misty</a></span><span class="op">(</span><span class="va">comp_TF_path_views</span>, <span class="st">"result/comp_TF_path"</span>, model.function <span class="op">=</span> <span class="va">linear_model</span>, bypass.intra <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner/work/mistyR/mistyR/vignettes/result/comp_TF_path"</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_comp_TF_pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collect_results.html">collect_results</a></span><span class="op">(</span><span class="st">"result/comp_TF_path"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downstream-analysis-2">Downstream analysis<a class="anchor" aria-label="anchor" href="#downstream-analysis-2"></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_comp_TF_pathway</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_improvement_stats.html">plot_improvement_stats</a></span><span class="op">(</span><span class="st">"gain.R2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_view_contributions.html">plot_view_contributions</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 11 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_segment()`).</span></span></code></pre>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-25-1.png" width="700"><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-25-2.png" width="700"></p>
<p>When plotting the interaction heatmap, we can restrict the result by
applying a <code>trim</code>, that only shows targets above a defined
value for a chosen metric like <code>gain.R2</code>.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_comp_TF_pathway</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_interaction_heatmap.html">plot_interaction_heatmap</a></span><span class="op">(</span><span class="st">"para.TF.200"</span>, </span>
<span>                           clean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           trim.measure <span class="op">=</span> <span class="st">"gain.R2"</span>,</span>
<span>                           trim <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>The TF MYC is an important predictor of fibroblasts:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SCT"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"MYC"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"c2l_props"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"Fibroblasts"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-27-2.png" width="700"></p>
<p>Indeed, we can see a similar distribution.</p>
</div>
</div>
<div class="section level2">
<h2 id="ligand-receptor">Ligand-Receptor<a class="anchor" aria-label="anchor" href="#ligand-receptor"></a>
</h2>
<p>Finally, we want to learn about the spatial relationship of receptors
and ligands on the tissue slide. We will access the consensus resource
from <a href="https://liana-py.readthedocs.io/en/latest/" class="external-link"><code>LIANA</code></a>
after downloading it from Github, pulling out the ligands and receptors
from the before-determined highly variable genes:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/saezlab/liana-py/main/liana/resource/omni_resource.csv"</span>, </span>
<span>    destfile <span class="op">=</span> <span class="st">"omni_resource.csv"</span>, method <span class="op">=</span> <span class="st">"curl"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ligand Receptor Resource</span></span>
<span><span class="va">omni_resource</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"omni_resource.csv"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">resource</span> <span class="op">==</span> <span class="st">"consensus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get highly variable ligands</span></span>
<span><span class="va">ligands</span> <span class="op">&lt;-</span> <span class="va">omni_resource</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">source_genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">hvg_lig</span> <span class="op">&lt;-</span> <span class="va">hvg_expr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hvg_expr</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ligands</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Get highly variable receptors</span></span>
<span><span class="va">receptors</span> <span class="op">&lt;-</span> <span class="va">omni_resource</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">target_genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">hvg_recep</span> <span class="op">&lt;-</span> <span class="va">hvg_expr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hvg_expr</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">receptors</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Clean names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hvg_lig</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hvg_lig</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span>parsing_option <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hvg_recep</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hvg_recep</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span>parsing_option <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="misty-views-2">Misty Views<a class="anchor" aria-label="anchor" href="#misty-views-2"></a>
</h3>
<p>We are going to create a combined view with the receptors in the
intraview as targets and the ligands in the paraview as predictors:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create views and combine them</span></span>
<span><span class="va">receptor_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_initial_view.html">create_initial_view</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">hvg_recep</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ligand_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_initial_view.html">create_initial_view</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">hvg_lig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_paraview.html">add_paraview</a></span><span class="op">(</span><span class="va">geometry</span>, l <span class="op">=</span> <span class="fl">200</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lig_recep_view</span> <span class="op">&lt;-</span> <span class="va">receptor_view</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/add_views.html">add_views</a></span><span class="op">(</span><span class="fu"><a href="../reference/create_view.html">create_view</a></span><span class="op">(</span><span class="st">"paraview.ligand.200"</span>, <span class="va">ligand_view</span><span class="op">[[</span><span class="st">"paraview.200"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>, <span class="st">"para.lig.200"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_misty.html">run_misty</a></span><span class="op">(</span><span class="va">lig_recep_view</span>, <span class="st">"results/lig_recep"</span>, bypass.intra <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner/work/mistyR/mistyR/vignettes/results/lig_recep"</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_lig_recep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collect_results.html">collect_results</a></span><span class="op">(</span><span class="st">"results/lig_recep"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downstream-analysis-3">Downstream analysis<a class="anchor" aria-label="anchor" href="#downstream-analysis-3"></a>
</h3>
<p>Let’s look at important interactions. An additional way to reduce the
number of interactions shown in the heatmap is applying a
<code>cutoff</code>, that introduces an importance threshold:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">misty_results_lig_recep</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_interaction_heatmap.html">plot_interaction_heatmap</a></span><span class="op">(</span><span class="st">"para.lig.200"</span>, clean <span class="op">=</span> <span class="cn">TRUE</span>, cutoff <span class="op">=</span> <span class="fl">2</span>, trim.measure <span class="op">=</span><span class="st">"gain.R2"</span>, trim <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>Remember that MISTy does not only infer interactions between ligands
and their respective receptor, but rather all possible interactions
between ligands and receptors. We can visualize one of the interactions
with high importance:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SCT"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"CRLF1"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">seurat</span>, features <span class="op">=</span> <span class="st">"COMP"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="FunctionalAndStructuralPipeline_files/figure-html/unnamed-chunk-31-2.png" width="700"></p>
<p>The plots show a co-occurrence of the ligand and receptor, although
they are not an annotated receptor-ligand pair.</p>
</div>
</div>
<div class="section level2">
<h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<p><code>browseVignettes("mistyR")</code></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>Here is the output of <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> at the point when
this document was compiled.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] distances_0.1.10   janitor_2.2.0      decoupleR_2.8.0    lubridate_1.9.3   </span></span>
<span><span class="co">##  [5] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       </span></span>
<span><span class="co">##  [9] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.0     </span></span>
<span><span class="co">## [13] tidyverse_2.0.0    Seurat_5.0.3       SeuratObject_5.0.1 sp_2.1-3          </span></span>
<span><span class="co">## [17] reticulate_1.35.0  mistyR_1.10.0      BiocStyle_2.30.0  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] RcppAnnoy_0.0.22       splines_4.3.3          later_1.3.2           </span></span>
<span><span class="co">##   [4] filelock_1.0.3         R.oo_1.26.0            cellranger_1.1.0      </span></span>
<span><span class="co">##   [7] polyclip_1.10-6        hardhat_1.3.1          pROC_1.18.5           </span></span>
<span><span class="co">##  [10] rpart_4.1.23           fastDummies_1.7.3      lifecycle_1.0.4       </span></span>
<span><span class="co">##  [13] rprojroot_2.0.4        vroom_1.6.5            globals_0.16.3        </span></span>
<span><span class="co">##  [16] lattice_0.22-5         MASS_7.3-60.0.1        backports_1.4.1       </span></span>
<span><span class="co">##  [19] magrittr_2.0.3         plotly_4.10.4          sass_0.4.9            </span></span>
<span><span class="co">##  [22] rmarkdown_2.26         jquerylib_0.1.4        yaml_2.3.8            </span></span>
<span><span class="co">##  [25] rlist_0.4.6.2          httpuv_1.6.14          sctransform_0.4.1     </span></span>
<span><span class="co">##  [28] spam_2.10-0            spatstat.sparse_3.0-3  cowplot_1.1.3         </span></span>
<span><span class="co">##  [31] pbapply_1.7-2          RColorBrewer_1.1-3     abind_1.4-5           </span></span>
<span><span class="co">##  [34] rvest_1.0.4            Rtsne_0.17             R.utils_2.12.3        </span></span>
<span><span class="co">##  [37] nnet_7.3-19            rappdirs_0.3.3         ipred_0.9-14          </span></span>
<span><span class="co">##  [40] lava_1.8.0             ggrepel_0.9.5          irlba_2.3.5.1         </span></span>
<span><span class="co">##  [43] listenv_0.9.1          spatstat.utils_3.0-4   goftest_1.2-3         </span></span>
<span><span class="co">##  [46] RSpectra_0.16-1        spatstat.random_3.2-3  fitdistrplus_1.1-11   </span></span>
<span><span class="co">##  [49] parallelly_1.37.1      pkgdown_2.0.7          leiden_0.4.3.1        </span></span>
<span><span class="co">##  [52] codetools_0.2-19       xml2_1.3.6             tidyselect_1.2.1      </span></span>
<span><span class="co">##  [55] farver_2.1.1           stats4_4.3.3           matrixStats_1.2.0     </span></span>
<span><span class="co">##  [58] spatstat.explore_3.2-7 jsonlite_1.8.8         caret_6.0-94          </span></span>
<span><span class="co">##  [61] ellipsis_0.3.2         progressr_0.14.0       iterators_1.0.14      </span></span>
<span><span class="co">##  [64] ggridges_0.5.6         survival_3.5-8         systemfonts_1.0.6     </span></span>
<span><span class="co">##  [67] foreach_1.5.2          tools_4.3.3            progress_1.2.3        </span></span>
<span><span class="co">##  [70] ragg_1.3.0             ica_1.0-3              Rcpp_1.0.12           </span></span>
<span><span class="co">##  [73] glue_1.7.0             prodlim_2023.08.28     gridExtra_2.3         </span></span>
<span><span class="co">##  [76] ranger_0.16.0          xfun_0.42              here_1.0.1            </span></span>
<span><span class="co">##  [79] withr_3.0.0            BiocManager_1.30.22    fastmap_1.1.1         </span></span>
<span><span class="co">##  [82] fansi_1.0.6            digest_0.6.35          timechange_0.3.0      </span></span>
<span><span class="co">##  [85] R6_2.5.1               mime_0.12              textshaping_0.3.7     </span></span>
<span><span class="co">##  [88] colorspace_2.1-0       scattermore_1.2        tensor_1.5            </span></span>
<span><span class="co">##  [91] spatstat.data_3.0-4    R.methodsS3_1.8.2      utf8_1.2.4            </span></span>
<span><span class="co">##  [94] generics_0.1.3         recipes_1.0.10         data.table_1.15.2     </span></span>
<span><span class="co">##  [97] class_7.3-22           ridge_3.3              prettyunits_1.2.0     </span></span>
<span><span class="co">## [100] httr_1.4.7             htmlwidgets_1.6.4      ModelMetrics_1.2.2.2  </span></span>
<span><span class="co">## [103] uwot_0.1.16            pkgconfig_2.0.3        gtable_0.3.4          </span></span>
<span><span class="co">## [106] timeDate_4032.109      lmtest_0.9-40          selectr_0.4-2         </span></span>
<span><span class="co">## [109] furrr_0.3.1            OmnipathR_3.10.1       htmltools_0.5.7       </span></span>
<span><span class="co">## [112] dotCall64_1.1-1        bookdown_0.38          scales_1.3.0          </span></span>
<span><span class="co">## [115] png_0.1-8              gower_1.0.1            snakecase_0.11.1      </span></span>
<span><span class="co">## [118] knitr_1.45             tzdb_0.4.0             reshape2_1.4.4        </span></span>
<span><span class="co">## [121] checkmate_2.3.1        nlme_3.1-164           curl_5.2.1            </span></span>
<span><span class="co">## [124] cachem_1.0.8           zoo_1.8-12             KernSmooth_2.23-22    </span></span>
<span><span class="co">## [127] parallel_4.3.3         miniUI_0.1.1.1         desc_1.4.3            </span></span>
<span><span class="co">## [130] pillar_1.9.0           grid_4.3.3             logger_0.3.0          </span></span>
<span><span class="co">## [133] vctrs_0.6.5            RANN_2.6.1             promises_1.2.1        </span></span>
<span><span class="co">## [136] xtable_1.8-4           cluster_2.1.6          evaluate_0.23         </span></span>
<span><span class="co">## [139] cli_3.6.2              compiler_4.3.3         rlang_1.1.3           </span></span>
<span><span class="co">## [142] crayon_1.5.2           future.apply_1.11.1    labeling_0.4.3        </span></span>
<span><span class="co">## [145] plyr_1.8.9             fs_1.6.3               stringi_1.8.3         </span></span>
<span><span class="co">## [148] viridisLite_0.4.2      deldir_2.0-4           assertthat_0.2.1      </span></span>
<span><span class="co">## [151] munsell_0.5.0          lazyeval_0.2.2         spatstat.geom_3.2-9   </span></span>
<span><span class="co">## [154] Matrix_1.6-5           RcppHNSW_0.6.0         hms_1.1.3             </span></span>
<span><span class="co">## [157] patchwork_1.2.0        bit64_4.0.5            future_1.33.1         </span></span>
<span><span class="co">## [160] shiny_1.8.0            highr_0.10             ROCR_1.0-11           </span></span>
<span><span class="co">## [163] igraph_2.0.3           memoise_2.0.1          bslib_0.6.2           </span></span>
<span><span class="co">## [166] bit_4.0.5              readxl_1.4.3</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jovan Tanevski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
